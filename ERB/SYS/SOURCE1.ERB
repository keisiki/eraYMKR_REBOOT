;=============================================================================
;소스 계산(쾌락계)
;=============================================================================
;-------------------------------------------------
;쾌Ｃ의 소스
;-------------------------------------------------
@CALC_SOURCE0
;Ｃ민감과 Ｃ둔감은 여기서 처리
IF TALENT:C민감
    TIMES SOURCE:0 , 2.00
ELSEIF TALENT:C둔감
    TIMES SOURCE:0 , 0.50
ENDIF

LOCAL = SOURCE:0

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.70
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.30
ELSE
    TIMES LOCAL , 1.80
ENDIF

LOCAL:1 = SOURCE:0

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:1 , 0.15
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:1 , 0.25
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:1 , 0.30
ELSE
    TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:억압 || TALENT:저항 || TALENT:쾌감을부정
    LOCAL:2 = SOURCE:0 / 3
    LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
    LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:음구지식) || (TFLAG:98 == 2 && TALENT:음구지식)
    TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:츠쿠모가미) || (TFLAG:98 == 2 && TALENT:츠쿠모가미)
    TIMES LOCAL , 1.30
;음핵／음경
IF TALENT:음핵／음경
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 0.50
    LOCAL:3 = (LOCAL+LOCAL:1)/2
ENDIF

UP:0 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;음핵／음경持ちが対象なら潤滑と習得のパラも上昇する
IF LOCAL:3
    UP:10 += LOCAL:3
    LOCAL:3 = (LOCAL+LOCAL:1)/3
    UP:11 += LOCAL:3
ENDIF

;-------------------------------------------------
;쾌Ｖ의 소스
;-------------------------------------------------
@CALC_SOURCE1
;V민감과 V둔감은 여기서 처리
IF TALENT:V민감
    TIMES SOURCE:1 , 2.00
ELSEIF TALENT:V둔감
    TIMES SOURCE:1 , 0.50
ENDIF

LOCAL = SOURCE:1

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.30
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.50
ELSE
    TIMES LOCAL , 2.00
ENDIF

LOCAL:1 = SOURCE:1

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:1 , 0.15
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:1 , 0.25
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:1 , 0.30
ELSE
    TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:억압 || TALENT:저항 || TALENT:쾌감을부정
    LOCAL:2 = SOURCE:1 / 3
    LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
    LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:음구지식) || (TFLAG:98 == 2 && TALENT:음구지식)
    TIMES LOCAL , 1.50
;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:츠쿠모가미) || (TFLAG:98 == 2 && TALENT:츠쿠모가미)
    TIMES LOCAL , 1.30
;[소인]
IF TALENT:소인
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    UP:15 += LOCAL:1/2
ENDIF
;淫壷
IF TALENT:음호
    IF PLAYER == MASTER
        TIMES LOCAL , 2.50
        TIMES LOCAL:1 , 1.50
        TIMES LOCAL:2 , 0.30
    ELSE
        TIMES LOCAL , 1.50
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 0.50
    ENDIF
    LOCAL:3 = (LOCAL+LOCAL:1)/3
ENDIF

UP:1 += LOCAL
UP:12 += LOCAL:1
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;淫壷持ちが対象なら潤滑のパラも上昇する
SIF LOCAL:3
    UP:10 += LOCAL:3

;-------------------------------------------------
;쾌Ａ의 소스
;-------------------------------------------------
@CALC_SOURCE2
;Ａ민감과 Ａ둔감은 여기서 처리
IF TALENT:A민감
    TIMES SOURCE:2 , 2.00
ELSEIF TALENT:A둔감
    TIMES SOURCE:2 , 0.50
ENDIF

LOCAL = SOURCE:2

;PALAM:욕정을 본다
;쾌ＡはあまりPALAM:욕정では差が出ない
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.60
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.80
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.20
ELSE
    TIMES LOCAL , 1.40
ENDIF

LOCAL:1 = SOURCE:2

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:1 , 0.05
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:1 , 0.40
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:1 , 0.80
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:1 , 1.20
ELSE
    TIMES LOCAL:1 , 1.80
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:억압 || TALENT:저항 || TALENT:쾌감을부정
    LOCAL:2 = SOURCE:2 / 3
    LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
    LOCAL:2 = 0
ENDIF

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:음구지식) || (TFLAG:98 == 2 && TALENT:음구지식)
    TIMES LOCAL , 1.50
;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:츠쿠모가미) || (TFLAG:98 == 2 && TALENT:츠쿠모가미)
    TIMES LOCAL , 1.30
;[소인]
IF TALENT:소인
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.20
    UP:17 += LOCAL/2
    UP:21 += LOCAL:1/2
ENDIF
;淫尻
IF TALENT:음고
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 0.50
ENDIF

UP:2 += LOCAL
UP:13 += LOCAL:1
UP:14 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;쾌Ｂ의 소스
;-------------------------------------------------
@CALC_SOURCE3
;Ｂ민감과 Ｂ둔감은 여기서 처리
IF TALENT:B민감
    TIMES SOURCE:3 , 2.00
ELSEIF TALENT:B둔감
    TIMES SOURCE:3 , 0.50
ENDIF

LOCAL = SOURCE:3

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.70
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.30
ELSE
    TIMES LOCAL , 1.80
ENDIF

LOCAL:1 = SOURCE:3

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:1 , 0.15
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:1 , 0.25
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:1 , 0.30
ELSE
    TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:억압 || TALENT:저항 || TALENT:쾌감을부정
    LOCAL:2 = SOURCE:3 / 3
    LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
    LOCAL:2 = 0
ENDIF

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:음구지식) || (TFLAG:98 == 2 && TALENT:음구지식)
    TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:츠쿠모가미) || (TFLAG:98 == 2 && TALENT:츠쿠모가미)
    TIMES LOCAL , 1.30

;[소인]
IF TALENT:소인
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    UP:12 += LOCAL:1/2
ENDIF
;淫乳
IF TALENT:음유
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 0.50
ENDIF

UP:3 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;쾌楽의 소스補助計算
;-------------------------------------------------
;………………………………………………
;쾌감을 부정, 억압, 저항による抑鬱上昇
;………………………………………………
@CALC_CVAB_SOURCE_SUB(ARG)
#FUNCTION
;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES ARG , 1.00
ELSEIF ABL:욕망 == 1
    TIMES ARG , 0.85
ELSEIF ABL:욕망 == 2
    TIMES ARG , 0.70
ELSEIF ABL:욕망 == 3
    TIMES ARG , 0.40
ELSEIF ABL:욕망 == 4
    TIMES ARG , 0.30
ELSE
    TIMES ARG , 0.10
ENDIF
RETURNF ARG

;=============================================================================
;ソース計算(快楽以外)
;=============================================================================
;-------------------------------------------------
;接触의 소스
;-------------------------------------------------
;bluemoon様のものを勝手に拝借・手直ししました
@CALC_SOURCE10
LOCAL = SOURCE:10
LOCAL:1 = SOURCE:10
LOCAL:2 = SOURCE:10
LOCAL:3 = SOURCE:10

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.00
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.05
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 0.60
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 0.30
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 0.10
    TIMES LOCAL:1 , 0.30
ELSE
    TIMES LOCAL , 0.00
    TIMES LOCAL:1 , 0.40
ENDIF

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 0.00
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:2 , 0.40
    TIMES LOCAL:3 , 0.05
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:2 , 0.25
    TIMES LOCAL:3 , 0.10
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 0.20
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:2 , 0.00
    TIMES LOCAL:3 , 0.30
ELSE
    TIMES LOCAL:2 , 0.00
    TIMES LOCAL:3 , 0.40
ENDIF

;恋慕
IF TALENT:연모 && ASSIPLAY == 0
    LOCAL /= 5
    LOCAL:2 /= 5
    LOCAL:1 *= 2
    LOCAL:3 *= 2
ENDIF

;レズ調教・ＢＬ調教の場合
IF !(TALENT:PLAYER:남자 ^^ TALENT:남자)
    IF ABL:(22 + TALENT:남자) == 0
        TIMES LOCAL , 1.00
        TIMES LOCAL:2 , 1.00
        TIMES LOCAL:1 , 1.00
        TIMES LOCAL:3 , 1.00
    ELSEIF ABL:(22 + TALENT:남자) == 1
        TIMES LOCAL , 0.80
        TIMES LOCAL:2 , 0.80
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:3 , 1.10
    ELSEIF ABL:(22 + TALENT:남자) == 2
        TIMES LOCAL , 0.60
        TIMES LOCAL:2 , 0.60
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:3 , 1.20
    ELSEIF ABL:(22 + TALENT:남자) == 3
        TIMES LOCAL , 0.40
        TIMES LOCAL:2 , 0.40
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:3 , 1.30
    ELSEIF ABL:(22 + TALENT:남자) == 4
        TIMES LOCAL , 0.25
        TIMES LOCAL:2 , 0.25
        TIMES LOCAL:1 , 1.40
        TIMES LOCAL:3 , 1.40
    ELSE
        TIMES LOCAL , 0.15
        TIMES LOCAL:2 , 0.15
        TIMES LOCAL:1 , 1.50
        TIMES LOCAL:3 , 1.50
    ENDIF
ENDIF

;相性（この後出てくる「相性による上下の処理」と二重計算になるが問題なし）
LOCAL:4 = NO:PLAYER
IF RELATION:(LOCAL:4) != 0
    LOCAL *= 100
    LOCAL /= RELATION:(LOCAL:4)
    LOCAL:2 *= 100
    LOCAL:2 /= RELATION:(LOCAL:4)

    LOCAL:1 *= RELATION:(LOCAL:4)
    LOCAL:1 /= 100
    LOCAL:3 *= RELATION:(LOCAL:4)
    LOCAL:3 /= 100
ENDIF

UP:20 += LOCAL
UP:12 += LOCAL:1
UP:21 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;情愛의 소스
;-------------------------------------------------
@CALC_SOURCE11
LOCAL = SOURCE:11

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 0.10
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.25
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 0.40
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 0.60
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 0.80
ELSE
    TIMES LOCAL , 1.00
ENDIF

LOCAL:1 = SOURCE:11

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL:1 , 0.00
ELSEIF ABL:욕망 == 1
    TIMES LOCAL:1 , 0.05
ELSEIF ABL:욕망 == 2
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:욕망 == 3
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:욕망 == 4
    TIMES LOCAL:1 , 0.30
ELSE
    TIMES LOCAL:1 , 0.40
ENDIF

;인형
IF TALENT:인형
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.25
ENDIF

;사토리
IF TALENT:사토리
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.10
ENDIF

;츠쿠모가미
IF TALENT:츠쿠모가미
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.25
ENDIF

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;노출의 소스
;-------------------------------------------------
@CALC_SOURCE12
;恥じらいと恥薄いはここで処理
IF TALENT:부끄럼쟁이
    TIMES SOURCE:12 , 2.00
ELSEIF TALENT:부끄럼없음
    TIMES SOURCE:12 , 0.50
ENDIF

;潤滑アップの50%から液体追加의 소스を引いた残りを露出의 소스に加える
SOURCE:12 += (UP:10 - SOURCE:19) / 2

LOCAL = SOURCE:12
LOCAL:1 = SOURCE:12
LOCAL:2 = SOURCE:12

;PALAM:치정을 본다
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:15 < PALAMLV:1
    TIMES LOCAL:1 , 1.00
ELSEIF PALAM:15 < PALAMLV:2
    TIMES LOCAL:1 , 0.90
ELSEIF PALAM:15 < PALAMLV:3
    TIMES LOCAL:1 , 0.70
ELSEIF PALAM:15 < PALAMLV:4
    TIMES LOCAL:1 , 0.50
ELSE
    TIMES LOCAL:1 , 0.30
ENDIF

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL:2 , 0.50
ELSEIF ABL:순종 == 1
    TIMES LOCAL:2 , 0.30
ELSEIF ABL:순종 == 2
    TIMES LOCAL:2 , 0.15
ELSEIF ABL:순종 == 3
    TIMES LOCAL:2 , 0.05
ELSEIF ABL:순종 == 4
    TIMES LOCAL:2 , 0.00
ELSE
    TIMES LOCAL:2 , 0.00
ENDIF

;ABL:노출벽을 본다
IF ABL:노출증 == 0
    TIMES LOCAL , 0.00
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:노출증 == 1
    TIMES LOCAL , 0.10
    TIMES LOCAL:2 , 0.90
ELSEIF ABL:노출증 == 2
    TIMES LOCAL , 0.20
    TIMES LOCAL:2 , 0.70
ELSEIF ABL:노출증 == 3
    TIMES LOCAL , 0.40
    TIMES LOCAL:2 , 0.50
ELSEIF ABL:노출증 == 4
    TIMES LOCAL , 0.60
    TIMES LOCAL:2 , 0.30
ELSE
    TIMES LOCAL , 0.80
    TIMES LOCAL:2 , 0.10
ENDIF

;パイパン
IF TALENT:음모없음
    TIMES LOCAL:1 , 2.50
    TIMES LOCAL:2 , 1.50
ENDIF
;マゾ
IF TALENT:마조
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 0.50
ENDIF

;クリトリスリング
IF CFLAG:특수장비 & 1
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.40
ENDIF
;ラビアピアス
IF CFLAG:특수장비 & 16
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.50
ENDIF
;ニプルピアス
IF CFLAG:특수장비 & 32
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 1.30
ENDIF

UP:13 += LOCAL
UP:15 += LOCAL:1
UP:20 += LOCAL:2

;-------------------------------------------------
;主導権의 소스
;-------------------------------------------------
@CALC_SOURCE14
LOCAL = SOURCE:14 / 5
LOCAL:1 = SOURCE:14
LOCAL:2 = SOURCE:14 / 2

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 1.00
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.70
    TIMES LOCAL:1 , 0.25
    TIMES LOCAL:2 , 1.20
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 1.50
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 1.80
ELSE
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 2.50
ENDIF

;ABL:技巧을 본다
IF ABL:기교 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:기교 == 1
    TIMES LOCAL , 1.25
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:기교 == 2
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 1.20
ELSEIF ABL:기교 == 3
    TIMES LOCAL , 1.80
    TIMES LOCAL:2 , 1.40
ELSEIF ABL:기교 == 4
    TIMES LOCAL , 2.00
    TIMES LOCAL:2 , 1.60
ELSE
    TIMES LOCAL , 2.40
    TIMES LOCAL:2 , 1.80
ENDIF

;ABL:봉사정신을 본다
IF ABL:봉사정신 == 0
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:봉사정신 == 1
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.90
ELSEIF ABL:봉사정신 == 2
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:봉사정신 == 3
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.70
ELSEIF ABL:봉사정신 == 4
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 0.60
ELSE
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 0.50
ENDIF

;ABL:マゾっ気을 본다
IF ABL:마조끼 == 0
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL:2 , 0.90
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL:2 , 0.70
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL:2 , 0.60
ELSE
    TIMES LOCAL:2 , 0.50
ENDIF

;サド
IF TALENT:새드
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.25
ENDIF

;調教者がマゾ
IF TALENT:PLAYER:마조
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
ENDIF

UP:11 += LOCAL
UP:13 += LOCAL:1

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:순종 == 1
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:순종 == 2
    TIMES LOCAL:2 , 0.60
ELSEIF ABL:순종 == 3
    TIMES LOCAL:2 , 0.50
ELSEIF ABL:순종 == 4
    TIMES LOCAL:2 , 0.80
ELSE
    TIMES LOCAL:2 , 1.00
ENDIF

IF ABL:순종 < 4
    UP:14 += LOCAL:2
ELSE
    ;MARK:反発刻印을 본다
    IF MARK:반발각인 == 0
        TIMES LOCAL:2 , 1.00
    ELSEIF MARK:반발각인 == 1
        TIMES LOCAL:2 , 0.75
    ELSEIF MARK:반발각인 == 2
        TIMES LOCAL:2 , 0.50
    ELSE
        TIMES LOCAL:2 , 0.25
    ENDIF
    UP:32 += LOCAL:2
ENDIF

;-------------------------------------------------
;性行動의 소스
;-------------------------------------------------
@CALC_SOURCE15
LOCAL = SOURCE:15
LOCAL:1 = 0

;ABL:봉사정신을 본다
IF ABL:봉사정신 == 0
    TIMES LOCAL , 0.60
ELSEIF ABL:봉사정신 == 1
    TIMES LOCAL , 0.80
ELSEIF ABL:봉사정신 == 2
    TIMES LOCAL , 1.00
ELSEIF ABL:봉사정신 == 3
    TIMES LOCAL , 1.20
ELSEIF ABL:봉사정신 == 4
    TIMES LOCAL , 1.40
ELSE
    TIMES LOCAL , 1.70
ENDIF

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:남자 && ASSIPLAY == 0
    TIMES LOCAL , 1.75
    SIF TALENT:음호
        TIMES LOCAL , 1.20
ELSEIF TALENT:PLAYER:남자
    TIMES LOCAL , 1.50
ENDIF

;억압か저항がある場合はPALAM:抑鬱が上がる
IF TALENT:억압 || TALENT:저항
    LOCAL:1 = SOURCE:15 / 5
    ;ABL:봉사정신을 본다
    IF ABL:봉사정신 == 0
        TIMES LOCAL:1 , 1.80
    ELSEIF ABL:봉사정신 == 1
        TIMES LOCAL:1 , 1.30
    ELSEIF ABL:봉사정신 == 2
        TIMES LOCAL:1 , 0.90
    ELSEIF ABL:봉사정신 == 3
        TIMES LOCAL:1 , 0.70
    ELSEIF ABL:봉사정신 == 4
        TIMES LOCAL:1 , 0.50
    ELSE
        TIMES LOCAL:1 , 0.30
    ENDIF
ENDIF

UP:11 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;達成의 소스
;-------------------------------------------------
@CALC_SOURCE16
LOCAL = SOURCE:16

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 0.50
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.80
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 1.00
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 1.20
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 1.40
ELSE
    TIMES LOCAL , 1.60
ENDIF

;ABL:봉사정신을 본다
IF ABL:봉사정신 == 0
    TIMES LOCAL , 0.00
ELSEIF ABL:봉사정신 == 1
    TIMES LOCAL , 0.40
ELSEIF ABL:봉사정신 == 2
    TIMES LOCAL , 0.80
ELSEIF ABL:봉사정신 == 3
    TIMES LOCAL , 1.20
ELSEIF ABL:봉사정신 == 4
    TIMES LOCAL , 1.60
ELSE
    TIMES LOCAL , 2.00
ENDIF

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:남자 && ASSIPLAY == 0
    TIMES LOCAL , 1.50
    SIF TALENT:음호
        TIMES LOCAL , 1.10
ELSEIF TALENT:PLAYER:남자
    TIMES LOCAL , 1.25
ENDIF

UP:12 += LOCAL

;-------------------------------------------------
;恭順追加의 소스
;-------------------------------------------------
@CALC_SOURCE17
LOCAL = SOURCE:17

;傷物
SIF TALENT:흠집
    TIMES LOCAL , 0.50

UP:12 += LOCAL

;-------------------------------------------------
;욕정追加의 소스
;-------------------------------------------------
@CALC_SOURCE18
LOCAL = SOURCE:18

UP:13 += LOCAL

;-------------------------------------------------
;液体追加의 소스
;-------------------------------------------------
@CALC_SOURCE19
;[소인]
IF TALENT:소인 && TALENT:PLAYER:소인 == 0
    ;ローションとローションプレイでないときは
    SIF SELECTCOM != 60 && SELECTCOM != 625
        TIMES SOURCE:19 , 0.40
ENDIF
LOCAL = SOURCE:19

UP:10 += LOCAL

;-------------------------------------------------
;痛覚의 소스
;-------------------------------------------------
@CALC_SOURCE20
LOCAL = SOURCE:20
LOCAL:1 = SOURCE:20
LOCAL:2 = SOURCE:20
LOCAL:3 = SOURCE:20

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:순종 == 1
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.60
ELSEIF ABL:순종 == 2
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.50
ELSEIF ABL:순종 == 3
    TIMES LOCAL:1 , 0.70
    TIMES LOCAL:2 , 0.40
ELSEIF ABL:순종 == 4
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.20
ELSE
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.05
ENDIF

;ABL:マゾっ気을 본다
IF ABL:마조끼 == 0
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 0.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL:2 , 0.80
    TIMES LOCAL:3 , 0.10
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 0.20
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL:2 , 0.30
    TIMES LOCAL:3 , 0.30
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 0.45
ELSE
    TIMES LOCAL:2 , 0.05
    TIMES LOCAL:3 , 0.60
ENDIF

;痛みに弱い
IF TALENT:아픔에약함
    ;難易度による修整
    IF FLAG:난이도 >= 4
        TIMES LOCAL , 4.00
    ELSEIF FLAG:난이도 == 3
        TIMES LOCAL , 2.00
    ELSE
        TIMES LOCAL , 1.50
    ENDIF
ENDIF
;ドＭ
IF TALENT:초M
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 2.50
;マゾ
ELSEIF TALENT:마조
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 1.50
ENDIF
;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:음구지식) || (TFLAG:98 == 2 && TALENT:음구지식)
    TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:츠쿠모가미) || (TFLAG:98 == 2 && TALENT:츠쿠모가미)
    TIMES LOCAL , 1.30

;[소인]
IF TALENT:소인
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    TIMES LOCAL:3 , 0.75
ENDIF

;助手によるプレイ
SIF ASSIPLAY
    TIMES LOCAL:2 , 0.40

;ABL:調教者のサドっ気을 본다
IF ABL:PLAYER:새드끼 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:PLAYER:새드끼 <= 2
    TIMES LOCAL , 1.10
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.20
ELSEIF ABL:PLAYER:새드끼 <= 4
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.40
ELSE
    TIMES LOCAL , 1.40
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.80
ENDIF

;調教者がドＳ
IF TALENT:PLAYER:초S
    TIMES LOCAL , 2.00
    TIMES LOCAL:3 , 1.50
;調教者がサド
ELSEIF TALENT:PLAYER:새드
    TIMES LOCAL , 1.20
    TIMES LOCAL:3 , 1.50
ENDIF

UP:16 += LOCAL
UP:17 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3
;マゾっ気があるとPALAM:욕정も上がる
;そのとき調教者が[サド]だと効果的

;-------------------------------------------------
;痒み의 소스
;-------------------------------------------------
@CALC_SOURCE21
;LOCAL:0=苦痛,욕정
;LOCAL:1=屈服
;LOCAL:2=不快
;LOCAL:3=反感

LOCAL = SOURCE:21
LOCAL:1 = SOURCE:21
LOCAL:2 = 4 * SOURCE:21

IF SOURCE:21 < 1000
    LOCAL:3 = 0
ELSEIF SOURCE:21 < 3000
    LOCAL:3 = 100
ELSEIF SOURCE:21 < 6000
    LOCAL:3 = 200
ELSEIF SOURCE:21 < 10000
    LOCAL:3 = 300
ELSEIF SOURCE:21 < 18000
    LOCAL:3 = 600
ELSEIF SOURCE:21 < 30000
    LOCAL:3 = 1200
ELSE
    LOCAL:3 = 2400
ENDIF
SIF LOCAL:3 > 300
    LOCAL:3 += SOURCE:21

;ABL:マゾっ気을 본다
IF ABL:마조끼 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:2 , 3.00
    TIMES LOCAL:3 , 3.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:2 , 1.50
    TIMES LOCAL:3 , 1.50
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 1.00
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL , 1.20
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 0.50
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 0.10
ELSE
    TIMES LOCAL , 1.80
    TIMES LOCAL:2 , 0.02
    TIMES LOCAL:3 , 0.02
ENDIF

;ABL:自慰中毒을 본다
IF ABL:자위중독 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 0.50
ELSEIF ABL:자위중독 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.80
    TIMES LOCAL:3 , 0.80
ELSEIF ABL:자위중독 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 1.00
ELSEIF ABL:자위중독 == 3
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.30
    TIMES LOCAL:3 , 1.50
ELSEIF ABL:자위중독 == 4
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 1.60
    TIMES LOCAL:3 , 2.00
ELSE
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 2.50
    TIMES LOCAL:2 , 2.00
    TIMES LOCAL:3 , 2.50
ENDIF

;濡れやすい
IF TALENT:젖기쉬움
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 2.50
;濡れにくい
ELSEIF TALENT:젖기어려움
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.50
ENDIF
;倒錯的
IF TALENT:도착적
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.80
ENDIF
;マゾ
IF TALENT:마조
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 1.50
    TIMES LOCAL:3 , 0.50
ENDIF
;淫乱
IF TALENT:음란
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 1.80
    TIMES LOCAL:3 , 1.20
ENDIF

;調教者がサド
IF TALENT:PLAYER:새드
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 2.50
ENDIF

UP:13 += LOCAL
UP:16 += LOCAL
UP:14 += LOCAL:1
UP:21 += LOCAL:2
UP:20 += LOCAL:3

;-------------------------------------------------
;屈従의 소스
;-------------------------------------------------
@CALC_SOURCE22
LOCAL = SOURCE:22
LOCAL:1 = SOURCE:22

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.12
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.10
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.05
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 1.10
    TIMES LOCAL:1 , 0.02
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 0.00
ELSE
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 0.00
ENDIF

;ABL:サドっ気을 본다
IF ABL:새드끼 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
ELSEIF ABL:새드끼 == 1
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 0.80
ELSEIF ABL:새드끼 == 2
    TIMES LOCAL , 1.40
    TIMES LOCAL:1 , 0.60
ELSEIF ABL:새드끼 == 3
    TIMES LOCAL , 1.60
    TIMES LOCAL:1 , 0.50
ELSEIF ABL:새드끼 == 4
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 0.40
ELSE
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 0.25
ENDIF

;パイパン
IF TALENT:음모없음
    SIF TALENT:작은체형 == 0
        TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 1.50
ENDIF

;クリトリスリング
IF CFLAG:특수장비 & 1
    TIMES LOCAL , 1.40
    TIMES LOCAL:1 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:특수장비 & 16
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:특수장비 & 32
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 1.20
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;支配의 소스
;-------------------------------------------------
;LOCAL:0=屈服,恐怖
;LOCAL:1=抑鬱
;LOCAL:2=反感
;LOCAL:3=욕정
@CALC_SOURCE23

LOCAL = SOURCE:23
LOCAL:1 = SOURCE:23
LOCAL:2 = SOURCE:23
LOCAL:3 = SOURCE:23

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 2.50
    TIMES LOCAL:2 , 2.00
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 1.50
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.20
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 1.10
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.80
ELSE
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.50
ENDIF

;ABL:サドっ気을 본다
IF ABL:새드끼 == 0
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 0.20
ELSEIF ABL:새드끼 == 1
    TIMES LOCAL:2 , 1.20
    TIMES LOCAL:3 , 0.50
ELSEIF ABL:새드끼 == 2
    TIMES LOCAL:2 , 1.50
    TIMES LOCAL:3 , 0.80
ELSEIF ABL:새드끼 == 3
    TIMES LOCAL:2 , 1.80
    TIMES LOCAL:3 , 1.00
ELSEIF ABL:새드끼 == 4
    TIMES LOCAL:2 , 2.00
    TIMES LOCAL:3 , 1.30
ELSE
    TIMES LOCAL:2 , 2.50
    TIMES LOCAL:3 , 1.60
ENDIF

;ABL:マゾっ気을 본다
IF ABL:마조끼 == 0
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 0.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL:2 , 0.80
    TIMES LOCAL:3 , 0.10
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 0.20
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL:2 , 0.30
    TIMES LOCAL:3 , 0.30
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 0.45
ELSE
    TIMES LOCAL:2 , 0.05
    TIMES LOCAL:3 , 0.60
ENDIF

;臆病
IF TALENT:겁쟁이
    TIMES LOCAL , 3.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
ENDIF
;反抗的
IF TALENT:반항적
    TIMES LOCAL , 0.70
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
ENDIF
;プライド高い
IF TALENT:프라이드가높음
    TIMES LOCAL , 0.70
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
;プライド低い
ELSEIF TALENT:프라이드가낮음
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.90
ENDIF
;自制心
IF TALENT:자제심
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
ENDIF
;悲観的
IF TALENT:비관적
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.50
ENDIF
;弱味
IF TALENT:약점
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 0.80
ENDIF
;献身的
IF TALENT:헌신적
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 1.50
ENDIF
;倒錯的
IF TALENT:도착적
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.80
    TIMES LOCAL:3 , 2.00
ENDIF
;マゾ
IF TALENT:마조
    TIMES LOCAL , 1.50
    TIMES LOCAL:3 , 1.50
ENDIF

;調教者がサド
IF TALENT:PLAYER:새드
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 1.20
ENDIF

;ABL:調教者のサドっ気을 본다
IF ABL:PLAYER:새드끼 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:PLAYER:새드끼 <= 2
    TIMES LOCAL , 1.10
    TIMES LOCAL:2 , 1.20
ELSEIF ABL:PLAYER:새드끼 <= 4
    TIMES LOCAL , 1.20
    TIMES LOCAL:2 , 1.40
ELSE
    TIMES LOCAL , 1.40
    TIMES LOCAL:2 , 1.80
ENDIF

;クリトリスリング
IF CFLAG:특수장비 & 1
    TIMES LOCAL , 1.25
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:특수장비 & 16
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:특수장비 & 32
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
ENDIF

UP:17 += LOCAL

;服従
IF TALENT:복종
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
ENDIF
;烙印
IF TALENT:낙인
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 0.10
ENDIF
;隷属
IF TALENT:예속
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 1.50
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;中毒充足의 소스
;-------------------------------------------------
@CALC_SOURCE24
LOCAL = SOURCE:24
LOCAL:1 = SOURCE:24

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL , 0.10
    TIMES LOCAL:1 , 0.20
ELSEIF ABL:욕망 == 1
    TIMES LOCAL , 0.15
    TIMES LOCAL:1 , 0.30
ELSEIF ABL:욕망 == 2
    TIMES LOCAL , 0.20
    TIMES LOCAL:1 , 0.40
ELSEIF ABL:욕망 == 3
    TIMES LOCAL , 0.25
    TIMES LOCAL:1 , 0.50
ELSEIF ABL:욕망 == 4
    TIMES LOCAL , 0.30
    TIMES LOCAL:1 , 0.60
ELSE
    TIMES LOCAL , 0.35
    TIMES LOCAL:1 , 0.70
ENDIF

;マゾ
IF TALENT:마조
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.50
ENDIF

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;トラウマ의 소스
;-------------------------------------------------
;LOCAL:0=屈服, LOCAL:1=恐怖, LOCAL:2=不快
@CALC_SOURCE25
LOCAL = SOURCE:25
LOCAL:1 = SOURCE:25
LOCAL:2 = SOURCE:25

;MARK:恐怖刻印을 본다
IF MARK:공포각인 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.25
    TIMES LOCAL:2 , 0.30
ELSEIF MARK:공포각인 == 1
    TIMES LOCAL , 0.75
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.60
ELSEIF MARK:공포각인 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.00
ELSE
    TIMES LOCAL , 1.25
    TIMES LOCAL:1 , 3.00
    TIMES LOCAL:2 , 1.50
ENDIF

;臆病
IF TALENT:겁쟁이
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 7.50
ENDIF

UP:14 += LOCAL
UP:17 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;薬物侵蝕의 소스
;-------------------------------------------------
;LOCAL:0=욕정, LOCAL:1=不快, LOCAL:2=薬毒
@CALC_SOURCE26
;薬毒耐性
SIF TALENT:약물내성
    TIMES SOURCE:26 , 0.25
;媚薬中毒
SIF TALENT:미약중독
    TIMES SOURCE:26 , 1.50
;機械
SIF TALENT:기계
    TIMES SOURCE:26 , 0.25
;霊体または人形
SIF TALENT:영체 || TALENT:인형
    TIMES SOURCE:26 , 0.50

LOCAL = SOURCE:26
LOCAL:1 = SOURCE:26
LOCAL:2 = SOURCE:26

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 0.10
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 0.10
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.30
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 0.40
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.70
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.70
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.40
    TIMES LOCAL:2 , 1.50
ELSE
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 2.00
ENDIF

;ABL:○○中毒関係을 본다
IF TALENT:남자
    LOCAL:3 = (ABL:자위중독+ABL:정액중독+ABL:BL중독+ABL:분유중독+ABL:촉수중독+ABL:배설중독+ABL:사정중독)/5
ELSE
    LOCAL:3 = (ABL:자위중독+ABL:정액중독+ABL:레즈중독+ABL:분유중독+ABL:촉수중독+ABL:배설중독+ABL:사정중독)/5
ENDIF
IF LOCAL:3 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 2.50
    TIMES LOCAL:2 , 0.80
ELSEIF LOCAL:3 == 1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 1.00
ELSEIF LOCAL:3 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.10
ELSEIF LOCAL:3 == 3
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.30
ELSEIF LOCAL:3 == 4
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 1.60
ELSE
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 2.00
ENDIF

;喘息
SIF TARGET:47
    TIMES LOCAL:2 , 1.50

;MARK:反発刻印을 본다
IF MARK:반발각인 == 0
    TIMES LOCAL , 1.25
    TIMES LOCAL:1 , 0.25
    TIMES LOCAL:2 , 0.50
ELSEIF MARK:반발각인 == 1
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF MARK:반발각인 == 2
    TIMES LOCAL , 0.75
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
ELSE
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 3.00
    TIMES LOCAL:2 , 2.00
ENDIF

;MARK:薬物刻印을 본다
IF MARK:약물각인 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 1.00
ELSEIF MARK:약물각인 == 1
    TIMES LOCAL , 0.75
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.50
ELSEIF MARK:약물각인 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 2.00
ELSE
    TIMES LOCAL , 1.75
    TIMES LOCAL:1 , 0.10
    LOCAL:2 = 0
ENDIF

UP:13 += LOCAL
UP:21 += LOCAL:1
UP:30 += LOCAL:2

;-------------------------------------------------
;触手汚染의 소스
;-------------------------------------------------
@CALC_SOURCE27
LOCAL = SOURCE:27
LOCAL:1 = SOURCE:27
LOCAL:2 = SOURCE:27

;EXP:触手経験을 본다
IF EXP:촉수경험 < EXPLV:1
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 0.60
ELSEIF EXP:촉수경험 < EXPLV:2
    TIMES LOCAL , 0.90
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 0.80
ELSEIF EXP:촉수경험 < EXPLV:3
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF EXP:촉수경험 < EXPLV:4
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 2.00
ELSEIF EXP:촉수경험 < EXPLV:5
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 2.50
ELSE
    TIMES LOCAL , 2.00
    TIMES LOCAL:1 , 0.25
    TIMES LOCAL:2 , 3.00
ENDIF

;ABL:触手中毒을 본다
IF ABL:촉수중독 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 3.50
    TIMES LOCAL:2 , 0.50
ELSEIF ABL:촉수중독 == 1
    TIMES LOCAL , 0.60
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 0.60
ELSEIF ABL:촉수중독 == 2
    TIMES LOCAL , 0.70
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.70
ELSEIF ABL:촉수중독 == 3
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:촉수중독 == 4
    TIMES LOCAL , 0.90
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 0.90
ELSE
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.00
    TIMES LOCAL:2 , 1.00
ENDIF

;触手寄生LVの最大値に対する現在値の割合([寄生]が無い場合は0％扱い)
LOCAL:3 = (TALENT:기생) ? (BASE:촉수 *100) / MAXBASE:촉수 # 0
IF LOCAL:3 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF LOCAL:3 < 20
    TIMES LOCAL , 1.10
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 1.25
ELSEIF LOCAL:3 < 40
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 1.50
ELSEIF LOCAL:3 < 60
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 1.80
ELSEIF LOCAL:3 < 80
    TIMES LOCAL , 1.70
    TIMES LOCAL:1 , 0.20
    TIMES LOCAL:2 , 2.20
ELSEIF LOCAL:3 < 100
    TIMES LOCAL , 1.90
    TIMES LOCAL:1 , 0.10
    TIMES LOCAL:2 , 2.50
ELSE
    TIMES LOCAL , 2.50
    TIMES LOCAL:1 , 0.00
    TIMES LOCAL:2 , 3.00
ENDIF

UP:14 += LOCAL
UP:21 += LOCAL:1

;侵蝕はそのコマンドの절정強度(回数)で増加
;増加量は調教者の触手使役Lvに依存
IF ABL:PLAYER:촉수사역 == 0
    LOCAL:4 = 5
ELSEIF ABL:PLAYER:촉수사역 == 1
    LOCAL:4 = 10
ELSEIF ABL:PLAYER:촉수사역 == 2
    LOCAL:4 = 25
ELSEIF ABL:PLAYER:촉수사역 == 3
    LOCAL:4 = 50
ELSEIF ABL:PLAYER:촉수사역 == 4
    LOCAL:4 = 75
ELSE
    LOCAL:4 = 100
ENDIF
REPEAT 4
    SIF NOWEX:COUNT
        LOCAL:2 += NOWEX:COUNT * LOCAL:4
    SIF NOWEX:(COUNT+10)
        LOCAL:2 += NOWEX:(COUNT+10) * (LOCAL:4 * 2)
REND

UP:31 += LOCAL:2

;-------------------------------------------------
;羞恥扇情의 소스
;-------------------------------------------------
@CALC_SOURCE28
LOCAL = SOURCE:28
LOCAL:1 = SOURCE:28
LOCAL:2 = SOURCE:28

;MARK:恥辱刻印을 본다
IF MARK:치욕각인 == 0
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 2.00
ELSEIF MARK:치욕각인 == 1
    TIMES LOCAL , 0.75
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 1.00
ELSEIF MARK:치욕각인 == 2
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 0.50
ELSE
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 0.25
ENDIF

UP:14 += LOCAL
UP:15 += LOCAL:1
UP:31 += LOCAL:2

;-------------------------------------------------
;성기술 학습의 소스
;-------------------------------------------------
@CALC_SOURCE29
LOCAL = SOURCE:29
LOCAL:1 = SOURCE:29
LOCAL:2 = SOURCE:29

;ABL:봉사정신을 본다
IF ABL:봉사정신 == 0
    TIMES LOCAL , 0.20
    TIMES LOCAL:1 , 1.00
ELSEIF ABL:봉사정신 == 1
    TIMES LOCAL , 0.40
    TIMES LOCAL:1 , 0.90
ELSEIF ABL:봉사정신 == 2
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.80
ELSEIF ABL:봉사정신 == 3
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.70
ELSEIF ABL:봉사정신 == 4
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 0.60
ELSE
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 0.50
ENDIF

;ABL:노출벽을 본다
IF ABL:노출증 == 0
    TIMES LOCAL , 1.00
    TIMES LOCAL:2 , 1.50
ELSEIF ABL:노출증 == 1
    TIMES LOCAL , 1.10
    TIMES LOCAL:2 , 1.25
ELSEIF ABL:노출증 == 2
    TIMES LOCAL , 1.20
    TIMES LOCAL:2 , 1.00
ELSEIF ABL:노출증 == 3
    TIMES LOCAL , 1.30
    TIMES LOCAL:2 , 0.75
ELSEIF ABL:노출증 == 4
    TIMES LOCAL , 1.40
    TIMES LOCAL:2 , 0.50
ELSE
    TIMES LOCAL , 1.50
    TIMES LOCAL:2 , 0.10
ENDIF

UP:11 += LOCAL
UP:14 += LOCAL:1
UP:31 += LOCAL:2

;-------------------------------------------------
;불결의 소스
;-------------------------------------------------
@CALC_SOURCE30
LOCAL = SOURCE:30
LOCAL:1 = SOURCE:30

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 1.60
    TIMES LOCAL:1 , 1.40
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 1.30
    TIMES LOCAL:1 , 1.20
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 1.10
    TIMES LOCAL:1 , 1.00
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.80
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 0.80
    TIMES LOCAL:1 , 0.50
ELSE
    TIMES LOCAL , 0.50
    TIMES LOCAL:1 , 0.10
ENDIF

;ABL:排泄中毒을 본다
IF ABL:배설중독 == 0
    TIMES LOCAL , 0.60
    TIMES LOCAL:1 , 1.00
ELSEIF ABL:배설중독 == 1
    TIMES LOCAL , 0.40
    TIMES LOCAL:1 , 0.80
ELSEIF ABL:배설중독 == 2
    TIMES LOCAL , 0.25
    TIMES LOCAL:1 , 0.60
ELSEIF ABL:배설중독 == 3
    TIMES LOCAL , 0.10
    TIMES LOCAL:1 , 0.30
ELSEIF ABL:배설중독 == 4
    TIMES LOCAL , 0.00
    TIMES LOCAL:1 , 0.10
ELSE
    TIMES LOCAL , 0.00
    TIMES LOCAL:1 , 0.00
ENDIF

UP:20 += LOCAL
UP:21 += LOCAL:1

;-------------------------------------------------
;일탈의 소스
;-------------------------------------------------
@CALC_SOURCE31
;好奇心と保守的はここで処理
SIF TALENT:호기심
    TIMES SOURCE:31 , 0.30
SIF TALENT:보수적
    TIMES SOURCE:31 , 3.00

LOCAL = SOURCE:31

;ABL:순종을 본다
IF ABL:순종 == 0
    TIMES LOCAL , 1.00
ELSEIF ABL:순종 == 1
    TIMES LOCAL , 0.80
ELSEIF ABL:순종 == 2
    TIMES LOCAL , 0.70
ELSEIF ABL:순종 == 3
    TIMES LOCAL , 0.40
ELSEIF ABL:순종 == 4
    TIMES LOCAL , 0.20
ELSE
    TIMES LOCAL , 0.00
ENDIF

;ABL:욕망을 본다
IF ABL:욕망 == 0
    TIMES LOCAL , 0.90
ELSEIF ABL:욕망 == 1
    TIMES LOCAL , 0.70
ELSEIF ABL:욕망 == 2
    TIMES LOCAL , 0.50
ELSEIF ABL:욕망 == 3
    TIMES LOCAL , 0.30
ELSEIF ABL:욕망 == 4
    TIMES LOCAL , 0.10
ELSE
    TIMES LOCAL , 0.00
ENDIF

;パイパン([소인]もしくは[작은체형]は除く)
SIF TALENT:음모없음 && TALENT:소인 == 0 && TALENT:작은체형 == 0
    TIMES LOCAL , 1.80
;マゾ
SIF TALENT:마조
    TIMES LOCAL , 0.50

;クリトリスリング
SIF CFLAG:특수장비 & 1
    TIMES LOCAL , 1.25
;ラビアピアス
SIF CFLAG:특수장비 & 16
    TIMES LOCAL , 1.30
;ニプルピアス
SIF CFLAG:특수장비 & 32
    TIMES LOCAL , 1.20

UP:20 += LOCAL

;-------------------------------------------------
;반감 추가의 소스
;-------------------------------------------------
@CALC_SOURCE32
LOCAL = SOURCE:32

;흠집
SIF TALENT:흠집
    TIMES LOCAL , 2.50

UP:20 += LOCAL

;-------------------------------------------------
;酒酔い의 소스
;-------------------------------------------------
@CALC_SOURCE40
LOCAL = SOURCE:40
LOCAL:1 = SOURCE:40 * 4
LOCAL:2 = SOURCE:40 * 2

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 1.00
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 0.70
    TIMES LOCAL:2 , 0.75
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.50
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 0.25
ELSE
    TIMES LOCAL , 2.50
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 0.10
ENDIF

;人形
SIF TALENT:인형
    TIMES LOCAL , 0.75
;河童
SIF TALENT:캇파
    TIMES LOCAL , 0.75
;鬼
SIF TALENT:오니
    TIMES LOCAL , 0.25
;天狗
SIF TALENT:텐구
    TIMES LOCAL , 0.75
;黄昏の怪物
SIF TALENT:황혼의괴물
    TIMES LOCAL , 0.25
;神霊
SIF TALENT:신령
    TIMES LOCAL , 0.75
;半神
SIF TALENT:반신
    TIMES LOCAL , 0.75

BASE:취기 += LOCAL
UP:13 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;酒酔い(鬼殺し)의 소스
;-------------------------------------------------
@CALC_SOURCE41
LOCAL = SOURCE:41
LOCAL:1 = SOURCE:41 * 4
LOCAL:2 = SOURCE:41 * 2
LOCAL:3 = SOURCE:41 * 3

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 1.00
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 1.00
    TIMES LOCAL:3 , 0.50
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 1.20
    TIMES LOCAL:1 , 0.70
    TIMES LOCAL:2 , 0.75
    TIMES LOCAL:3 , 0.80
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.50
    TIMES LOCAL:1 , 1.00
    TIMES LOCAL:2 , 0.50
    TIMES LOCAL:3 , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.80
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 0.25
    TIMES LOCAL:3 , 1.30
ELSE
    TIMES LOCAL , 2.50
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 0.10
    TIMES LOCAL:3 , 1.60
ENDIF

;人形
SIF TALENT:인형
    TIMES LOCAL , 0.75
;河童
SIF TALENT:캇파
    TIMES LOCAL , 0.75
;天狗
SIF TALENT:텐구
    TIMES LOCAL , 0.75
;鬼
SIF TALENT:오니
    TIMES LOCAL , 2.50
;黄昏の怪物
SIF TALENT:황혼의괴물
    TIMES LOCAL , 0.25
;神霊
SIF TALENT:신령
    TIMES LOCAL , 0.75
;半神
SIF TALENT:반신
    TIMES LOCAL , 0.75

BASE:취기 += LOCAL
UP:13 += LOCAL:1
UP:21 += LOCAL:2
UP:30 += LOCAL:3

;-------------------------------------------------
;媚薬浸潤의 소스
;-------------------------------------------------
@CALC_SOURCE42, ARG
LOCAL = SOURCE:ARG:42

;中毒しやすい
IF TALENT:ARG:중독되기쉬움
    TIMES LOCAL , 1.25
;中毒しにくい
ELSEIF TALENT:ARG:중독되기어려움
    TIMES LOCAL , 0.75
ENDIF

;媚薬中毒
IF TALENT:ARG:미약중독
    UP:12 += LOCAL*2
    UP:13 += LOCAL
    UP:14 += LOCAL*3
    CFLAG:ARG:미약중독레벨 = 0
ELSE
    ;媚薬中毒レベルの上昇処理
    CFLAG:ARG:미약중독레벨 += SOURCE:ARG:42
ENDIF
