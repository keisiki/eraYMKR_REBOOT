;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;조교 중의 추가 처리 및 서브 이벤트
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;=============================================================================
;조교 경험 관련의 처리
;=============================================================================
;-------------------------------------------------
;주인조교경험 · 호감도
;-------------------------------------------------
;호감도는 100만 이상으로 상승시키기란 불가능
@MASTER_FLAG_CHECK
;절정(에 여기서 조교 대상의 사정과 분유와 방뇨를 더하고 있음)
TFLAG:51 += TFLAG:30 + TFLAG:31 + TFLAG:32

LOCAL:1 = 0
;이번 조교 턴에서의 Ｃ절정, Ｖ절정, Ａ절정, Ｂ절정
REPEAT 4
    SIF NOWEX:COUNT > 0
        LOCAL:1 += 1
REND
;이번 조교 턴에서의 조교 대상의 사정
SIF TFLAG:30 > 0
    LOCAL:1 += 1
;이번 조교 턴에서의 조교 대상의 분유
SIF TFLAG:31 > 0
    LOCAL:1 += 1
;이번 조교 턴에서의 조교 대상의 방뇨
SIF TFLAG:32 > 0
    LOCAL:1 += 1
;주인경험에 절정＋이것저것 추가된 것을 더하고 있음
TFLAG:50 += TFLAG:51 * LOCAL:1

;사정
FOR COUNT, 8, 25
    SIF TFLAG:COUNT > 0 && (EXP:정액경험 + TCVAR:4) >= EXPLV:3
        TFLAG:50 += TFLAG:COUNT
NEXT

;주인(아나타)와 대상의 능력을 계산
;ABL:순종을 본다
TFLAG:97 = ABL:순종

;주인과 대상이 동성
IF !(TALENT:MASTER:남자 ^^ TALENT:남자)
    ;男ならＢＬっ気, 女ならレズっ気を見る
    LOCAL = 22 + TALENT:남자
    IF ABL:LOCAL == 0
        TFLAG:97 -= 1
    ELSEIF ABL:LOCAL < 3
        TFLAG:97 += 0
    ELSEIF ABL:LOCAL < 5
        TFLAG:97 += 1
    ELSE
        TFLAG:97 += 2
    ENDIF
    ;男ならＢＬ中毒, 女ならレズ中毒を見る
    LOCAL = 32 + TALENT:남자
    IF ABL:LOCAL > 4
        TFLAG:97 += 2
    ELSEIF ABL:LOCAL > 2
        TFLAG:97 += 1
    ENDIF
    ;両刀
    SIF TALENT:바이
        TFLAG:97 += 1
ENDIF
;素質による増減
;反抗的
SIF TALENT:반항적
    TFLAG:97 -= 1
;素直
SIF TALENT:솔직함 && TFLAG:97 > 0
    TFLAG:97 += 1
;자제심
SIF TALENT:자제심
    TFLAG:97 -= 1
;感情乏しい
SIF TALENT:감정결여
    TFLAG:97 -= 1
;抵抗
SIF TALENT:저항
    TFLAG:97 -= 1
;헌신적
SIF TALENT:헌신적 && TFLAG:97 > 0
    TFLAG:97 += 1
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TFLAG:97 += 1
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TFLAG:97 -= 1
ENDIF
;男嫌い
IF TALENT:남성혐오 && TALENT:MASTER:남자
    TFLAG:97 -= 1
;女嫌い
ELSEIF TALENT:여성혐오 && TALENT:MASTER:남자 == 0
    TFLAG:97 -= 1
ENDIF
;연모
SIF TALENT:연모
    TFLAG:97 += 2
;망신・상애
SIF TALENT:망신 || TALENT:상애
    TFLAG:97 += 2
;친애・괴조인격
SIF TALENT:친애 || TALENT:괴조인격
    TFLAG:97 += 3
;服従
SIF TALENT:복종
    TFLAG:97 += 2
;烙印
SIF TALENT:낙인
    TFLAG:97 += 1
;隷属
SIF TALENT:예속
    TFLAG:97 += 3

;주인의 매력
SIF TALENT:MASTER:매력
    TFLAG:97 += 1
;주인의 매혹
SIF TALENT:MASTER:매혹
    TFLAG:97 += 1
;주인의 수수께끼의 매력
SIF TALENT:MASTER:수수께끼의매력
    TFLAG:97 += 1
;주인의 인기
SIF TALENT:MASTER:인기
    TFLAG:97 += 1

;촉수 임플란트
SIF CFLAG:촉수이식
    CALL TENTACLE_INPLANT

TFLAG:97 += TFLAG:50 / 2
;상성에 따른 수정
LOCAL:1 = TRAIN_RELATION_CALC(MASTER)
IF LOCAL:1 > 0 && LOCAL:1 != 100 && TFLAG:97 > 0
    TFLAG:97 *= LOCAL:1
    TFLAG:97 /= 100
ENDIF

;반발각인 보정
TFLAG:97 -= (FLAG:난이도 < 3) ? 2 * MARK:반발각인 # 5 * MARK:반발각인

;非陥落なら, 恐怖각인 보정(難易度HARD 이상のみ)
SIF FLAG:난이도 > 2 && TALENT:연모 == 0 && TALENT:복종 == 0 && TALENT:음란 == 0
    TFLAG:97 -= 2 * MARK:공포각인

;ふぉーゆーっ！がしつこすぎると嫌われる
IF TFLAG:143 > 50
    TFLAG:97 -= 10
ELSEIF TFLAG:143 >= 5
    TFLAG:97 -= TFLAG:143 / 5
ENDIF

;神霊の場合, 主人が[수수께끼의 매력]を持っていないとなびきにくい
SIF TALENT:신령 && TALENT:MASTER:수수께끼의매력 == 0 && TFLAG:97 > 0
    TIMES TFLAG:97 , 0.50
;半神の場合も主人が[수수께끼의 매력]または[매혹]を持っていないとなびきにくい
SIF TALENT:반신 && TALENT:MASTER:매혹 == 0 && TALENT:MASTER:수수께끼의매력 == 0 && TFLAG:97 > 0
    TIMES TFLAG:97 , 0.75
;死神の場合, 主人が[仙人]ならばなびきにくい
SIF TALENT:사신 && TALENT:MASTER:선인
    TIMES TFLAG:97 , 0.75
;仙人の場合, 主人が[死神]ならばなびきにくい
SIF TALENT:선인 && TALENT:MASTER:사신
    TIMES TFLAG:97 , 0.75

;結果が一定数 미만の場合
IF MARK:반발각인 >= 3 && TFLAG:97 < -3
    TFLAG:97 = -3
ELSEIF MARK:반발각인 == 2 && TFLAG:97 < -2
    TFLAG:97 = -2
ELSEIF MARK:반발각인 == 1 && TFLAG:97 < -1
    TFLAG:97 = -1
ELSEIF TFLAG:97 < 0
    TFLAG:97 = 0
ENDIF

;정신붕괴の場合, 호감도가 変化しない
IF TALENT:정신붕괴
    TFLAG:97 = 0
;괴뢰の場合, 호감도가 上昇しにくい
ELSEIF TALENT:괴뢰
    TFLAG:97 /= 4
;無関心の場合, 연모がないと호감도가 上がりにくい
ELSEIF TALENT:무관심 && TALENT:연모 == 0
    IF TFLAG:97 > 1
        TFLAG:97 /= 2
    ELSEIF TFLAG:97 > 0
        TFLAG:97 = 1
    ENDIF
    SIF ABL:순종 >= 4
        TFLAG:97 += 1
ENDIF
;お香の効果(ムスク・フランキンセンス)
SIF (TEQUIP:89 == 5 || TEQUIP:89 == 6) && TEQUIP:52 == 0 && TEQUIP:53 == 0 && TEQUIP:55 == 0
    TFLAG:97 += RAND:3

;何もしないを使用した場合は上限を0にする
SIF TFLAG:97 > 0 && SELECTCOM == 9
    TFLAG:97 = 0
;ふぉーゆーっ！がしつこすぎると嫌われる
SIF TFLAG:143 > 10
    TFLAG:97 -= 1

;睡眠中・時止め中・실신 중は変動なし
IF EQUIP:14 || TEQUIP:71 || TFLAG:899 > 0
    TFLAG:97 = 0
;獣姦계 커맨드は호감도の上昇が最大で0
ELSEIF TFLAG:98 == 9 && TFLAG:97 > 0
    TFLAG:97 = 0
;촉수プレイ中は호감도減少(촉수中毒が大きいと減少値は小さくなる)
ELSEIF TEQUIP:90
    TFLAG:97 -= (5 - ABL:촉수중독)
;裸エプロン装着中は호감도가 2 이상アップすると愛情経験が＋1
ELSEIF TFLAG:97 > 1 && TEQUIP:59 == 1
    TCVAR:21 += 1
;상애持ちの場合ウェディングドレスコスプレ中は호감도가 5 이상アップすると愛情経験が＋1（助手はだめ）
ELSEIF TFLAG:97 > 4 && TALENT:상애 && TEQUIP:59 == 19
    TCVAR:21 += 1
ENDIF

CFLAG:호감도 += TFLAG:97
TFLAG:238 += TFLAG:97
;호감도는 0 이하로도 100만 이상으로도 되지 않음
CFLAG:호감도 = LIMIT(CFLAG:호감도, 0, 999999)

;フラグが立ってなく, 촉수プレイ中以外は主人調教経験も追加
SIF TEQUIP:90 == 0 && TFLAG:59 == 0
    TCVAR:98 += 1

;호감도 표시
SIF FLAG:SHOP이벤트확장 & 4 && TFLAG:97 != 0
    PRINTFORML \@(TFLAG:97 >= 0) ? 호감도＋{TFLAG:97} # －호감도{-TFLAG:97}\@

;-------------------------------------------------
;주인이 하는 조교의 보너스
;-------------------------------------------------
@MASTER_SKILL_CHECK
;질투
IF TALENT:질투 && ASSI < 0
    TIMES SOURCE:11 , 1.30
    TIMES SOURCE:24 , 1.50
    TIMES SOURCE:31 , 0.50
    TIMES SOURCE:32 , 0.50
ENDIF

;주인이 하는 조교가 아니라면 돌아감
SIF ASSIPLAY
    RETURN 0

;주인이 하는 조교경험
IF EXP:주인조교경험 >= 500
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:11 , 1.30
    TIMES SOURCE:30 , 0.70
    TIMES SOURCE:31 , 0.70
ELSEIF EXP:주인조교경험 >= 300
    TIMES SOURCE:0 , 1.10
    TIMES SOURCE:1 , 1.10
    TIMES SOURCE:2 , 1.10
    TIMES SOURCE:3 , 1.10
    TIMES SOURCE:11 , 1.20
    TIMES SOURCE:30 , 0.80
    TIMES SOURCE:31 , 0.80
ELSEIF EXP:주인조교경험 >= 100
    TIMES SOURCE:11 , 1.10
    TIMES SOURCE:30 , 0.90
    TIMES SOURCE:31 , 0.90
ENDIF

;음란, 연모, 친애는 주인경험과의 중복 전제로 계산
;음란
IF TALENT:음란
    TIMES SOURCE:0 , 1.80
    TIMES SOURCE:1 , 1.80
    TIMES SOURCE:2 , 1.80
    TIMES SOURCE:3 , 1.80
ENDIF

;친애
IF TALENT:친애
    TIMES SOURCE:0 , 1.50
    TIMES SOURCE:1 , 1.50
    TIMES SOURCE:2 , 1.50
    TIMES SOURCE:3 , 1.50
    TIMES SOURCE:11 , 2.00
    TIMES SOURCE:15 , 1.50
    TIMES SOURCE:16 , 1.50
    TIMES SOURCE:24 , 1.20
;연모
ELSEIF TALENT:연모
    TIMES SOURCE:0 , 1.30
    TIMES SOURCE:1 , 1.30
    TIMES SOURCE:2 , 1.30
    TIMES SOURCE:3 , 1.30
    TIMES SOURCE:11 , 1.80
ENDIF
;[연모]か[친애]持ちが処女(乙女ではなく)を今回の調教で散らせた場合
IF (TALENT:연모 || TALENT:친애) && TALENT:처녀 == 1 && TFLAG:2
    LOCAL:1 = 0
    LOCAL = NO:PLAYER
    ;主人との相性が100% 이상で痛みのソースが2000 미만で反感追加のソースが3000以下
    SIF (RELATION:LOCAL == 0 || RELATION:LOCAL >= 100) && SOURCE:20 < 2000 && SOURCE:32 <= 3000
        LOCAL:1 += 1
    ;Ｖ系装着器具, Ａ系装着器具, Ｃ系装着器具（コンドーム除く）, Ｕ系装着器具, Ｂ系装着器具, サラシを装着していない
    SIF TEQUIP:20 == 0 && TEQUIP:21 == 0 && TEQUIP:25 == 0 && TEQUIP:26 == 0 && TEQUIP:30 == 0 && TEQUIP:32 == 0 && TEQUIP:35 == 0 && TEQUIP:36 == 0
        LOCAL:1 += 1
    ;緊縛しておらず, 目隠しせず, 口封じせず, 木馬に乗せず, ビデオを撮影してなくて, ビデオを鑑賞してなくて, 야외 플레이でなくて, シャワー中でなかったり, 特殊な風呂に入ってなくて, 女体盛り中でなくて, 촉수プレイでない場合
    SIF TEQUIP:40 == 0 && TEQUIP:41 == 0 && TEQUIP:42 == 0 && TEQUIP:43 == 0 && TEQUIP:50 == 0 && TEQUIP:51 == 0 && TEQUIP:52 == 0 && TEQUIP:54 == 0 && TEQUIP:55 == 0 && TEQUIP:60 == 0 && TEQUIP:90 == 0
        LOCAL:1 += 1
    ;上の３条件を満たしてなおかつ調教テキストを表示する設定であるならば幸福を感じていることを表示し, なおかつ반발각인回避フラグを立てる
    IF LOCAL:1 == 3 && FLAG:조교시텍스트표시
        PRINTFORML %조사처리(CALLNAME:TARGET,"는")% %CALLNAME:MASTER%에게 처녀를 바칠 수 있어서 행복해하고 있다.
        TFLAG:105 = 1
    ENDIF
    ;情愛のソース倍増
    TIMES SOURCE:11 , 2.00
    ;친애なら反感追加のソースが1/10に
    IF TALENT:친애
        TIMES SOURCE:32 , 0.10
    ;친애なくても反感追加のソースは30%に
    ELSE
        TIMES SOURCE:32 , 0.30
    ENDIF
ENDIF

;-------------------------------------------------
;조수와의 조교경험의 카운트(임신 패치용)
;-------------------------------------------------
@ASSI_EXP_COUNT
;이 경험의 많고 적음으로 임신 발각시의 분기가 결정된다
;밸런스 조정 필요
LOCAL = 100
LOCAL:1 = 100

LOCAL:2 = NO:ASSI + 1000
LOCAL:3 = NO:TARGET + 1000

;상성에 따른 보정
IF RELATION:(NO:ASSI) != 0
    LOCAL *= RELATION:(NO:ASSI)
    LOCAL /= 100
ENDIF
IF RELATION:ASSI:(NO:TARGET) != 0
    LOCAL:1 *= RELATION:ASSI:(NO:TARGET)
    LOCAL:1 /= 100
ENDIF

;공통 부분
;これまでの経験がかなり多ければプラス補正
LOCAL += CFLAG:(LOCAL:2) / 100
LOCAL:1 += CFLAG:ASSI:(LOCAL:3) / 100
;欲情で補正
IF ABL:욕망 > 0
    LOCAL *= (100 + ABL:욕망 * ABL:욕망 * 4)
    LOCAL /= 100
ENDIF
IF ABL:ASSI:욕망 > 0
    LOCAL:1 *= (100 + ABL:ASSI:욕망 * ABL:ASSI:욕망 * 4)
    LOCAL:1 /= 100
ENDIF
;자제심で補正
SIF TALENT:자제심
    LOCAL /= 2
SIF TALENT:ASSI:자제심
    LOCAL:1 /= 2
;無関心で補正
SIF TALENT:무관심
    TIMES LOCAL, 0.80
SIF TALENT:ASSI:무관심
    TIMES LOCAL:1, 0.80
;感情乏しいで補正
SIF TALENT:감정결여
    LOCAL /= 4
SIF TALENT:ASSI:감정결여
    LOCAL:1 /= 4
;一線越えないで補正
SIF TALENT:일선을넘지않음
    LOCAL /= 2
SIF TALENT:ASSI:일선을넘지않음
    LOCAL:1 /= 2
;쾌감을 부정で補正
SIF TALENT:쾌감을부정
    LOCAL /= 3
SIF TALENT:ASSI:쾌감을부정
    LOCAL:1 /= 3
;素直で補正
SIF TALENT:솔직함
    TIMES LOCAL, 1.2
SIF TALENT:ASSI:솔직함
    TIMES LOCAL:1, 1.2
;好奇心で補正
SIF TALENT:호기심
    TIMES LOCAL, 1.2
SIF TALENT:ASSI:호기심
    TIMES LOCAL:1 , 1.2
;헌신적で補正
SIF TALENT:헌신적
    TIMES LOCAL, 1.25
SIF TALENT:ASSI:헌신적
    TIMES LOCAL:1, 1.25
;쾌감에 솔직で補正
SIF TALENT:쾌감에솔직
    LOCAL *= 2
SIF TALENT:ASSI:쾌감에솔직
    LOCAL:1 *= 2
;倒錯的で補正
SIF TALENT:도착적
    TIMES LOCAL, 1.5
SIF TALENT:ASSI:도착적
    TIMES LOCAL:1, 1.5
;매력で補正
SIF TALENT:매력
    TIMES LOCAL:1, 1.2
SIF TALENT:ASSI:매력
    TIMES LOCAL, 1.2
;매혹で補正
SIF TALENT:매혹
    TIMES LOCAL:1, 1.2
SIF TALENT:ASSI:매혹
    TIMES LOCAL, 1.2
;수수께끼의 매력で補正
SIF TALENT:수수께끼의매력
    TIMES LOCAL:1, 1.3
SIF TALENT:ASSI:수수께끼의매력
    TIMES LOCAL, 1.3
;소악마で補正
SIF TALENT:소악마
    TIMES LOCAL:1, 1.1
SIF TALENT:ASSI:소악마
    TIMES LOCAL, 1.1
;인기로 보정
SIF TALENT:인기
    TIMES LOCAL:1, 1.25
SIF TALENT:ASSI:인기
    TIMES LOCAL, 1.25

;소질 의존의 부분(남자 관련)
IF TALENT:남자 == 0 && TALENT:ASSI:남자 == 0
    ;女嫌いならマイナス補正（両方）
    SIF TALENT:여성혐오
        LOCAL /= 2
    SIF TALENT:ASSI:여성혐오
        LOCAL:1 /= 2
    ;両刀ならプラス補正
    SIF TALENT:바이
        LOCAL *= 2
    SIF TALENT:ASSI:바이
        LOCAL:1 *= 2
    ;レズっ気の補正
    IF ABL:레즈끼 > 0
        LOCAL *= (100 + ABL:레즈끼 * 10)
        LOCAL /= 100
    ENDIF
    IF ABL:ASSI:레즈끼 > 0
        LOCAL:1 *= (100 + ABL:ASSI:레즈끼 * 10)
        LOCAL:1 /= 100
    ENDIF
    ;レズ中毒の補正
    IF ABL:레즈중독 > 0
        LOCAL *= (100 + ABL:레즈중독 * 25)
        LOCAL /= 100
    ENDIF
    IF ABL:ASSI:레즈중독 > 0
        LOCAL:1 *= (100 + ABL:ASSI:레즈중독 * 25)
        LOCAL:1 /= 100
    ENDIF
ELSEIF TALENT:남자 && TALENT:ASSI:남자 == 0
    ;女嫌いならマイナス補正（奴隷）
    SIF TALENT:여성혐오
        LOCAL /= 2
    ;男嫌いならマイナス補正（助手）
    SIF TALENT:남성혐오
        LOCAL:1 /= 2
ELSEIF TALENT:남자 == 0 && TALENT:ASSI:남자
    ;男嫌いならマイナス補正（奴隷）
    SIF TALENT:남성혐오
        LOCAL:1 /= 2
    ;女嫌いならマイナス補正（助手）
    SIF TALENT:여성혐오
        LOCAL /= 2
ELSE
    ;男嫌いならマイナス補正（両方）
    SIF TALENT:남성혐오
        LOCAL /= 2
    SIF TALENT:ASSI:남성혐오
        LOCAL:1 /= 2
    ;両刀ならプラス補正
    SIF TALENT:바이
        LOCAL *= 2
    SIF TALENT:ASSI:바이
        LOCAL:1 *= 2
ENDIF

;조수조교경험 가산 처리(100000까지)
CFLAG:(LOCAL:2) = MIN(CFLAG:(LOCAL:2) + LOCAL / 100, 100000)
CFLAG:ASSI:(LOCAL:3) = MIN(CFLAG:ASSI:(LOCAL:3) + LOCAL:1 / 100, 100000)

;조수 조교 중에는 조수경험도 추가
TCVAR:ASSI:99 += 1

;=============================================================================
;특수 절정 처리
;=============================================================================
;-------------------------------------------------
;조교 대상의 사정 체크
;-------------------------------------------------
@TARGET_EJAC_CHECK

LOCAL = UP:0 + UP:1 / 5 + UP:2 / 50 + UP:3 / 50

;자제심
SIF TALENT:자제심
    LOCAL /= 2
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TIMES LOCAL , 1.20
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TIMES LOCAL , 0.80
ENDIF
;음란
SIF TALENT:음란
    TIMES LOCAL , 1.10

;미약
SIF TEQUIP:11
    LOCAL *= 2
;이뇨제
SIF TEQUIP:12
    LOCAL /= 2
;음충
SIF TEQUIP:55 == 1
    LOCAL *= 2

;촉수 임플란트
SIF CFLAG:촉수이식 & 1
    TIMES LOCAL , 1.25

LOCAL = 500 + LOCAL / 2
BASE:사정 += LOCAL

TFLAG:91 = SAMEN_CHECK(TARGET)

;Ｃ계 확장コマンド有効の場合, Ｃ刺激かＧスポット（前立腺ぽく）責めでないと사정できない(感覚増幅薬効果中は사정できる)
IF TFLAG:91 >= 1 && FLAG:커맨드확장 & 1 && UP:0 == 0 && NOWEX:20 == 0 && SELECTCOM != 520 && SELECTCOM != 600 && SELECTCOM != 414 && TEQUIP:20 != 2
    SOURCE:18 += ((BASE:사정 * 30) / MAXBASE:사정)
    SOURCE:20 += ((BASE:사정 * 15) / MAXBASE:사정)
    TIMES SOURCE:18 , 1.10
    TIMES SOURCE:20 , 1.10
    PRINTL ＜사정갈망중＞
    BASE:사정 = EJAC-1
    ;사정갈망중의 이벤트 대사 호출
    CALL SELF_KOJO, TARGET, 20
;대량사정저지
ELSEIF TFLAG:91 == 2 && TEQUIP:68
    SOURCE:20 += 800
    SOURCE:22 += 1000
    PRINTFORML %CALLNAME:TARGET% 대량사정저지
    BASE:사정 = EJAC-1
    NOWEX:30 += 2
    EX:30 += 2
;통상의 사정저지
ELSEIF TFLAG:91 == 1 && TEQUIP:68
    SOURCE:20 += 300
    SOURCE:22 += 500
    PRINTFORML %CALLNAME:TARGET% 사정저지
    BASE:사정 = EJAC-1
    NOWEX:30 += 1
    EX:30 += 1
;강헛사정
ELSEIF TFLAG:91 == 2 && (TEQUIP:69 || SELECTCOM == 128)
    SOURCE:18 += ((BASE:사정 * 60) / MAXBASE:사정)
    SOURCE:20 += ((BASE:사정 * 30) / MAXBASE:사정)
    TIMES SOURCE:18 , 1.20
    TIMES SOURCE:20 , 1.20
    PRINTFORML %CALLNAME:TARGET% 강헛사정
    BASE:사정 -= EJAC*2
    NOWEX:40 += 2
    EX:40 += 2
;헛사정
ELSEIF TFLAG:91 == 1 && (TEQUIP:69 || SELECTCOM == 128)
    SOURCE:18 += ((BASE:사정 * 30) / MAXBASE:사정)
    SOURCE:20 += ((BASE:사정 * 15) / MAXBASE:사정)
    TIMES SOURCE:18 , 1.10
    TIMES SOURCE:20 , 1.10
    PRINTFORML %CALLNAME:TARGET% 헛사정
    BASE:사정 -= EJAC
    NOWEX:40 += 1
    EX:40 += 1
;대량사정
ELSEIF TFLAG:91 == 2
    LOCAL:1 = 20 - (2 * ABL:사정중독)
    LOCAL:2 = 100 - (10 * ABL:사정중독)
    DOWNBASE:0 += LOCAL:1
    DOWNBASE:기력 += LOCAL:2

    ;対象の사정経験を見る
    IF EXP:사정경험 < EXPLV:1
        SOURCE:12 += 20000
        SOURCE:22 += 10000
    ELSEIF EXP:사정경험 < EXPLV:2
        SOURCE:12 += 10000
        SOURCE:22 += 8000
    ELSEIF EXP:사정경험 < EXPLV:3
        SOURCE:12 += 7000
        SOURCE:22 += 6000
    ELSEIF EXP:사정경험 < EXPLV:4
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:사정경험 < EXPLV:5
        SOURCE:12 += 3000
        SOURCE:22 += 2000
    ELSE
        SOURCE:12 += 1800
        SOURCE:22 += 1200
    ENDIF

    SOURCE:18 += ABL:사정중독 * 2500

    PRINTFORML %CALLNAME:TARGET% 대량사정
    SIF EXP:사정경험 == 0 && TALENT:남자 == 0
        TCVAR:50 += 1
    TCVAR:3 += 2
    TCVAR:4 += 1

    CALL IN_VAGINA_CHECK_T
    SIF TEQUIP:31
        TEQUIP:31 = 0

    ;Ｐに精液汚れ
    STAIN:자지 |= 4
    CALL PLAYER_SAMEN_STAIN_FROM_TARGET

    BASE:사정 -= EJAC*2

    ;조교 대상이 사정 플래그
    TFLAG:30 = 2
    NOWEX:11 += 2
    EX:11 += 2
;통상의 사정
ELSEIF TFLAG:91 == 1
    LOCAL:2 = 40 - (4 * ABL:사정중독)
    DOWNBASE:기력 += LOCAL:2

    ;対象の사정経験を見る
    IF EXP:사정경험 < EXPLV:1
        SOURCE:12 += 10000
        SOURCE:22 += 5000
    ELSEIF EXP:사정경험 < EXPLV:2
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:사정경험 < EXPLV:3
        SOURCE:12 += 2500
        SOURCE:22 += 2000
    ELSEIF EXP:사정경험 < EXPLV:4
        SOURCE:12 += 1600
        SOURCE:22 += 1400
    ELSEIF EXP:사정경험 < EXPLV:5
        SOURCE:12 += 800
        SOURCE:22 += 500
    ELSE
        SOURCE:12 += 200
        SOURCE:22 += 250
    ENDIF

    SOURCE:18 += ABL:사정중독 * 750

    PRINTFORML %CALLNAME:TARGET% 사정
    SIF EXP:사정경험 == 0 && TALENT:남자 == 0
        TCVAR:50 += 1
    TCVAR:3 += 1

    CALL IN_VAGINA_CHECK_T
    SIF TEQUIP:31
        TEQUIP:31 = 0

    ;Ｐに精液汚れ
    STAIN:자지 |= 4
    CALL PLAYER_SAMEN_STAIN_FROM_TARGET

    BASE:사정 -= EJAC

    ;조교 대상이 사정 플래그
    TFLAG:30 = 1
    NOWEX:11 += 1
    EX:11 += 1
ENDIF
BASE:사정 = MIN(BASE:사정, EJAC - 1)

;-------------------------------------------------
;조교 대상의 분유 체크
;-------------------------------------------------
@TARGET_MILK_CHECK
LOCAL = UP:0 / 50 + UP:1 / 50 + UP:2 / 50 + UP:3 * 3

;자제심
SIF TALENT:자제심
    LOCAL /= 2
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TIMES LOCAL , 1.20
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TIMES LOCAL , 0.80
ENDIF
;Ｂ민감
SIF TALENT:B민감
    TIMES LOCAL , 1.50
;절벽
SIF TALENT:절벽
    TIMES LOCAL , 0.25
;빈유
SIF TALENT:빈유
    TIMES LOCAL , 0.50
;음란
SIF TALENT:음란
    TIMES LOCAL , 1.10

;미약
SIF TEQUIP:11
    LOCAL *= 2
;이뇨제
SIF TEQUIP:12
    LOCAL /= 2
;음충
SIF TEQUIP:55 == 1
    LOCAL *= 2

;조교자가 幼児
SIF TALENT:PLAYER:유아
    LOCAL *= 2
;조교자가 幼稚
SIF TALENT:PLAYER:유치
    LOCAL *= 2

;분유中毒のレベルを見る
IF ABL:분유중독 == 0
    TIMES LOCAL , 1.00
ELSEIF ABL:분유중독 == 1
    TIMES LOCAL , 1.05
ELSEIF ABL:분유중독 == 2
    TIMES LOCAL , 1.10
ELSEIF ABL:분유중독 == 3
    TIMES LOCAL , 1.20
ELSEIF ABL:분유중독 == 4
    TIMES LOCAL , 1.30
ELSE
    TIMES LOCAL , 1.50
ENDIF

;촉수 임플란트
SIF CFLAG:촉수이식 & 8
    TIMES LOCAL , 1.25

LOCAL = 500 + LOCAL / 2
BASE:모유 += LOCAL

LOCAL:1 = BASE:모유
EJAC = MAXBASE:모유

IF LOCAL:1 > EJAC * 2
    LOCAL:2 = 2
ELSEIF LOCAL:1 > EJAC
    LOCAL:2 = 1
ELSE
    LOCAL:2 = 0
ENDIF

;Ｂ계 확장コマンド有効の場合, Ｂ刺激がないと분유できない(感覚増幅薬効果中は분유できる)
IF LOCAL:2 >= 1 && FLAG:커맨드확장 & 8 && UP:3 == 0 && NOWEX:23 == 0
    SOURCE:18 += ((BASE:모유 * 10) / MAXBASE:모유)
    SOURCE:20 += ((BASE:모유 * 5) / MAXBASE:모유)
    TIMES SOURCE:18 , 1.10
    TIMES SOURCE:20 , 1.10
    PRINTL ＜분유갈망중＞
    BASE:모유 = EJAC-1
    ;분유갈망중における이벤트 대사 호출
    CALL SELF_KOJO, TARGET, 21
;대량분유저지
ELSEIF LOCAL:2 == 2 && TEQUIP:68
    SOURCE:18 += 400
    SOURCE:22 += 500
    PRINTFORML %CALLNAME:TARGET% 대량분유저지
    BASE:모유 = EJAC-1
    NOWEX:31 += 2
    EX:31 += 2
;통상의 분유저지
ELSEIF LOCAL:2 == 1 && TEQUIP:68
    SOURCE:18 += 150
    SOURCE:22 += 250
    PRINTFORML %CALLNAME:TARGET% 분유저지
    BASE:모유 = EJAC-1
    NOWEX:31 += 1
    EX:31 += 1
;대량분유
ELSEIF LOCAL:2 == 2
    DOWNBASE:0 += 20
    DOWNBASE:기력 += 100

    ;対象の분유経験を見る
    IF EXP:분유경험 < EXPLV:1
        SOURCE:12 += 20000
        SOURCE:22 += 10000
    ELSEIF EXP:분유경험 < EXPLV:2
        SOURCE:12 += 10000
        SOURCE:22 += 8000
    ELSEIF EXP:분유경험 < EXPLV:3
        SOURCE:12 += 7000
        SOURCE:22 += 6000
    ELSEIF EXP:분유경험 < EXPLV:4
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:분유경험 < EXPLV:5
        SOURCE:12 += 3000
        SOURCE:22 += 2000
    ELSE
        SOURCE:12 += 1800
        SOURCE:22 += 1200
    ENDIF

    PRINTFORML %CALLNAME:TARGET%\@(TEQUIP:36) ? %조사만처리(CALLNAME:TARGET,"가")% 입고 있던 붕대에서 힘차게 # 의 유두에서 대량의\@ 모유가 뿜어져 나왔다.
    SIF EXP:분유경험 == 0
        TCVAR:50 += 1
    TCVAR:5 += 2
    ;Ｂに母乳汚れ
    STAIN:가슴 |= 16

    BASE:모유 -= EJAC*2

    ;조교 대상が분유フラグ
    TFLAG:31 += 2
    NOWEX:10 += 2
    EX:10 += 2

    ;搾乳器で母乳が集められているか 체크
    SIF TEQUIP:35 == 2
        TFLAG:126 += 2
;통상의 분유
ELSEIF LOCAL:2 == 1
    DOWNBASE:기력 += 40

    ;対象の분유経験を見る
    IF EXP:분유경험 < EXPLV:1
        SOURCE:12 += 10000
        SOURCE:22 += 5000
    ELSEIF EXP:분유경험 < EXPLV:2
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:분유경험 < EXPLV:3
        SOURCE:12 += 2500
        SOURCE:22 += 2000
    ELSEIF EXP:분유경험 < EXPLV:4
        SOURCE:12 += 1600
        SOURCE:22 += 1400
    ELSEIF EXP:분유경험 < EXPLV:5
        SOURCE:12 += 800
        SOURCE:22 += 500
    ELSE
        SOURCE:12 += 200
        SOURCE:22 += 250
    ENDIF

    PRINTFORML %CALLNAME:TARGET%\@(TEQUIP:36) ? %조사만처리(CALLNAME:TARGET,"가")% 차고있던 붕대에서 모유가 방울방울 새어 # 의 유두에서 모유가 실실\@ 나왔다.
    SIF EXP:분유경험 == 0
        TCVAR:50 += 1
    TCVAR:5 += 1
    ;Ｂに母乳汚れ
    STAIN:가슴 |= 16

    BASE:모유 -= EJAC

    ;조교 대상が분유フラグ
    TFLAG:31 += 1
    NOWEX:10 += 1
    EX:10 += 1

    ;搾乳器で母乳が集められているか 체크
    SIF TEQUIP:35 == 2
        TFLAG:126 += 1
ENDIF
BASE:모유 = MIN(BASE:모유, EJAC - 1)

;母乳回収
SIF LOCAL:2 > 0 && FLAG:SHOP이벤트확장 & 8 && TEQUIP:68 == 0
    CALL SWEET_POTATO_MILK

;-------------------------------------------------
;조교 대상의 방뇨 체크
;-------------------------------------------------
@TARGET_PEE_CHECK
LOCAL = UP:0 / 2 + UP:1 / 10 + UP:2 / 50 + UP:3 / 50
IF LOCAL < 10000 && TEQUIP:12 == 0 && TALENT:오줌싸개버릇 == 0
    RETURN 0
ELSEIF TEQUIP:12 == 0 && TALENT:오줌싸개버릇 == 0
    LOCAL /= 500
ENDIF

;臆病
SIF TALENT:겁쟁이
    TIMES LOCAL , 1.20
;反抗的
SIF TALENT:반항적
    TIMES LOCAL , 0.50
;プライド高い
IF TALENT:프라이드가높음
    TIMES LOCAL , 0.50
;プライド低い
ELSEIF TALENT:프라이드가낮음
    TIMES LOCAL , 1.20
ENDIF
;자제심
SIF TALENT:자제심
    LOCAL /= 4
;目立ちたがり
SIF TALENT:튀고싶어함
    TIMES LOCAL , 1.20
;抑圧
SIF TALENT:억압
    TIMES LOCAL , 0.30
;抵抗
SIF TALENT:저항
    TIMES LOCAL , 0.30
;恥じらい
IF TALENT:부끄럼쟁이
    TIMES LOCAL , 0.20
;恥薄い
ELSEIF TALENT:부끄럼없음
    TIMES LOCAL , 1.50
ENDIF
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TIMES LOCAL , 1.20
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TIMES LOCAL , 0.60
ENDIF
;幼児or幼稚or유아퇴행
SIF TALENT:유아 || TALENT:유치 || TALENT:유아퇴행
    TIMES LOCAL , 1.50

;おもらし癖を持たない
SIF TALENT:오줌싸개버릇 == 0
    LOCAL /= 2
;이뇨제
IF TEQUIP:12
    TIMES LOCAL , 1.50
    LOCAL += 1000
ENDIF

;촉수 임플란트
SIF CFLAG:촉수이식 & 64
    TIMES LOCAL , 1.50

LOCAL /= 2
BASE:뇨의 += LOCAL

LOCAL:1 = BASE:뇨의
EJAC = MAXBASE:뇨의

IF LOCAL:1 > EJAC * 2
    LOCAL:2 = 2
ELSEIF LOCAL:1 > EJAC
    LOCAL:2 = 1
ELSE
    LOCAL:2 = 0
ENDIF

;Ｃ계 확장コマンド有効の場合, Ｃ刺激がないと방뇨できない(感覚増幅薬効果中は방뇨できる)
IF LOCAL:2 >= 1 && FLAG:커맨드확장 & 1 && UP:0 == 0 && NOWEX:20 == 0
    SOURCE:18 += ((BASE:뇨의 * 30) / MAXBASE:뇨의)
    SOURCE:20 += ((BASE:뇨의 * 15) / MAXBASE:뇨의)
    TIMES SOURCE:18 , 1.10
    TIMES SOURCE:20 , 1.10
    PRINTL ＜방뇨갈망중＞
    BASE:뇨의 = EJAC-1
    ;방뇨갈망중における이벤트 대사 호출
    CALL SELF_KOJO, TARGET, 22
;대량방뇨저지
ELSEIF LOCAL:2 == 2 && TEQUIP:68
    SOURCE:18 += 800
    SOURCE:22 += 1000
    PRINTFORML %CALLNAME:TARGET% 대량방뇨저지
    BASE:뇨의 = EJAC-1
    NOWEX:32 += 2
    EX:32 += 2
;통상의 방뇨저지
ELSEIF LOCAL:2 == 1 && TEQUIP:68
    SOURCE:18 += 300
    SOURCE:22 += 500
    PRINTFORML %CALLNAME:TARGET% 방뇨저지
    BASE:뇨의 = EJAC-1
    NOWEX:32 += 1
    EX:32 += 1
;강헛방뇨(オトコのみ)
ELSEIF LOCAL:2 == 2 && TALENT:남자 && (TEQUIP:69 || SELECTCOM == 128)
    SOURCE:18 += ((BASE:뇨의 * 60) / MAXBASE:뇨의)
    SOURCE:20 += ((BASE:뇨의 * 30) / MAXBASE:뇨의)
    TIMES SOURCE:18 , 1.20
    TIMES SOURCE:20 , 1.20
    PRINTFORML %CALLNAME:TARGET% 강헛방뇨
    BASE:뇨의 -= EJAC*2
    NOWEX:43 += 2
    EX:43 += 2
;헛방뇨(オトコのみ)
ELSEIF LOCAL:2 == 1 && TALENT:남자 && (TEQUIP:69 || SELECTCOM == 128)
    SOURCE:18 += ((BASE:뇨의 * 30) / MAXBASE:뇨의)
    SOURCE:20 += ((BASE:뇨의 * 15) / MAXBASE:뇨의)
    TIMES SOURCE:18 , 1.10
    TIMES SOURCE:20 , 1.10
    PRINTFORML %CALLNAME:TARGET% 헛방뇨
    BASE:뇨의 -= EJAC
    NOWEX:43 += 1
    EX:43 += 1
;대량방뇨
ELSEIF LOCAL:2 == 2
    DOWNBASE:0 += 10
    DOWNBASE:기력 += 120

    ;対象の방뇨経験を見る
    IF EXP:방뇨경험 < EXPLV:1
        SOURCE:12 += 20000
        SOURCE:22 += 10000
    ELSEIF EXP:방뇨경험 < EXPLV:2
        SOURCE:12 += 10000
        SOURCE:22 += 8000
    ELSEIF EXP:방뇨경험 < EXPLV:3
        SOURCE:12 += 7000
        SOURCE:22 += 6000
    ELSEIF EXP:방뇨경험 < EXPLV:4
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:방뇨경험 < EXPLV:5
        SOURCE:12 += 3000
        SOURCE:22 += 2000
    ELSE
        SOURCE:12 += 1800
        SOURCE:22 += 1200
    ENDIF

    PRINTFORML %CALLNAME:TARGET% 대량방뇨
    IF EXP:방뇨경험 == 0 && TALENT:오줌싸개버릇 == 0
        CFLAG:방뇨레벨 += 1
        TCVAR:50 += 1
    ELSEIF TALENT:오줌싸개버릇 == 0
        CFLAG:방뇨레벨 += 2
    ENDIF
    TCVAR:6 += 2

    BASE:뇨의 -= EJAC*2

    ;利尿薬を解除
    SIF TEQUIP:12
        TEQUIP:12 = 0

    ;조교 대상が방뇨フラグ
    TFLAG:32 = 2
    NOWEX:12 += 2
    EX:12 += 2
    ;採尿器で尿が集められているか 체크
    SIF TEQUIP:32 == 2
        TFLAG:127 += 2

    ;挿しっぱなしでおしっこされちゃった場合
    SIF TFLAG:102
        CALL URINATION_IN_PLAYER
;통상의 방뇨
ELSEIF LOCAL:2 == 1
    DOWNBASE:기력 += 50

    ;対象の방뇨経験を見る
    IF EXP:방뇨경험 < EXPLV:1
        SOURCE:12 += 10000
        SOURCE:22 += 5000
    ELSEIF EXP:방뇨경험 < EXPLV:2
        SOURCE:12 += 5000
        SOURCE:22 += 4000
    ELSEIF EXP:방뇨경험 < EXPLV:3
        SOURCE:12 += 2500
        SOURCE:22 += 2000
    ELSEIF EXP:방뇨경험 < EXPLV:4
        SOURCE:12 += 1600
        SOURCE:22 += 1400
    ELSEIF EXP:방뇨경험 < EXPLV:5
        SOURCE:12 += 800
        SOURCE:22 += 500
    ELSE
        SOURCE:12 += 200
        SOURCE:22 += 250
    ENDIF

    PRINTFORML %CALLNAME:TARGET% 방뇨
    IF EXP:방뇨경험 == 0 && TALENT:오줌싸개버릇 == 0
        CFLAG:방뇨레벨 += 1
        TCVAR:50 += 1
    ELSEIF TALENT:오줌싸개버릇 == 0
        CFLAG:방뇨레벨 += 1
    ENDIF
    TCVAR:6 += 1

    BASE:뇨의 -= EJAC

    ;조교 대상이 방뇨 플래그
    TFLAG:32 = 1
    NOWEX:12 += 1
    EX:12 += 1
    ;採尿器で尿が集められているか 체크
    SIF TEQUIP:32 == 2
        TFLAG:127 += 1

    ;挿しっぱなしでおしっこされちゃった場合
    SIF TFLAG:102
        CALL URINATION_IN_PLAYER
ENDIF
BASE:뇨의 = MIN(BASE:뇨의, EJAC - 1)

;-------------------------------------------------
;조교 대상に挿しっぱなしでおしっこされた調教者 체크
;-------------------------------------------------
@URINATION_IN_PLAYER
;奴隷が挿入している場合のみを見る
SIF GROUPMATCH(SELECTCOM, 25, 35, 307, 308, 323, 324, 325, 332, 333, 334, 651, 655, 656, 338) == 0
    RETURN 0
;現状, 主人がそうされた場合はTO DO
SIF ASSIPLAY == 0
    RETURN 0

;基礎値は対象の能力に依存する
LOCAL = ABL:욕망 + ABL:봉사정신 + ABL:노출증 + ABL:정액중독
LOCAL:1 = 2 + RAND:LOCAL
LOCAL:2 = 1 + RAND:LOCAL
LOCAL:3 = 100 * (LOCAL:1 + LOCAL:2)
LOCAL:4 = LOCAL:3
LOCAL:5 = 400 * (LOCAL:1 + LOCAL:2)

;조교자가 保守的
SIF TALENT:PLAYER:보수적
    TIMES LOCAL:5 , 3.00

;ABL:조교자의 순종을 본다
IF ABL:PLAYER:순종 == 0
    TIMES LOCAL:3 , 1.60
    TIMES LOCAL:4 , 1.40
    TIMES LOCAL:5 , 1.00
ELSEIF ABL:PLAYER:순종 == 1
    TIMES LOCAL:3 , 1.30
    TIMES LOCAL:4 , 1.20
    TIMES LOCAL:5 , 0.80
ELSEIF ABL:PLAYER:순종 == 2
    TIMES LOCAL:3 , 1.10
    TIMES LOCAL:4 , 1.00
    TIMES LOCAL:5 , 0.70
ELSEIF ABL:PLAYER:순종 == 3
    TIMES LOCAL:3 , 1.00
    TIMES LOCAL:4 , 0.80
    TIMES LOCAL:5 , 0.40
ELSEIF ABL:PLAYER:순종 == 4
    TIMES LOCAL:3 , 0.80
    TIMES LOCAL:4 , 0.50
    TIMES LOCAL:5 , 0.20
ELSE
    TIMES LOCAL:3 , 0.50
    TIMES LOCAL:4 , 0.10
    TIMES LOCAL:5 , 0.00
ENDIF

;ABL:조교자의 排泄中毒をみる
IF ABL:PLAYER:배설중독 == 0
    TIMES LOCAL:3 , 0.60
    TIMES LOCAL:4 , 1.00
ELSEIF ABL:PLAYER:배설중독 == 1
    TIMES LOCAL:3 , 0.40
    TIMES LOCAL:4 , 0.80
ELSEIF ABL:PLAYER:배설중독 == 2
    TIMES LOCAL:3 , 0.25
    TIMES LOCAL:4 , 0.60
ELSEIF ABL:PLAYER:배설중독 == 3
    TIMES LOCAL:3 , 0.10
    TIMES LOCAL:4 , 0.30
ELSEIF ABL:PLAYER:배설중독 == 4
    TIMES LOCAL:3 , 0.00
    TIMES LOCAL:4 , 0.10
ELSE
    TIMES LOCAL:3 , 0.00
    TIMES LOCAL:4 , 0.00
ENDIF

;ABL:조교자의 欲望をみる
IF ABL:PLAYER:욕망 == 0
    TIMES LOCAL:5 , 0.90
ELSEIF ABL:PLAYER:욕망 == 1
    TIMES LOCAL:5 , 0.70
ELSEIF ABL:PLAYER:욕망 == 2
    TIMES LOCAL:5 , 0.50
ELSEIF ABL:PLAYER:욕망 == 3
    TIMES LOCAL:5 , 0.30
ELSEIF ABL:PLAYER:욕망 == 4
    TIMES LOCAL:5 , 0.10
ELSE
    TIMES LOCAL:5 , 0.00
ENDIF

;조교자가 マゾ
SIF TALENT:PLAYER:마조
    TIMES LOCAL:5 , 0.50

;助手の反感と不快のパラに追加
PALAM:PLAYER:20 += LOCAL:3 + LOCAL:5
PALAM:PLAYER:21 += LOCAL:4

LOCAL:10 = TARGET
TARGET = PLAYER
;ここから否定の珠に変換する(助手のパラから珠変換処理は調教終了時には存在しないため)
LOCAL:20 = CALC_JUEL(20)
LOCAL:21 = CALC_JUEL(21)
LOCAL:100 = LOCAL:20 + LOCAL:21
IF JUEL:100 >= 9999999
    LOCAL:100 = 0
ELSEIF JUEL:100 + LOCAL:100 >= 9999999
    LOCAL:100 = MAX(9999999 - JUEL:100, 0)
ENDIF
TARGET = LOCAL:10
;否定の珠を取得しなければここで処理終了
SIF LOCAL:100 < 1
    RETURN 0
;방뇨された助手の이벤트 대사 호출(TFLAG:99にTARGETを入れている, %CALLNAME:(TFLAG:99)%で名前も表示可能)
SIF PLAYER == ASSI
    CALL SELF_KOJO, ASSI, 37, TARGET
;방뇨した対象の이벤트 대사 호출(TFLAG:99が1なら主人調教だが…)
IF TARGET > 0
    TFLAG:99 = (PLAYER == ASSI) ? 0 # 1
    CALL SELF_KOJO, TARGET, 38, TFLAG:99
ENDIF
;地の文カット
SIF CFLAG:지문소거판정 == 0
    PRINTFORML %조사처리(CALLNAME:TARGET,"가")% 싼 오줌을 맞은%조사처리(CALLNAME:PLAYER,"는")% 기분이 나빠졌다.
PRINTFORML 부정의 구슬(%CALLNAME:PLAYER%)＋{LOCAL:100}
JUEL:PLAYER:100 += LOCAL:100

;-------------------------------------------------
;조교 대상의 정음절정 체크
;-------------------------------------------------
;정음절정の仕様を大きく変更。분유などの形式に近い形にしました
;강제정음절정の経験回数, 정음절정ゲージをCFLAG:정음개발도に格納
@TARGET_SEIIN_CHECK
;정액중독を見る
IF ABL:정액중독 == 0
    LOCAL = 0
ELSEIF ABL:정액중독 == 1
    LOCAL = 10
ELSEIF ABL:정액중독 == 2
    LOCAL = 50
ELSEIF ABL:정액중독 == 3
    LOCAL = 100
ELSEIF ABL:정액중독 == 4
    LOCAL = 150
ELSE
    LOCAL = 200
ENDIF

;気丈
SIF TALENT:꿋꿋함
    TIMES LOCAL , 0.60
;保守的
SIF TALENT:보수적
    TIMES LOCAL , 0.60
;楽観的
IF TALENT:낙관적
    TIMES LOCAL , 1.20
;悲観的
ELSEIF TALENT:비관적
    TIMES LOCAL , 0.80
ENDIF
;一線越えない
SIF TALENT:일선을넘지않음
    TIMES LOCAL , 0.20
;抑圧
IF TALENT:억압
    TIMES LOCAL , 0.60
;해방
ELSEIF TALENT:해방
    TIMES LOCAL , 1.50
ENDIF
;汚臭鈍感
IF TALENT:냄새둔감
    TIMES LOCAL , 1.25
;汚臭민감
ELSEIF TALENT:냄새민감
    TIMES LOCAL , 0.75
ENDIF
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TIMES LOCAL , 2.00
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TIMES LOCAL , 0.50
ENDIF
;倒錯的
SIF TALENT:도착적
    TIMES LOCAL , 1.80
;중독되기 쉬움
SIF TALENT:중독되기쉬움
    TIMES LOCAL , 2.00
;음란
SIF TALENT:음란
    TIMES LOCAL , 1.80
;精愛味覚
SIF TALENT:정애미각
    TIMES LOCAL , 2.50

IF LOCAL <= 0
    RETURN 0
ELSE
    CFLAG:정음개발도 += LOCAL
ENDIF
EJAC = 1000
IF CFLAG:정음개발도 > EJAC * 2
    LOCAL:1 = 2
ELSEIF CFLAG:정음개발도 > EJAC
    LOCAL:1 = 1
ELSE
    LOCAL:1 = 0
ENDIF

;対象が[精愛味覚]を持たない場合
IF TALENT:정애미각 == 0
    PRINTL 강제정음절정
    DOWNBASE:0 += 10
    DOWNBASE:기력 += 20

    ;정액중독を見る
    IF ABL:정액중독 < 2
        SOURCE:22 += 1000
        SOURCE:25 += 1000
    ELSEIF ABL:정액중독 < 4
        SOURCE:18 += 500
        SOURCE:22 += 1000
        SOURCE:25 += 500
    ELSE
        SOURCE:18 += 1000
        SOURCE:22 += 1000
    ENDIF
ELSEIF LOCAL:1
    CALL SEIIN_ORGASM, LOCAL:1
ENDIF

;----------------------------------------------------------------
;정음절정의 처리
;----------------------------------------------------------------
@SEIIN_ORGASM, ARG
;정음절정경험의 회수 추가
IF ARG == 2
    PRINTFORML %CALLNAME:TARGET% 정음강절정
    DOWNBASE:기력 += 10
    LOCAL = 2000
    LOCAL:1 = 2000
    LOCAL:2 = 5000
    LOCAL:3 = 8000
ELSE
    PRINTFORML %CALLNAME:TARGET% 정음절정
    DOWNBASE:기력 += 5
    LOCAL = 800
    LOCAL:1 = 1000
    LOCAL:2 = 2500
    LOCAL:3 = 5000
ENDIF
NOWEX:13 += ARG
EX:13 += ARG
TCVAR:8 += ARG
TFLAG:33 = ARG
;첫체험
IF EXP:정음절정경험 <= 1
    TIMES LOCAL , 2.00
    TIMES LOCAL:3 , 3.00
ENDIF
;정액중독
IF ABL:정액중독 == 0
    TIMES LOCAL:1 , 0.40
    TIMES LOCAL:2 , 0.40
    TIMES LOCAL:3 , 2.00
ELSEIF ABL:정액중독 == 1
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.60
    TIMES LOCAL:3 , 1.50
ELSEIF ABL:정액중독 == 2
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
ELSEIF ABL:정액중독 == 3
    TIMES LOCAL:3 , 0.75
ELSEIF ABL:정액중독 == 4
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    TIMES LOCAL:3 , 0.50
ELSE
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 2.00
    TIMES LOCAL:3 , 0.00
ENDIF

SOURCE:12 += LOCAL
SOURCE:18 += LOCAL:1
SOURCE:19 += LOCAL:2
SOURCE:22 += LOCAL:3

CFLAG:정음개발도 -= (EJAC * ARG - 100)
CFLAG:정음개발도 = MIN(CFLAG:정음개발도, EJAC - 1)

;=============================================================================
;소스 보정 처리
;=============================================================================
;-------------------------------------------------
;동성인 경우의 체크
;-------------------------------------------------
@SOURCE_SEX_CHECK
SIF TALENT:남자 == 0 && TALENT:PLAYER:남자
    RETURN 0
SIF TALENT:남자 && TALENT:PLAYER:남자 == 0
    RETURN 0

;레즈
IF TALENT:남자 == 0 && TALENT:PLAYER:남자 == 0
    ;ABL:레즈끼를 본다
    IF ABL:레즈끼 == 0
        TIMES SOURCE:22 , 0.90

        TIMES SOURCE:30 , 0.80
        TIMES SOURCE:31 , 0.80
    ELSEIF ABL:레즈끼 == 1
        SOURCE:24 += 100
        TIMES SOURCE:0 , 1.10
        TIMES SOURCE:1 , 1.10
        TIMES SOURCE:2 , 1.10
        TIMES SOURCE:3 , 1.10
        TIMES SOURCE:16 , 1.10
        TIMES SOURCE:22 , 0.75

        TIMES SOURCE:30 , 0.60
        TIMES SOURCE:31 , 0.60
    ELSEIF ABL:레즈끼 == 2
        SOURCE:24 += 200
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
        TIMES SOURCE:16 , 1.20
        TIMES SOURCE:22 , 0.60

        TIMES SOURCE:30 , 0.40
        TIMES SOURCE:31 , 0.40
    ELSEIF ABL:레즈끼 == 3
        SOURCE:24 += 350
        TIMES SOURCE:0 , 1.30
        TIMES SOURCE:1 , 1.30
        TIMES SOURCE:2 , 1.30
        TIMES SOURCE:3 , 1.30
        TIMES SOURCE:16 , 1.30
        TIMES SOURCE:22 , 0.45

        TIMES SOURCE:30 , 0.25
        TIMES SOURCE:31 , 0.25
    ELSEIF ABL:레즈끼 == 4
        SOURCE:24 += 500
        TIMES SOURCE:0 , 1.40
        TIMES SOURCE:1 , 1.40
        TIMES SOURCE:2 , 1.40
        TIMES SOURCE:3 , 1.40
        TIMES SOURCE:16 , 1.40
        TIMES SOURCE:22 , 0.30

        TIMES SOURCE:30 , 0.15
        TIMES SOURCE:31 , 0.15
    ELSE
        SOURCE:24 += 750
        TIMES SOURCE:0 , 1.60
        TIMES SOURCE:1 , 1.60
        TIMES SOURCE:2 , 1.60
        TIMES SOURCE:3 , 1.60
        TIMES SOURCE:16 , 1.60
        TIMES SOURCE:22 , 0.15

        TIMES SOURCE:30 , 0.10
        TIMES SOURCE:31 , 0.10
    ENDIF

    ;ABL:레즈중독을 본다
    IF ABL:레즈중독 == 1
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
        TIMES SOURCE:16 , 1.20

        TIMES SOURCE:30 , 0.60
        TIMES SOURCE:31 , 0.60
    ELSEIF ABL:레즈중독 == 2
        TIMES SOURCE:0 , 1.40
        TIMES SOURCE:1 , 1.40
        TIMES SOURCE:2 , 1.40
        TIMES SOURCE:3 , 1.40
        TIMES SOURCE:16 , 1.40

        TIMES SOURCE:30 , 0.40
        TIMES SOURCE:31 , 0.40
    ELSEIF ABL:레즈중독 == 3
        TIMES SOURCE:0 , 1.60
        TIMES SOURCE:1 , 1.60
        TIMES SOURCE:2 , 1.60
        TIMES SOURCE:3 , 1.60
        TIMES SOURCE:16 , 1.60

        TIMES SOURCE:30 , 0.30
        TIMES SOURCE:31 , 0.30
    ELSEIF ABL:레즈중독 == 4
        TIMES SOURCE:0 , 1.80
        TIMES SOURCE:1 , 1.80
        TIMES SOURCE:2 , 1.80
        TIMES SOURCE:3 , 1.80
        TIMES SOURCE:16 , 1.80

        TIMES SOURCE:30 , 0.20
        TIMES SOURCE:31 , 0.20
    ELSEIF ABL:레즈중독 >= 5
        TIMES SOURCE:0 , 2.00
        TIMES SOURCE:1 , 2.00
        TIMES SOURCE:2 , 2.00
        TIMES SOURCE:3 , 2.00
        TIMES SOURCE:16 , 2.00

        TIMES SOURCE:30 , 0.10
        TIMES SOURCE:31 , 0.10
    ENDIF
    ;조교자의 ABL:레즈끼
    IF ABL:PLAYER:레즈끼 == 0
        TIMES SOURCE:0 , 0.40
        TIMES SOURCE:1 , 0.40
        TIMES SOURCE:2 , 0.40
        TIMES SOURCE:3 , 0.40
        TIMES SOURCE:11 , 0.20
        TIMES SOURCE:15 , 0.30
        TIMES SOURCE:16 , 0.30
    ELSEIF ABL:PLAYER:레즈끼 == 1
        TIMES SOURCE:0 , 0.70
        TIMES SOURCE:1 , 0.70
        TIMES SOURCE:2 , 0.70
        TIMES SOURCE:3 , 0.70
        TIMES SOURCE:11 , 0.60
        TIMES SOURCE:15 , 0.70
        TIMES SOURCE:16 , 0.70
    ELSEIF ABL:PLAYER:레즈끼 == 2
        TIMES SOURCE:0 , 1.00
        TIMES SOURCE:1 , 1.00
        TIMES SOURCE:2 , 1.00
        TIMES SOURCE:3 , 1.00
        TIMES SOURCE:11 , 1.00
        TIMES SOURCE:15 , 1.00
        TIMES SOURCE:16 , 1.00
    ELSEIF ABL:PLAYER:레즈끼 == 3
        TIMES SOURCE:0 , 1.10
        TIMES SOURCE:1 , 1.10
        TIMES SOURCE:2 , 1.10
        TIMES SOURCE:3 , 1.10
        TIMES SOURCE:11 , 1.40
        TIMES SOURCE:15 , 1.30
        TIMES SOURCE:16 , 1.30
    ELSEIF ABL:PLAYER:레즈끼 == 4
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
        TIMES SOURCE:11 , 1.80
        TIMES SOURCE:15 , 1.60
        TIMES SOURCE:16 , 1.60
    ELSE
        TIMES SOURCE:0 , 1.30
        TIMES SOURCE:1 , 1.30
        TIMES SOURCE:2 , 1.30
        TIMES SOURCE:3 , 1.30
        TIMES SOURCE:11 , 2.50
        TIMES SOURCE:15 , 2.00
        TIMES SOURCE:16 , 2.00
    ENDIF
    ;조교자의 ABL:레즈중독
    IF ABL:PLAYER:레즈중독 == 1
        TIMES SOURCE:0 , 1.10
        TIMES SOURCE:1 , 1.10
        TIMES SOURCE:2 , 1.10
        TIMES SOURCE:3 , 1.10
        TIMES SOURCE:11 , 1.50
        TIMES SOURCE:15 , 1.50
        TIMES SOURCE:16 , 1.50
    ELSEIF ABL:PLAYER:레즈중독 == 2
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
        TIMES SOURCE:11 , 2.00
        TIMES SOURCE:15 , 2.00
        TIMES SOURCE:16 , 2.00
    ELSEIF ABL:PLAYER:레즈중독 == 3
        TIMES SOURCE:0 , 1.40
        TIMES SOURCE:1 , 1.40
        TIMES SOURCE:2 , 1.40
        TIMES SOURCE:3 , 1.40
        TIMES SOURCE:11 , 2.50
        TIMES SOURCE:15 , 2.50
        TIMES SOURCE:16 , 2.50
    ELSEIF ABL:PLAYER:레즈중독 == 4
        TIMES SOURCE:0 , 1.60
        TIMES SOURCE:1 , 1.60
        TIMES SOURCE:2 , 1.60
        TIMES SOURCE:3 , 1.60
        TIMES SOURCE:11 , 3.50
        TIMES SOURCE:15 , 3.00
        TIMES SOURCE:16 , 3.00
    ELSEIF ABL:PLAYER:레즈중독 == 5
        TIMES SOURCE:0 , 1.80
        TIMES SOURCE:1 , 1.80
        TIMES SOURCE:2 , 1.80
        TIMES SOURCE:3 , 1.80
        TIMES SOURCE:11 , 5.00
        TIMES SOURCE:15 , 4.00
        TIMES SOURCE:16 , 4.00
    ENDIF

    ;조교자의 자제심
    IF TALENT:PLAYER:자제심
        TIMES SOURCE:15 , 0.50
        TIMES SOURCE:16 , 0.50
    ENDIF
;ＢＬ
ELSEIF TALENT:남자 && TALENT:PLAYER:남자
    ;ABL:ＢＬ끼를 본다
    IF ABL:BL끼 == 0
        TIMES SOURCE:16 , 0.50

        TIMES SOURCE:30 , 4.00
        TIMES SOURCE:31 , 4.00
    ELSEIF ABL:BL끼 == 1
        SOURCE:24 += 10
        TIMES SOURCE:0 , 1.10
        TIMES SOURCE:1 , 1.10
        TIMES SOURCE:2 , 1.10
        TIMES SOURCE:3 , 1.10
        TIMES SOURCE:16 , 0.70

        TIMES SOURCE:30 , 2.00
        TIMES SOURCE:31 , 2.00
    ELSEIF ABL:BL끼 == 2
        SOURCE:24 += 40
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
        TIMES SOURCE:16 , 0.90

        TIMES SOURCE:30 , 1.40
        TIMES SOURCE:31 , 1.40
    ELSEIF ABL:BL끼 == 3
        SOURCE:24 += 100
        TIMES SOURCE:0 , 1.30
        TIMES SOURCE:1 , 1.30
        TIMES SOURCE:2 , 1.30
        TIMES SOURCE:3 , 1.30
        TIMES SOURCE:16 , 1.10

        TIMES SOURCE:30 , 1.00
        TIMES SOURCE:31 , 1.00
    ELSEIF ABL:BL끼 == 4
        SOURCE:24 += 200
        TIMES SOURCE:0 , 1.40
        TIMES SOURCE:1 , 1.40
        TIMES SOURCE:2 , 1.40
        TIMES SOURCE:3 , 1.40
        TIMES SOURCE:16 , 1.20

        TIMES SOURCE:30 , 0.70
        TIMES SOURCE:31 , 0.70
    ELSE
        SOURCE:24 += 350
        TIMES SOURCE:0 , 1.50
        TIMES SOURCE:1 , 1.50
        TIMES SOURCE:2 , 1.50
        TIMES SOURCE:3 , 1.50
        TIMES SOURCE:16 , 1.30

        TIMES SOURCE:30 , 0.50
        TIMES SOURCE:31 , 0.50
    ENDIF

    ;조교자의 자제심
    IF TALENT:PLAYER:자제심
        TIMES SOURCE:15 , 0.50
        TIMES SOURCE:16 , 0.50
    ENDIF
ENDIF

;-------------------------------------------------
;쾌감 증가 패치의 처리(EASY 한정)
;-------------------------------------------------
;조교자가 男かつ主人, かつ対象が女のとき快感増加
;[ふたなり]やペニバンよりも色々と不遇気味な[オトコ]の特権ということで
@SOURCE_SEX_MALE_CHECK_EASY
;호감도10万越え, ここまで来る人はまずいないとおもうけど…
IF CFLAG:호감도 >= 100000
    SOURCE:24 += 1000 + (CFLAG:호감도 / 100)
    SOURCE:0 *= 10
    SOURCE:1 *= 10
    SOURCE:2 *= 10
    SOURCE:3 *= 10
    SOURCE:16 *= 10
;호감도5万越え, ここで助手・奴隷ともにレズ中毒･レズっ気Lv5のとき（7.488倍）に勝てます
ELSEIF CFLAG:호감도 >= 50000
    SOURCE:24 += 1500
    TIMES SOURCE:0 , 7.50
    TIMES SOURCE:1 , 7.50
    TIMES SOURCE:2 , 7.50
    TIMES SOURCE:3 , 7.50
    TIMES SOURCE:16 ,7.50
ELSEIF CFLAG:호감도 >= 30000
    SOURCE:24 += 1250
    TIMES SOURCE:0 , 5.00
    TIMES SOURCE:1 , 5.00
    TIMES SOURCE:2 , 5.00
    TIMES SOURCE:3 , 5.00
    TIMES SOURCE:16 , 5.00
;호감도2万越え, 女主人による調教の最大値が3.2倍なんでそれに勝つのはここから
ELSEIF CFLAG:호감도 >= 20000
    SOURCE:24 += 1000
    TIMES SOURCE:0 , 3.50
    TIMES SOURCE:1 , 3.50
    TIMES SOURCE:2 , 3.50
    TIMES SOURCE:3 , 3.50
    TIMES SOURCE:16 , 3.50
;호감도1万5千, レズっ気5の中毒充足の750にならぶとともに女주인의 限界すれすれに
ELSEIF CFLAG:호감도 >= 15000
    SOURCE:24 += 750
    TIMES SOURCE:0 , 3.00
    TIMES SOURCE:1 , 3.00
    TIMES SOURCE:2 , 3.00
    TIMES SOURCE:3 , 3.00
    TIMES SOURCE:16 ,3.00
ELSEIF CFLAG:호감도 >= 10000
    SOURCE:24 += 350
    TIMES SOURCE:0 , 2.50
    TIMES SOURCE:1 , 2.50
    TIMES SOURCE:2 , 2.50
    TIMES SOURCE:3 , 2.50
    TIMES SOURCE:16 , 2.50
;ここから主人に対する中毒が発生（マゾっ気Lv1相当）
ELSEIF CFLAG:호감도 >= 5000
    SOURCE:24 += 100
    TIMES SOURCE:0 , 2.00
    TIMES SOURCE:1 , 2.00
    TIMES SOURCE:2 , 2.00
    TIMES SOURCE:3 , 2.00
    TIMES SOURCE:16 , 2.00
ELSEIF CFLAG:호감도 >= 3000
    TIMES SOURCE:0 , 1.50
    TIMES SOURCE:1 , 1.50
    TIMES SOURCE:2 , 1.50
    TIMES SOURCE:3 , 1.50
    TIMES SOURCE:16 , 1.50
ELSEIF CFLAG:호감도 >= 2000
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:16 , 1.20
ELSE
    TIMES SOURCE:0 , 1.10
    TIMES SOURCE:1 , 1.10
    TIMES SOURCE:2 , 1.10
    TIMES SOURCE:3 , 1.10
    TIMES SOURCE:16 , 1.10
ENDIF

;-------------------------------------------------
;쾌감 증가 패치의 처리(NORMAL 이상)
;-------------------------------------------------
;조교자가 男かつ主人, かつ対象が女のとき快感増加
;上昇幅の計算がEASYと違う([淫壷]補正もあり)
;[ふたなり]やペニバンよりも色々と不遇気味な[オトコ]の特権ということで
@SOURCE_SEX_MALE_CHECK_NORMAL
IF CFLAG:호감도 >= 10000
    SOURCE:24 += 2000
    LOCAL = 350
ELSEIF CFLAG:호감도 >= 7500
    SOURCE:24 += 1000
    LOCAL = 250
ELSEIF CFLAG:호감도 >= 5000
    SOURCE:24 += 500
    LOCAL = 200
ELSEIF CFLAG:호감도 >= 3000
    SOURCE:24 += 250
    LOCAL = 175
ELSEIF CFLAG:호감도 >= 2500
    SOURCE:24 += 100
    LOCAL = 150
ELSEIF CFLAG:호감도 >= 2000
    LOCAL = 125
ELSE
    LOCAL = 120
ENDIF
SIF TALENT:음호
    TIMES LOCAL , 1.50

IF LOCAL > 0
    SOURCE:0 *= LOCAL
    SOURCE:0 /= 100
    SOURCE:1 *= LOCAL
    SOURCE:1 /= 100
    SOURCE:2 *= LOCAL
    SOURCE:2 /= 100
    SOURCE:3 *= LOCAL
    SOURCE:3 /= 100
    SOURCE:16 *= LOCAL
    SOURCE:16 /= 100
ENDIF

;-------------------------------------------------
;조교자의 소질 · 능력 체크
;-------------------------------------------------
@PLAYER_SKILL_CHECK
;조교자의 [해방]을 본다
IF TALENT:PLAYER:해방
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:11 , 1.20
ENDIF
;조교자의 [소악마]를 본다
SIF TALENT:PLAYER:소악마
    TIMES SOURCE:12 , 1.60
;조교자의 [매혹]을 본다
IF TALENT:PLAYER:매혹
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:16 , 1.20

    TIMES SOURCE:30 , 0.50
    TIMES SOURCE:31 , 0.50
ENDIF
;조교자의 [수수께끼의 매력], [대범함]을 본다
IF TALENT:PLAYER:수수께끼의매력 || TALENT:PLAYER:대범함
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:16 , 1.20

    TIMES SOURCE:30 , 0.50
    TIMES SOURCE:31 , 0.50
ENDIF
;조교자의 [유아퇴행]을 본다
IF TALENT:PLAYER:유아퇴행
    TIMES SOURCE:0 , 1.10
    TIMES SOURCE:1 , 1.10
    TIMES SOURCE:2 , 1.10
    TIMES SOURCE:3 , 1.10
    TIMES SOURCE:10 , 1.20
    TIMES SOURCE:12 , 1.50
    TIMES SOURCE:16 , 1.20

    TIMES SOURCE:30 , 1.20
    TIMES SOURCE:31 , 1.50
ENDIF

;조교자의 ABL:技巧
IF ABL:PLAYER:기교 == 0
    TIMES SOURCE:0 , 0.50
    TIMES SOURCE:1 , 0.50
    TIMES SOURCE:2 , 0.50
    TIMES SOURCE:3 , 0.50
ELSEIF ABL:PLAYER:기교 == 1
    TIMES SOURCE:0 , 0.80
    TIMES SOURCE:1 , 0.80
    TIMES SOURCE:2 , 0.80
    TIMES SOURCE:3 , 0.80
ELSEIF ABL:PLAYER:기교 == 2
    TIMES SOURCE:0 , 1.00
    TIMES SOURCE:1 , 1.00
    TIMES SOURCE:2 , 1.00
    TIMES SOURCE:3 , 1.00
ELSEIF ABL:PLAYER:기교 == 3
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
ELSEIF ABL:PLAYER:기교 == 4
    TIMES SOURCE:0 , 1.50
    TIMES SOURCE:1 , 1.50
    TIMES SOURCE:2 , 1.50
    TIMES SOURCE:3 , 1.50
ELSE
    TIMES SOURCE:0 , 2.00
    TIMES SOURCE:1 , 2.00
    TIMES SOURCE:2 , 2.00
    TIMES SOURCE:3 , 2.00
ENDIF

;조교자가 助手かつ[연모]で[질투]であるとき
IF ASSIPLAY && TALENT:PLAYER:연모 && TALENT:PLAYER:질투
    ;助手のABL:サドっ気をみる
    IF ABL:ASSI:새드끼 == 0
        TIMES SOURCE:20 , 1.00
        TIMES SOURCE:21 , 1.00
        TIMES SOURCE:23 , 1.00
        TIMES SOURCE:31 , 1.00
    ELSEIF ABL:ASSI:새드끼 == 1
        TIMES SOURCE:20 , 1.10
        TIMES SOURCE:21 , 1.00
        TIMES SOURCE:23 , 1.00
        TIMES SOURCE:31 , 1.05
    ELSEIF ABL:ASSI:새드끼 == 2
        TIMES SOURCE:20 , 1.15
        TIMES SOURCE:21 , 1.05
        TIMES SOURCE:23 , 1.05
        TIMES SOURCE:31 , 1.10
    ELSEIF ABL:ASSI:새드끼 == 3
        TIMES SOURCE:20 , 1.20
        TIMES SOURCE:21 , 1.05
        TIMES SOURCE:23 , 1.10
        TIMES SOURCE:31 , 1.15
    ELSEIF ABL:ASSI:새드끼 == 4
        TIMES SOURCE:20 , 1.25
        TIMES SOURCE:21 , 1.10
        TIMES SOURCE:23 , 1.15
        TIMES SOURCE:31 , 1.20
    ELSE
        TIMES SOURCE:20 , 1.35
        TIMES SOURCE:21 , 1.15
        TIMES SOURCE:23 , 1.20
        TIMES SOURCE:31 , 1.30
    ENDIF
ENDIF

;조교자가 助手かつ[使い魔]であるとき
IF ASSIPLAY && TALENT:PLAYER:사역마
    ;주인의 ABL:技巧をみる
    IF ABL:MASTER:기교 == 0
        TIMES SOURCE:0 , 0.80
        TIMES SOURCE:1 , 0.80
        TIMES SOURCE:2 , 0.80
        TIMES SOURCE:3 , 0.80
    ELSEIF ABL:MASTER:기교 == 1
        TIMES SOURCE:0 , 0.90
        TIMES SOURCE:1 , 0.90
        TIMES SOURCE:2 , 0.90
        TIMES SOURCE:3 , 0.90
    ELSEIF ABL:MASTER:기교 == 2
        TIMES SOURCE:0 , 1.00
        TIMES SOURCE:1 , 1.00
        TIMES SOURCE:2 , 1.00
        TIMES SOURCE:3 , 1.00
    ELSEIF ABL:MASTER:기교 == 3
        TIMES SOURCE:0 , 1.10
        TIMES SOURCE:1 , 1.10
        TIMES SOURCE:2 , 1.10
        TIMES SOURCE:3 , 1.10
    ELSEIF ABL:MASTER:기교 == 4
        TIMES SOURCE:0 , 1.15
        TIMES SOURCE:1 , 1.15
        TIMES SOURCE:2 , 1.15
        TIMES SOURCE:3 , 1.15
    ELSE
        TIMES SOURCE:0 , 1.20
        TIMES SOURCE:1 , 1.20
        TIMES SOURCE:2 , 1.20
        TIMES SOURCE:3 , 1.20
    ENDIF
    ;주인의 [매혹]をみる
    IF TALENT:MASTER:매혹
        TIMES SOURCE:30 , 0.90
        TIMES SOURCE:31 , 0.90
    ENDIF
    ;주인의 [수수께끼의 매력]をみる
    IF TALENT:MASTER:수수께끼의매력
        TIMES SOURCE:30 , 0.90
        TIMES SOURCE:31 , 0.90
    ENDIF
    ;주인의 [소악마]をみる
    SIF TALENT:MASTER:소악마
        TIMES SOURCE:12 , 1.15
    ;주인의 カリスマ(堕とした人数)を見る
    IF FLAG:함락총계
        IF FLAG:함락총계 < 5
            TIMES SOURCE:16 , 1.10
            TIMES SOURCE:23 , 1.10
        ELSEIF FLAG:함락총계 < 10
            TIMES SOURCE:16 , 1.20
            TIMES SOURCE:23 , 1.20
        ELSEIF FLAG:함락총계 < 100
            TIMES SOURCE:16 , 1.30
            TIMES SOURCE:23 , 1.30
        ELSEIF FLAG:함락총계 < 1000
            TIMES SOURCE:16 , 1.40
            TIMES SOURCE:23 , 1.40
        ELSE
            TIMES SOURCE:16 , 1.50
            TIMES SOURCE:23 , 1.50
        ENDIF
    ENDIF
ENDIF

;조교자가 [死神]で[仙人]を調教している, もしくは조교자가 [仙人]で[死神]を調教しているとき
IF (TALENT:PLAYER:사신 && TALENT:선인) || (TALENT:PLAYER:선인 && TALENT:사신)
    TIMES SOURCE:0 , 0.70
    TIMES SOURCE:1 , 0.70
    TIMES SOURCE:2 , 0.70
    TIMES SOURCE:3 , 0.70
    TIMES SOURCE:11 , 0.90
    TIMES SOURCE:16 , 0.90
    TIMES SOURCE:17 , 0.90
    TIMES SOURCE:22 , 0.90
    TIMES SOURCE:29 , 0.90
    TIMES SOURCE:18 , 0.80
    TIMES SOURCE:19 , 0.80
    TIMES SOURCE:20 , 0.80
    TIMES SOURCE:23 , 0.80
    TIMES SOURCE:31 , 1.20
    TIMES SOURCE:32 , 1.20
ENDIF

;조교자가 [妖精知識]を持ち, かつ[妖精]を調教しているとき
IF TALENT:PLAYER:요정지식 && TALENT:요정
    LOCAL:1 = 0
    FOR LOCAL, 0, CHARANUM
        ;失踪中, 調教者, 조교 대상なら除外
        SIF CFLAG:LOCAL:조교관외 || LOCAL == PLAYER || LOCAL == TARGET
            CONTINUE
        ;熾烈なる妖精（とも）との戦いの中で精と子の狭間を見切った
        SIF (TALENT:LOCAL:연모 || TALENT:LOCAL:복종 || TALENT:LOCAL:음란) && TALENT:LOCAL:요정
            LOCAL:1 += 1
    NEXT
    ;堕とした, または堕としている妖精10人につき0.01倍＋
    IF FLAG:요정함락총계 > 999 && LOCAL:1 > 999
        SOURCE:0 *= (1000 + LOCAL:1 + FLAG:요정함락총계)
        SOURCE:1 *= (1000 + LOCAL:1 + FLAG:요정함락총계)
        SOURCE:2 *= (1000 + LOCAL:1 + FLAG:요정함락총계)
        SOURCE:3 *= (1000 + LOCAL:1 + FLAG:요정함락총계)
        IF TEQUIP:90 == 0
            SOURCE:11 *= (LOCAL:1 + FLAG:요정함락총계)
            SOURCE:16 *= (LOCAL:1 + FLAG:요정함락총계)
            SOURCE:17 *= (LOCAL:1 + FLAG:요정함락총계)
            SOURCE:22 *= (LOCAL:1 + FLAG:요정함락총계)
            SOURCE:29 *= (LOCAL:1 + FLAG:요정함락총계)
            SOURCE:18 *= (500 + LOCAL:1 + FLAG:요정함락총계)
            SOURCE:19 *= (500 + LOCAL:1 + FLAG:요정함락총계)
            SOURCE:20 *= (500 + LOCAL:1 + FLAG:요정함락총계)
            SOURCE:23 *= (500 + LOCAL:1 + FLAG:요정함락총계)
        ENDIF
        SOURCE:0 /= 1000
        SOURCE:1 /= 1000
        SOURCE:2 /= 1000
        SOURCE:3 /= 1000
        IF TEQUIP:90 == 0
            SOURCE:11 /= 1000
            SOURCE:16 /= 1000
            SOURCE:17 /= 1000
            SOURCE:22 /= 1000
            SOURCE:29 /= 1000
            SOURCE:18 /= 1000
            SOURCE:19 /= 1000
            SOURCE:20 /= 1000
            SOURCE:23 /= 1000
        ENDIF
    ;オーバーフローこわい人用
    ;IF FLAG:요정함락총계 > 999 && LOCAL:1 > 999
    ;    TIMES SOURCE:0 , 3.00
    ;    TIMES SOURCE:1 , 3.00
    ;    TIMES SOURCE:2 , 3.00
    ;    TIMES SOURCE:3 , 3.00
    ;    IF TEQUIP:90 == 0
    ;        TIMES SOURCE:11 , 2.00
    ;        TIMES SOURCE:16 , 2.00
    ;        TIMES SOURCE:17 , 2.00
    ;        TIMES SOURCE:22 , 2.00
    ;        TIMES SOURCE:29 , 2.00
    ;        TIMES SOURCE:18 , 2.50
    ;        TIMES SOURCE:19 , 2.50
    ;        TIMES SOURCE:20 , 2.50
    ;        TIMES SOURCE:23 , 2.50
    ;    ENDIF
    ELSEIF FLAG:요정함락총계 > 999 && LOCAL:1 > 499
        TIMES SOURCE:0 , 2.70
        TIMES SOURCE:1 , 2.70
        TIMES SOURCE:2 , 2.70
        TIMES SOURCE:3 , 2.70
        IF TEQUIP:90 == 0
            TIMES SOURCE:11 , 1.50
            TIMES SOURCE:16 , 1.50
            TIMES SOURCE:17 , 1.50
            TIMES SOURCE:22 , 1.50
            TIMES SOURCE:29 , 1.50
            TIMES SOURCE:18 , 2.20
            TIMES SOURCE:19 , 2.20
            TIMES SOURCE:20 , 2.20
            TIMES SOURCE:23 , 2.20
        ENDIF
    ELSEIF FLAG:요정함락총계 > 999 && LOCAL:1 > 99
        TIMES SOURCE:0 , 2.50
        TIMES SOURCE:1 , 2.50
        TIMES SOURCE:2 , 2.50
        TIMES SOURCE:3 , 2.50
        IF TEQUIP:90 == 0
            TIMES SOURCE:11 , 1.30
            TIMES SOURCE:16 , 1.30
            TIMES SOURCE:17 , 1.30
            TIMES SOURCE:22 , 1.30
            TIMES SOURCE:29 , 1.30
            TIMES SOURCE:18 , 2.00
            TIMES SOURCE:19 , 2.00
            TIMES SOURCE:20 , 2.00
            TIMES SOURCE:23 , 2.00
        ENDIF
    ELSEIF FLAG:요정함락총계 > 999
        TIMES SOURCE:0 , 2.10
        TIMES SOURCE:1 , 2.10
        TIMES SOURCE:2 , 2.10
        TIMES SOURCE:3 , 2.10
        IF TEQUIP:90 == 0
            TIMES SOURCE:11 , 1.20
            TIMES SOURCE:16 , 1.20
            TIMES SOURCE:17 , 1.20
            TIMES SOURCE:22 , 1.20
            TIMES SOURCE:29 , 1.20
            TIMES SOURCE:18 , 1.50
            TIMES SOURCE:19 , 1.50
            TIMES SOURCE:20 , 1.50
            TIMES SOURCE:23 , 1.50
        ENDIF
    ;フェアリーロードからは心を掌握する能力も追加
    ELSEIF FLAG:요정함락총계 > 499
        TIMES SOURCE:0 , 1.70
        TIMES SOURCE:1 , 1.70
        TIMES SOURCE:2 , 1.70
        TIMES SOURCE:3 , 1.70
        IF TEQUIP:90 == 0
            TIMES SOURCE:11 , 1.10
            TIMES SOURCE:16 , 1.10
            TIMES SOURCE:17 , 1.10
            TIMES SOURCE:22 , 1.10
            TIMES SOURCE:29 , 1.10
            TIMES SOURCE:18 , 1.30
            TIMES SOURCE:19 , 1.30
            TIMES SOURCE:20 , 1.30
            TIMES SOURCE:23 , 1.30
        ENDIF
    ELSEIF FLAG:요정함락총계 > 99
        TIMES SOURCE:0 , 1.70
        TIMES SOURCE:1 , 1.70
        TIMES SOURCE:2 , 1.70
        TIMES SOURCE:3 , 1.70
        IF TEQUIP:90 == 0
            TIMES SOURCE:18 , 1.30
            TIMES SOURCE:19 , 1.30
            TIMES SOURCE:20 , 1.30
            TIMES SOURCE:23 , 1.30
        ENDIF
    ELSEIF FLAG:요정함락총계 > 9
        TIMES SOURCE:0 , 1.50
        TIMES SOURCE:1 , 1.50
        TIMES SOURCE:2 , 1.50
        TIMES SOURCE:3 , 1.50
        IF TEQUIP:90 == 0
            TIMES SOURCE:18 , 1.20
            TIMES SOURCE:19 , 1.20
            TIMES SOURCE:20 , 1.20
            TIMES SOURCE:23 , 1.20
        ENDIF
    ENDIF
    LOCAL:1 = 0
ENDIF

;조교자의 [つるぺた堕し]をみる
;以下[つるぺた堕し]持ちの心の叫び(?)
LOCAL = 0
IF TALENT:PLAYER:절벽가슴격추왕
    ;[絶壁]！鉄壁！無敵！
    IF TALENT:절벽
        LOCAL = 4
    ;[빈유]は品乳である
    ELSEIF TALENT:빈유
        LOCAL = 3
    ;[巨乳]は虚乳にして嘘乳である
    ELSEIF TALENT:거유
        LOCAL = 2
    ;[爆乳]は人類の敵だ！
    ELSEIF TALENT:폭유
        LOCAL = 1
    ENDIF
;조교자의 [大乳導]をみる
ELSEIF TALENT:PLAYER:대유도
    ;[絶壁]
    IF TALENT:절벽
        LOCAL = 1
    ;[빈유]
    ELSEIF TALENT:빈유
        LOCAL = 2
    ;[巨乳]
    ELSEIF TALENT:거유
        LOCAL = 3
    ;[爆乳]
    ELSEIF TALENT:폭유
        LOCAL = 4
    ENDIF
ENDIF
IF LOCAL == 1
    TIMES SOURCE:0 , 0.90
    TIMES SOURCE:1 , 0.90
    TIMES SOURCE:2 , 0.90
    TIMES SOURCE:3 , 0.90
    TIMES SOURCE:10 , 0.90
    TIMES SOURCE:11 , 0.90
    TIMES SOURCE:12 , 0.90
    TIMES SOURCE:22 , 0.90
    TIMES SOURCE:24 , 0.90
ELSEIF LOCAL == 2
    TIMES SOURCE:0 , 0.95
    TIMES SOURCE:1 , 0.95
    TIMES SOURCE:2 , 0.95
    TIMES SOURCE:3 , 0.95
    TIMES SOURCE:10 , 0.95
    TIMES SOURCE:11 , 0.95
    TIMES SOURCE:12 , 0.95
    TIMES SOURCE:22 , 0.95
    TIMES SOURCE:24 , 0.95
ELSEIF LOCAL == 3
    TIMES SOURCE:0 , 1.10
    TIMES SOURCE:1 , 1.10
    TIMES SOURCE:2 , 1.10
    TIMES SOURCE:3 , 1.10
    TIMES SOURCE:10 , 1.10
    TIMES SOURCE:11 , 1.10
    TIMES SOURCE:12 , 1.10
    TIMES SOURCE:22 , 1.10
    TIMES SOURCE:24 , 1.10
ELSEIF LOCAL == 4
    TIMES SOURCE:0 , 1.20
    TIMES SOURCE:1 , 1.20
    TIMES SOURCE:2 , 1.20
    TIMES SOURCE:3 , 1.20
    TIMES SOURCE:10 , 1.20
    TIMES SOURCE:11 , 1.20
    TIMES SOURCE:12 , 1.20
    TIMES SOURCE:22 , 1.20
    TIMES SOURCE:24 , 1.20
ENDIF

;攻撃力が上昇することで定評のある国士無双の薬を조교자가 飲んでいる
LOCAL = 0
IF ASSIPLAY && TFLAG:162
    IF TFLAG:162 <= 10
        LOCAL = 1
    ELSEIF TFLAG:162 <= 20
        LOCAL = 2
    ELSEIF TFLAG:162 <= 30
        LOCAL = 3
    ENDIF
ELSEIF ASSIPLAY == 0 && TFLAG:161
    IF TFLAG:161 <= 10
        LOCAL = 1
    ELSEIF TFLAG:161 <= 20
        LOCAL = 2
    ELSEIF TFLAG:161 <= 30
        LOCAL = 3
    ENDIF
ENDIF
IF LOCAL == 1
    TIMES SOURCE:0 , 1.10
    TIMES SOURCE:1 , 1.10
    TIMES SOURCE:2 , 1.10
    TIMES SOURCE:3 , 1.10
    TIMES SOURCE:20 , 1.10
ELSEIF LOCAL == 2
    TIMES SOURCE:0 , 1.25
    TIMES SOURCE:1 , 1.25
    TIMES SOURCE:2 , 1.25
    TIMES SOURCE:3 , 1.25
    TIMES SOURCE:20 , 1.25
ELSEIF LOCAL == 3
    TIMES SOURCE:0 , 1.50
    TIMES SOURCE:1 , 1.50
    TIMES SOURCE:2 , 1.50
    TIMES SOURCE:3 , 1.50
    TIMES SOURCE:20 , 1.50
ENDIF

;-------------------------------------------------
;스트레스에 따른 소스 보정 체크
;-------------------------------------------------
@SOURCE_STRESS_CHECK
;ストレスは僅か
IF CFLAG:스트레스 < 100
    TIMES SOURCE:14 , 0.90
    TIMES SOURCE:29 , 0.95
;ちょっと気が重い
ELSEIF CFLAG:스트레스 < 250
    TIMES SOURCE:11 , 0.90
    TIMES SOURCE:14 , 0.80
    TIMES SOURCE:15 , 0.90
    TIMES SOURCE:16 , 0.90
    TIMES SOURCE:29 , 0.90
;ある程度重い
ELSEIF CFLAG:스트레스 < 500
    TIMES SOURCE:0 , 0.90
    TIMES SOURCE:1 , 0.90
    TIMES SOURCE:2 , 0.90
    TIMES SOURCE:3 , 0.90
    TIMES SOURCE:10 , 0.90
    TIMES SOURCE:11 , 0.80
    TIMES SOURCE:14 , 0.75
    TIMES SOURCE:15 , 0.85
    TIMES SOURCE:16 , 0.85
    TIMES SOURCE:17 , 0.95
    TIMES SOURCE:18 , 0.95
    TIMES SOURCE:19 , 0.95
    TIMES SOURCE:29 , 0.80
;結構参ってる
ELSEIF CFLAG:스트레스 < 1000
    TIMES SOURCE:0 , 0.80
    TIMES SOURCE:1 , 0.80
    TIMES SOURCE:2 , 0.80
    TIMES SOURCE:3 , 0.80
    TIMES SOURCE:10 , 0.85
    TIMES SOURCE:11 , 0.80
    TIMES SOURCE:14 , 0.70
    TIMES SOURCE:15 , 0.80
    TIMES SOURCE:16 , 0.80
    TIMES SOURCE:17 , 0.90
    TIMES SOURCE:18 , 0.90
    TIMES SOURCE:19 , 0.90
    TIMES SOURCE:28 , 0.95
    TIMES SOURCE:29 , 0.75
    TIMES SOURCE:32 , 1.10
;明らかに様子がおかしい
ELSEIF CFLAG:스트레스 < 3000
    TIMES SOURCE:0 , 0.70
    TIMES SOURCE:1 , 0.70
    TIMES SOURCE:2 , 0.70
    TIMES SOURCE:3 , 0.70
    TIMES SOURCE:10 , 0.75
    TIMES SOURCE:11 , 0.70
    TIMES SOURCE:14 , 0.60
    TIMES SOURCE:15 , 0.75
    TIMES SOURCE:16 , 0.75
    TIMES SOURCE:17 , 0.80
    TIMES SOURCE:18 , 0.80
    TIMES SOURCE:19 , 0.80
    TIMES SOURCE:28 , 0.90
    TIMES SOURCE:29 , 0.70
    TIMES SOURCE:31 , 1.05
    TIMES SOURCE:32 , 1.15
;重症～押し潰されそう
ELSE
    TIMES SOURCE:0 , 0.60
    TIMES SOURCE:1 , 0.60
    TIMES SOURCE:2 , 0.60
    TIMES SOURCE:3 , 0.60
    TIMES SOURCE:10 , 0.70
    TIMES SOURCE:11 , 0.65
    TIMES SOURCE:12 , 0.95
    TIMES SOURCE:14 , 0.55
    TIMES SOURCE:15 , 0.70
    TIMES SOURCE:16 , 0.70
    TIMES SOURCE:17 , 0.75
    TIMES SOURCE:18 , 0.75
    TIMES SOURCE:19 , 0.70
    TIMES SOURCE:24 , 0.90
    TIMES SOURCE:28 , 0.80
    TIMES SOURCE:29 , 0.60
    TIMES SOURCE:31 , 1.10
    TIMES SOURCE:32 , 1.25
ENDIF

;=============================================================================
;파라미터 보정 처리
;=============================================================================
;-------------------------------------------------
;残り気力や欲情・抑鬱による上下の処理(快感系)
;-------------------------------------------------
;快感系のパラメーターは残り気力や욕정이 高いと上昇しやすく, 억울이 高いと上昇しにくいように
;補正幅は1.25～0.5倍
@UP_VIGOR_CVA_CHECK
;残り気力補正
;残り気力が0
IF BASE:기력 <= 0
    LOCAL = 0
;残り気力が25％以下
ELSEIF BASE:기력 <= MAXBASE:기력 / 4
    LOCAL = 1
;残り気力が50％以下
ELSEIF BASE:기력 <= MAXBASE:기력 / 2
    LOCAL = 2
;残り気力が50％ 이상
ELSE
    LOCAL = 3
ENDIF
CALL UP_VIGOR_CVA_CHECK_SUB, LOCAL

;욕정 보정
;욕정이 100 미만
IF PALAM:13 < 100
    LOCAL = 0
;욕정이 500 미만
ELSEIF PALAM:13 < 500
    LOCAL = 1
;욕정이 1500 미만
ELSEIF PALAM:13 < 1500
    LOCAL = 2
;욕정이 5000 미만
ELSEIF PALAM:13 < 5000
    LOCAL = 3
;욕정이 10000 미만
ELSEIF PALAM:13 < 10000
    LOCAL = 4
;욕정이 10000 이상
ELSE
    LOCAL = 5
ENDIF
CALL UP_VIGOR_CVA_CHECK_SUB, LOCAL

;억울 보정
;억울이 100 미만
IF PALAM:22 < 100
    LOCAL = 5
;억울이 500 미만
ELSEIF PALAM:22 < 500
    LOCAL = 4
;억울이 1500 미만
ELSEIF PALAM:22 < 1500
    LOCAL = 3
;억울이 5000 미만
ELSEIF PALAM:22 < 5000
    LOCAL = 2
;억울이 10000 미만
ELSEIF PALAM:22 < 10000
    LOCAL = 1
;억울이 10000 이상
ELSE
    LOCAL = 0
ENDIF
CALL UP_VIGOR_CVA_CHECK_SUB, LOCAL

;보조 처리
@UP_VIGOR_CVA_CHECK_SUB, ARG
IF ARG == 0
    TIMES UP:0 , 0.50
    TIMES UP:1 , 0.50
    TIMES UP:2 , 0.50
    TIMES UP:3 , 0.50
ELSEIF ARG == 1
    TIMES UP:0 , 0.60
    TIMES UP:1 , 0.60
    TIMES UP:2 , 0.60
    TIMES UP:3 , 0.60
ELSEIF ARG == 2
    TIMES UP:0 , 0.80
    TIMES UP:1 , 0.80
    TIMES UP:2 , 0.80
    TIMES UP:3 , 0.80
ELSEIF ARG == 4
    TIMES UP:0 , 1.10
    TIMES UP:1 , 1.10
    TIMES UP:2 , 1.10
    TIMES UP:3 , 1.10
ELSEIF ARG == 5
    TIMES UP:0 , 1.25
    TIMES UP:1 , 1.25
    TIMES UP:2 , 1.25
    TIMES UP:3 , 1.25
ENDIF

;-------------------------------------------------
;残り気力や欲情・抑鬱による上下の処理
;-------------------------------------------------
;残り気力や욕정이 高い, または억울이 低いと上昇しやすい：潤滑・習得・恭順・欲情・反感
;残り気力や욕정이 低い, または억울이 高いと上昇しやすい：屈服・恥情・抑鬱
@UP_VIGOR_CHECK
;残り気力補正
;残り気力が0
IF BASE:기력 <= 0
    LOCAL = 0
;残り気力が25％以下
ELSEIF BASE:기력 <= MAXBASE:기력 / 4
    LOCAL = 1
;残り気力が50％以下
ELSEIF BASE:기력 <= MAXBASE:기력 / 2
    LOCAL = 2
;残り気力が50％ 이상
ELSE
    LOCAL = 3
ENDIF
CALL UP_VIGOR_CHECK_SUB, LOCAL

;욕정 보정
;욕정이 100 미만
IF PALAM:13 < 100
    LOCAL = 0
;욕정이 500 미만
ELSEIF PALAM:13 < 500
    LOCAL = 1
;욕정이 1500 미만
ELSEIF PALAM:13 < 1500
    LOCAL = 2
;욕정이 5000 미만
ELSEIF PALAM:13 < 5000
    LOCAL = 3
;욕정이 10000 미만
ELSEIF PALAM:13 < 10000
    LOCAL = 4
;욕정이 10000 이상
ELSE
    LOCAL = 5
ENDIF
CALL UP_VIGOR_CHECK_SUB, LOCAL

;억울 보정
;억울이 100 미만
IF PALAM:22 < 100
    LOCAL = 5
;억울이 500 미만
ELSEIF PALAM:22 < 500
    LOCAL = 4
;억울이 1500 미만
ELSEIF PALAM:22 < 1500
    LOCAL = 3
;억울이 5000 미만
ELSEIF PALAM:22 < 5000
    LOCAL = 2
;억울이 10000 미만
ELSEIF PALAM:22 < 10000
    LOCAL = 1
;억울이 10000 이상
ELSE
    LOCAL = 0
ENDIF
CALL UP_VIGOR_CHECK_SUB, LOCAL

;보조 처리
@UP_VIGOR_CHECK_SUB, ARG
IF ARG == 0
    TIMES UP:10 , 0.50
    TIMES UP:11 , 0.50
    TIMES UP:12 , 0.50
    TIMES UP:13 , 0.50
    TIMES UP:20 , 0.50
    TIMES UP:14 , 1.25
    TIMES UP:15 , 1.25
    TIMES UP:22 , 1.25
ELSEIF ARG == 1
    TIMES UP:10 , 0.60
    TIMES UP:11 , 0.60
    TIMES UP:12 , 0.60
    TIMES UP:13 , 0.60
    TIMES UP:20 , 0.60
    TIMES UP:14 , 1.10
    TIMES UP:15 , 1.10
    TIMES UP:22 , 1.10
ELSEIF ARG == 2
    TIMES UP:10 , 0.80
    TIMES UP:11 , 0.80
    TIMES UP:12 , 0.80
    TIMES UP:13 , 0.80
    TIMES UP:20 , 0.80
ELSEIF ARG == 3
    TIMES UP:14 , 0.80
    TIMES UP:15 , 0.80
    TIMES UP:22 , 0.80
ELSEIF ARG == 4
    TIMES UP:10 , 1.10
    TIMES UP:11 , 1.10
    TIMES UP:12 , 1.10
    TIMES UP:13 , 1.10
    TIMES UP:20 , 1.10
    TIMES UP:14 , 0.60
    TIMES UP:15 , 0.60
    TIMES UP:22 , 0.60
ELSEIF ARG == 5
    TIMES UP:10 , 1.25
    TIMES UP:11 , 1.25
    TIMES UP:12 , 1.25
    TIMES UP:13 , 1.25
    TIMES UP:20 , 1.25
    TIMES UP:14 , 0.50
    TIMES UP:15 , 0.50
    TIMES UP:22 , 0.50
ENDIF

;-------------------------------------------------
;질투하기 쉬움에 따른 상하의 처리
;-------------------------------------------------
;[연모]가 붙어있는 게 전제
;호감도가 높으면 순종이 오르기 쉽고, 질투도가 없으면 반감이 오르기 쉽다
@UP_ENVY_CHECK
;호감도가 1500 미만
IF CFLAG:호감도 < 1500
    TIMES UP:12 , 1.00
;호감도가 2000 미만
ELSEIF CFLAG:호감도 < 2000
    TIMES UP:12 , 1.25
;호감도가 5000 미만
ELSEIF CFLAG:호감도 < 5000
    TIMES UP:12 , 1.50
;호감도가 5000 이상
ELSE
    TIMES UP:12 , 2.00
ENDIF

;질투도가 10 미만
IF CFLAG:질투포인트 < 10
    TIMES UP:20 , 0.60
;질투도가 25 미만
ELSEIF CFLAG:질투포인트 < 25
    TIMES UP:20 , 0.80
;질투도가 50 미만
ELSEIF CFLAG:질투포인트 < 50
    TIMES UP:20 , 1.00
;질투도가 75 미만
ELSEIF CFLAG:질투포인트 < 75
    TIMES UP:20 , 1.25
;질투도가 100 미만
ELSEIF CFLAG:질투포인트 < 100
    TIMES UP:20 , 1.50
;질투도가 100 이상
ELSE
    TIMES UP:20 , 2.00
ENDIF

;-------------------------------------------------
;소질 등에 따른 상하의 처리(쾌감계)
;-------------------------------------------------
@UP_TALENT_CVA_CHECK
;미약
IF TEQUIP:11
    ;미약중독으로 효과 살짝 강화
    IF TALENT:미약중독
        TIMES UP:0 , 2.25
        TIMES UP:1 , 2.25
        TIMES UP:2 , 2.25
        TIMES UP:3 , 2.25
    ELSE
        TIMES UP:0 , 2.00
        TIMES UP:1 , 2.00
        TIMES UP:2 , 2.00
        TIMES UP:3 , 2.00
    ENDIF
ENDIF
;이뇨제
IF TEQUIP:12
    TIMES UP:0 , 0.70
    TIMES UP:1 , 0.70
    TIMES UP:2 , 0.70
    TIMES UP:3 , 0.70
ENDIF
;실신 중
IF TFLAG:899 > 0
    TIMES UP:0 , 0.20
    TIMES UP:1 , 0.20
    TIMES UP:2 , 0.20
    TIMES UP:3 , 0.20
;睡眠
ELSEIF EQUIP:14
    TIMES UP:0 , 0.75
    TIMES UP:1 , 0.75
    TIMES UP:2 , 0.75
    TIMES UP:3 , 0.75
ENDIF
;촉수言葉責め
IF TEQUIP:95 & 4
    TIMES UP:14 , 1.20
    TIMES UP:15 , 2.80
    TIMES UP:17 , 1.20
    TIMES UP:20 , 1.80
ENDIF

;陰核が成長しすぎていると感度減少
SIF BASE:음핵 > 200
    TIMES UP:0 , 0.75

;肥大陰核
SIF TALENT:비대음핵
    TIMES UP:0 , 0.40
;자제심
IF TALENT:자제심
    TIMES UP:0 , 0.30
    TIMES UP:1 , 0.50
    TIMES UP:2 , 0.70
    TIMES UP:3 , 0.30
ENDIF
;映姫様補正
IF NO:TARGET == 36 && TALENT:쾌감을부정
    IF (TALENT:연모 || TALENT:망신 || TALENT:친애 || TALENT:상애) && ASSIPLAY == 0
        TIMES UP:0 , 1.50
        TIMES UP:1 , 1.50
        TIMES UP:2 , 1.50
        TIMES UP:3 , 1.50
    ELSE
        TIMES UP:0 , 0.75
        TIMES UP:1 , 0.75
        TIMES UP:2 , 0.75
        TIMES UP:3 , 0.75
    ENDIF
ENDIF
;オトコ
SIF TALENT:남자
    TIMES UP:2 , 1.30
;정신붕괴
IF TALENT:정신붕괴
    TIMES UP:0 , 0.20
    TIMES UP:1 , 0.20
    TIMES UP:2 , 0.20
    TIMES UP:3 , 0.20
ENDIF
;괴조인격
IF TALENT:괴조인격
    TIMES UP:0 , 1.25
    TIMES UP:1 , 1.25
    TIMES UP:2 , 1.25
    TIMES UP:3 , 1.25
ENDIF
;음마
IF TALENT:음마
    TIMES UP:0 , 1.75
    TIMES UP:1 , 1.75
    TIMES UP:2 , 1.75
    TIMES UP:3 , 1.75
;즉각함락
ELSEIF TALENT:즉각함락
    TIMES UP:0 , 1.50
    TIMES UP:1 , 1.50
    TIMES UP:2 , 1.50
    TIMES UP:3 , 1.50
ENDIF

;[강시]
IF TALENT:강시
    TIMES UP:0 , 0.60
    TIMES UP:1 , 0.60
    TIMES UP:2 , 0.60
    TIMES UP:3 , 0.60
ENDIF

;1週目
IF FLAG:주회수 == 1
    FOR COUNT, 0, 4
        TIMES UP:COUNT , 1.20
    NEXT
ENDIF
;HARD
IF FLAG:난이도 == 3
    TIMES UP:0 , 0.60
    TIMES UP:1 , 0.60
    TIMES UP:2 , 0.60
    TIMES UP:3 , 0.60
;LUNATIC
ELSEIF FLAG:난이도 == 4 || FLAG:난이도 == 6
    TIMES UP:0 , 0.50
    TIMES UP:1 , 0.50
    TIMES UP:2 , 0.50
    TIMES UP:3 , 0.50
;PHANTASM
ELSEIF FLAG:난이도 >= 5
    TIMES UP:0 , 0.40
    TIMES UP:1 , 0.40
    TIMES UP:2 , 0.40
    TIMES UP:3 , 0.40
ENDIF

;음충
IF TEQUIP:55 == 1
    TIMES UP:0 , 2.00
    TIMES UP:1 , 2.00
    TIMES UP:2 , 2.00
    TIMES UP:3 , 2.00
ENDIF

;クリトリスリング
IF CFLAG:특수장비 & 1
    TIMES UP:0 , 2.00
    UP:0 += 100
ENDIF
;ラビアピアス
SIF CFLAG:특수장비 & 16
    TIMES UP:1 , 0.60
;ニプルピアス
SIF CFLAG:특수장비 & 32
    TIMES UP:3 , 0.25

;防御力が上昇することで定評のある国士無双の薬
IF TFLAG:160 > 20
    TIMES UP:0 , 0.50
    TIMES UP:1 , 0.50
    TIMES UP:2 , 0.50
    TIMES UP:3 , 0.50
ELSEIF TFLAG:160 > 10
    TIMES UP:0 , 0.75
    TIMES UP:1 , 0.75
    TIMES UP:2 , 0.75
    TIMES UP:3 , 0.75
ELSEIF TFLAG:160 > 0
    TIMES UP:0 , 0.90
    TIMES UP:1 , 0.90
    TIMES UP:2 , 0.90
    TIMES UP:3 , 0.90
ENDIF

;-------------------------------------------------
;소질 등에 따른 상하의 처리
;-------------------------------------------------
@UP_TALENT_CHECK
;백보지
IF TALENT:음모없음
    UP:14 += 100
    UP:15 += 200
    UP:22 += 100
    TIMES UP:14 , 1.20
    TIMES UP:15 , 2.50
    TIMES UP:22 , 1.50
    IF BASE:음모 > 50 && BASE:음모 <= 250
        ;生えかけ
        UP:16 += 100
        UP:21 += 100
        TIMES UP:16 , 1.20
        TIMES UP:21 , 1.50
    ENDIF
ENDIF

;미약
IF TEQUIP:11
    ;미약중독으로 효과 살짝 강화
    IF TALENT:미약중독
        TIMES UP:12 , 1.30
        TIMES UP:13 , 2.25
        TIMES UP:14 , 1.30
        TIMES UP:20 , 0.60
        TIMES UP:21 , 0.30
    ELSE
        TIMES UP:12 , 1.20
        TIMES UP:13 , 2.00
        TIMES UP:14 , 1.20
        TIMES UP:20 , 0.75
        TIMES UP:21 , 0.50
    ENDIF
ENDIF
;이뇨제
IF TEQUIP:12
    TIMES UP:12 , 0.80
    TIMES UP:13 , 0.80
    TIMES UP:14 , 1.50
    TIMES UP:15 , 1.20
    TIMES UP:20 , 1.50
    TIMES UP:21 , 1.20
    TIMES UP:22 , 1.50
ENDIF
;수면 or 실신 중
IF EQUIP:14 || TFLAG:899 > 0
    TIMES UP:12 , 0.50
    TIMES UP:13 , 0.75
    TIMES UP:14 , 0.10
    TIMES UP:15 , 0.10
    TIMES UP:17 , 0.00
    TIMES UP:20 , 0.00
    TIMES UP:21 , 0.10
    TIMES UP:22 , 0.00
    TIMES DOWNBASE:기력 , 0.25
ENDIF
;荊
IF TEQUIP:40 == 5
    TIMES UP:16 , 2.00
    TIMES UP:17 , 2.00
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.50
ENDIF
;거미줄
IF TEQUIP:40 == 6 || TEQUIP:40 == 7
    TIMES UP:15 , 1.70
    TIMES UP:16 , 0.80
    TIMES UP:17 , 2.00
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.50
ENDIF
;음충
IF TEQUIP:55 == 1
    TIMES UP:13 , 2.00
    TIMES UP:14 , 1.20
    TIMES UP:17 , 2.00
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.50
ENDIF
;촉수精神制御中
IF TEQUIP:77 == 2
    TIMES UP:12 , 1.50
    TIMES UP:13 , 1.50
    TIMES UP:14 , 1.20
    TIMES UP:15 , 1.20
    TIMES UP:17 , 0.80
    TIMES UP:20 , 0.30
    TIMES UP:21 , 0.40
    TIMES UP:22 , 0.50
    TIMES UP:31 , 1.80
    TIMES UP:32 , 0.75
ENDIF

;臆病
IF TALENT:겁쟁이
    TIMES UP:17 , 2.00
    TIMES UP:20 , 0.50
    TIMES UP:22 , 0.25
ENDIF
;反抗的
IF TALENT:반항적
    TIMES UP:12 , 0.25
    TIMES UP:13 , 0.50
    TIMES UP:20 , 1.50
ENDIF
;気丈
IF TALENT:꿋꿋함
    TIMES UP:12 , 0.30
    TIMES UP:13 , 0.75
    TIMES UP:17 , 0.80
    TIMES UP:20 , 2.00
    TIMES UP:22 , 2.00
ENDIF
;素直
IF TALENT:솔직함
    TIMES UP:12 , 2.00
    TIMES UP:20 , 0.60
ENDIF
;大人しい
SIF TALENT:얌전함
    TIMES UP:20 , 0.30
;プライド高い
IF TALENT:프라이드가높음
    TIMES UP:14 , 0.50
    TIMES UP:17 , 0.60
    TIMES UP:20 , 1.20
;プライド低い
ELSEIF TALENT:프라이드가낮음
    TIMES UP:14 , 2.00
    TIMES UP:17 , 1.50
    TIMES UP:20 , 0.80
ENDIF
;無関心
IF TALENT:무관심
    TIMES UP:12 , 0.50
    TIMES UP:13 , 0.50
    TIMES UP:14 , 0.50
    TIMES UP:17 , 0.80
    TIMES UP:20 , 0.80
ENDIF
;感情乏しい
IF TALENT:감정결여
    TIMES UP:12 , 0.60
    TIMES UP:13 , 0.60
    TIMES UP:14 , 0.60
    TIMES UP:15 , 0.60
    TIMES UP:17 , 0.60
    TIMES UP:20 , 0.60
    TIMES UP:21 , 0.60
    TIMES UP:22 , 0.60
ENDIF
;好奇心
SIF TALENT:호기심
    TIMES UP:11 , 1.20
;保守的
SIF TALENT:보수적
    TIMES UP:11 , 0.80
;楽観的
IF TALENT:낙관적
    TIMES UP:22 , 0.30
;悲観的
ELSEIF TALENT:비관적
    TIMES UP:22 , 2.50
ENDIF
;貞操無頓着
IF TALENT:정조관둔감
    TIMES UP:12 , 1.20
    TIMES UP:13 , 1.25
    TIMES UP:20 , 0.60
    TIMES UP:22 , 0.40
ENDIF
;抑圧
IF TALENT:억압
    TIMES UP:13 , 0.50
    TIMES UP:20 , 2.00
    TIMES UP:22 , 1.50
ENDIF
;해방
IF TALENT:해방
    TIMES UP:13 , 2.00
    TIMES UP:14 , 2.00
ENDIF
;抵抗
IF TALENT:저항
    TIMES UP:13 , 0.50
    TIMES UP:20 , 2.00
ENDIF
;痛みに弱い
IF TALENT:아픔에약함
    TIMES UP:17 , 2.00
    TIMES UP:20 , 1.50
;아픔에 강함
ELSEIF TALENT:아픔에강함
    TIMES UP:17 , 0.50
    TIMES UP:20 , 0.75
ENDIF
;薬毒耐性
IF TALENT:약물내성
    TIMES UP:30 , 0.20
;미약중독
ELSEIF TALENT:미약중독
    TIMES UP:30 , 1.50
ENDIF
;習得早い
IF TALENT:습득빠름
    TIMES UP:11 , 2.00
;習得遅い
ELSEIF TALENT:습득느림
    TIMES UP:11 , 0.50
ENDIF
;헌신적
SIF TALENT:헌신적
    TIMES UP:14 , 2.00
;쾌감에 솔직
IF TALENT:쾌감에솔직
    TIMES UP:13 , 2.00
;쾌감을 부정
ELSEIF TALENT:쾌감을부정
    TIMES UP:13 , 0.50
    ;에이키 님 보정(조수가 하는 조교거나 연애계 소질이 없을 경우 굴복의 파라미터 상승이 억제됨)
    SIF NO:TARGET == 36 && ((TALENT:연모 + TALENT:망신 + TALENT:친애 + TALENT:상애) == 0 || ASSIPLAY)
        TIMES UP:14 , 0.75
ENDIF
;중독되기 쉬움
SIF TALENT:중독되기쉬움
    TIMES UP:30 , 1.20
;거구
IF TALENT:거구
    TIMES UP:16 , 0.75
    TIMES UP:17 , 0.80
ENDIF
;망신 외의 연모계 소질은 주인 조교에서만 효과를 발휘
IF ASSIPLAY == 0
    ;상애
    IF TALENT:상애
        TIMES UP:12 , 2.50
        TIMES UP:14 , 3.00
        TIMES UP:20 , 0.10
        TIMES UP:21 , 0.10
        TIMES UP:22 , 0.10
    ;친애
    ELSEIF TALENT:친애
        TIMES UP:12 , 2.00
        TIMES UP:14 , 2.50
        TIMES UP:20 , 0.20
        TIMES UP:21 , 0.20
        TIMES UP:22 , 0.20
    ;연모
    ELSEIF TALENT:연모
        TIMES UP:12 , 1.50
        TIMES UP:20 , 0.50
        TIMES UP:21 , 0.50
    ENDIF
ENDIF
;망신
IF TALENT:망신
    TIMES UP:14 , 4.00
    TIMES UP:20 , 0.50
ENDIF
;질투
IF TALENT:광기 && ASSI >= 0 && CFLAG:ASSI:호감도 >= 500 && ASSIPLAY == 0
    ;상애
    IF TALENT:ASSI:상애
        TIMES UP:14 , 2.50
        TIMES UP:16 , 2.00
    ;친애
    ELSEIF TALENT:ASSI:친애
        TIMES UP:14 , 2.00
        TIMES UP:16 , 1.50
    ;연모
    ELSEIF TALENT:ASSI:연모
        TIMES UP:14 , 1.50
        TIMES UP:16 , 1.20
    ELSE
        TIMES UP:14 , 1.25
    ENDIF
ENDIF
;유아퇴행
IF TALENT:유아퇴행
    TIMES UP:12 , 1.50
    TIMES UP:16 , 1.50
    TIMES UP:17 , 2.00
    TIMES UP:20 , 2.00
    TIMES UP:30 , 1.20
    TIMES UP:11 , 0.25
    TIMES UP:13 , 0.50
    TIMES UP:15 , 0.25
    TIMES UP:22 , 0.50
ENDIF
;服従
IF TALENT:복종
    TIMES UP:14 , 2.00
    TIMES UP:20 , 0.50
ENDIF
;烙印
IF TALENT:낙인
    TIMES UP:14 , 2.00
    TIMES UP:15 , 2.00
    TIMES UP:20 , 0.30
    TIMES UP:21 , 0.30
ENDIF
;隷属
IF TALENT:예속
    TIMES UP:12 , 1.80
    TIMES UP:14 , 2.50
    TIMES UP:20 , 0.25
    TIMES UP:21 , 0.25
    TIMES UP:22 , 0.20
ENDIF
;傷物
IF TALENT:흠집
    TIMES UP:12 , 0.50
    TIMES UP:16 , 0.80
    TIMES UP:17 , 1.50
    TIMES UP:20 , 1.20
    TIMES UP:22 , 2.50
ENDIF
;使い魔
IF TALENT:사역마
    TIMES UP:12 , 1.75
    TIMES UP:13 , 1.75
    TIMES UP:14 , 1.75
    TIMES UP:20 , 0.60
    TIMES UP:21 , 0.60
ENDIF
;정신붕괴
IF TALENT:정신붕괴
    TIMES UP:11 , 0.40
    TIMES UP:12 , 0.20
    TIMES UP:13 , 0.40
    TIMES UP:14 , 0.20
    TIMES UP:15 , 0.20
    TIMES UP:17 , 0.20
    TIMES UP:20 , 0.20
    TIMES UP:21 , 0.20
    TIMES UP:22 , 0.20
    TIMES UP:30 , 0.20
ENDIF
;괴뢰
IF TALENT:괴뢰
    TIMES UP:12 , 0.40
    TIMES UP:13 , 0.40
    TIMES UP:14 , 0.40
    TIMES UP:15 , 0.40
    TIMES UP:17 , 0.40
    TIMES UP:20 , 0.40
    TIMES UP:21 , 0.40
    TIMES UP:22 , 0.40
ENDIF
;괴조인격
IF TALENT:괴조인격
    TIMES UP:10 , 1.25
    TIMES UP:11 , 1.50
    TIMES UP:12 , 1.50
    TIMES UP:13 , 1.50
    TIMES UP:14 , 1.50
    TIMES UP:15 , 1.25
    TIMES UP:16 , 1.25
    TIMES UP:17 , 1.25
    TIMES UP:20 , 0.20
    TIMES UP:21 , 0.20
    TIMES UP:22 , 0.20
ENDIF
;음마
IF TALENT:음마
    TIMES UP:13 , 3.00
;즉각함락
ELSEIF TALENT:즉각함락
    TIMES UP:13 , 2.00
ENDIF
;흡혈귀
IF TALENT:흡혈귀
    IF ABL:순종 < 3 && ABL:욕망 < 3
        TIMES UP:12 , 0.75
        TIMES UP:14 , 0.75
    ENDIF
    TIMES UP:17 , 0.50
ENDIF
;인형
IF TALENT:인형
    TIMES UP:10 , 0.75
    TIMES UP:13 , 0.75
ENDIF
;악마
SIF TALENT:악마
    TIMES UP:13 , 1.25
IF TALENT:PLAYER:악마
    TIMES UP:13 , 1.25
    TIMES UP:16 , 1.25
ENDIF
;캇파
SIF TALENT:캇파
    TIMES UP:11 , 1.50
SIF TALENT:PLAYER:캇파
    TIMES UP:11 , 1.20
;요호
SIF TALENT:PLAYER:요호
    TIMES UP:15 , 2.50
;사토리(마음의 눈을 닫고 있거나 [정신붕괴] 제외하고)
IF TALENT:사토리 == 1 && TALENT:정신붕괴 == 0
    TIMES UP:17 , 1.25
    TIMES UP:20 , 1.25
ENDIF
IF TALENT:PLAYER:사토리 && TALENT:PLAYER:정신붕괴 == 0 && NO:PLAYER != 64
    TIMES UP:14 , 1.25
    TIMES UP:15 , 1.25
    TIMES UP:17 , 1.25
ENDIF
;오니
IF TALENT:오니
    IF ABL:순종 < 3 && ABL:욕망 < 3
        TIMES UP:12 , 0.80
        TIMES UP:14 , 0.50
    ENDIF
    TIMES UP:15 , 0.75
    TIMES UP:17 , 0.50
ENDIF
;텐구
IF TALENT:텐구
    IF ABL:순종 < 3 && ABL:욕망 < 3
        TIMES UP:12 , 0.60
        TIMES UP:14 , 0.60
    ENDIF
    TIMES UP:11 , 1.10
    TIMES UP:17 , 0.80
ENDIF
;[선인]
IF TALENT:선인
    IF ABL:순종 < 3 && ABL:욕망 < 3
        TIMES UP:13 , 0.50
        TIMES UP:14 , 0.80
    ENDIF
    TIMES UP:21 , 0.80
ENDIF
;[강시]
IF TALENT:강시
    TIMES UP:11 , 0.80
    TIMES UP:14 , 1.20
    TIMES UP:15 , 0.80
    TIMES UP:16 , 0.40
    TIMES UP:17 , 0.60
    TIMES UP:20 , 0.40
    TIMES UP:22 , 0.40
    TIMES UP:30 , 0.60
ENDIF
;[둔갑너구리]
SIF TALENT:PLAYER:둔갑너구리
    TIMES UP:14 , 2.50

;츠쿠모가미(함락소질 없을 때와 함락소질이 있을 때)
;연모, 복종 미취득 시에는 굴복이 오르기 어려우나, 연모 취득시 순종, 복종 취득시 굴복이 오르기 쉽다.
IF TALENT:츠쿠모가미 == 1 && ( TALENT:연모 == 0 || TALENT:복종 == 0 || TALENT:음란 == 0 )
    TIMES UP:14 , 0.80
ENDIF
IF TALENT:츠쿠모가미 == 1 && TALENT:연모
    TIMES UP:12 , 1.30
ENDIF
IF TALENT:츠쿠모가미 == 1 && TALENT:복종
    TIMES UP:14 , 1.30
ENDIF

;인어 - 윤활에 보너스
SIF TALENT:인어
    TIMES UP:10 , 1.25
SIF TALENT:PLAYER:인어
    TIMES UP:10 , 1.25

;목분리 1단계와 2단계 - 습득에 보너스
IF TALENT:목분리 == 1
    TIMES UP:11 , 1.30
ELSEIF TALENT:목분리 == 2
    TIMES UP:11 , 1.50
ENDIF
IF TALENT:PLAYER:목분리 
    TIMES UP:11 , 1.20
    TIMES UP:17 , 1.20
ENDIF

;늑대인간 - 피조교자시에 선도와 욕정, 조교자시에 고통과 공포
IF TALENT:늑대인간
    TIMES UP:13 , 1.25
    TIMES UP:32 , 1.25
ENDIF
IF TALENT:PLAYER:늑대인간
    TIMES UP:16 , 1.20
    TIMES UP:17 , 1.25
ENDIF

;1주차
IF FLAG:주회수 == 1
    FOR COUNT, 11, 18
        TIMES UP:COUNT , 1.25
    NEXT
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.75
    TIMES UP:22 , 0.75
ENDIF
;HARD
IF FLAG:난이도 == 3
    TIMES UP:12 , 0.75
    TIMES UP:13 , 0.75
    TIMES UP:14 , 0.75
    TIMES UP:17 , 0.75
    TIMES UP:21 , 3.00
;LUNATIC
ELSEIF FLAG:난이도 == 4 || FLAG:난이도 == 6
    TIMES UP:12 , 0.50
    TIMES UP:13 , 0.50
    TIMES UP:14 , 0.50
    TIMES UP:17 , 0.50
    TIMES UP:21 , 5.00
;PHANTASM
ELSEIF FLAG:난이도 >= 5
    TIMES UP:12 , 0.30
    TIMES UP:13 , 0.30
    TIMES UP:14 , 0.30
    TIMES UP:17 , 0.30
    TIMES UP:21 , 7.50
ENDIF

;클리토리스 링
IF CFLAG:특수장비 & 1
    UP:13 += 60
    UP:14 += 50
    UP:16 += 80
    TIMES UP:13 , 1.40
    TIMES UP:14 , 1.50
    TIMES UP:16 , 1.20
ENDIF

;조교자의 技巧による反感と不快の軽減処理
IF ABL:PLAYER:기교 == 0
    TIMES UP:20 , 1.20
    TIMES UP:21 , 1.20
ELSEIF ABL:PLAYER:기교 == 1
    TIMES UP:20 , 1.10
    TIMES UP:21 , 1.10
ELSEIF ABL:PLAYER:기교 == 2
    TIMES UP:20 , 1.00
    TIMES UP:21 , 1.00
ELSEIF ABL:PLAYER:기교 == 3
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.75
ELSEIF ABL:PLAYER:기교 == 4
    TIMES UP:20 , 0.50
    TIMES UP:21 , 0.50
ELSE
    TIMES UP:20 , 0.25
    TIMES UP:21 , 0.25
ENDIF
;조교자의 폭발물
IF TALENT:PLAYER:폭발물
    TIMES UP:12 , 0.80
    TIMES UP:13 , 0.75
    TIMES UP:15 , 0.80
    TIMES UP:10 , 1.25
    TIMES UP:14 , 1.40
    TIMES UP:17 , 2.00
ENDIF
;조교자의 사신(상대가 영체라면 굴복도 상승)
IF TALENT:PLAYER:사신 && TALENT:신령 == 0
    SIF TALENT:영체
        TIMES UP:14 , 1.25
    TIMES UP:17 , 1.25
ENDIF

;防御力が上昇することで定評のある国士無双の薬
IF TFLAG:160
    IF TFLAG:160 <= 10
        TIMES UP:13 , 0.90
        TIMES UP:14 , 0.90
        TIMES UP:16 , 0.90
        TIMES UP:20 , 1.10
        TIMES UP:21 , 1.10
        TIMES UP:22 , 1.10
    ELSEIF TFLAG:160 <= 20
        TIMES UP:13 , 0.75
        TIMES UP:14 , 0.75
        TIMES UP:16 , 0.75
        TIMES UP:20 , 1.25
        TIMES UP:21 , 1.25
        TIMES UP:22 , 1.25
    ELSE
        TIMES UP:13 , 0.50
        TIMES UP:14 , 0.50
        TIMES UP:16 , 0.50
        TIMES UP:20 , 1.50
        TIMES UP:21 , 1.50
        TIMES UP:22 , 1.50
    ENDIF
ENDIF

;치욕각인
IF MARK:치욕각인 == 3
    TIMES UP:15 , 1.80
    TIMES UP:22 , 0.40
ELSEIF MARK:치욕각인 == 2
    TIMES UP:15 , 1.50
    TIMES UP:22 , 0.70
ELSEIF MARK:치욕각인 == 1
    TIMES UP:15 , 1.20
    TIMES UP:22 , 0.90
ENDIF
;공포각인
IF MARK:공포각인 == 3
    TIMES UP:17 , 2.40
ELSEIF MARK:공포각인 == 2
    TIMES UP:17 , 1.80
ELSEIF MARK:공포각인 == 1
    TIMES UP:17 , 1.30
ENDIF
;반발각인
IF MARK:반발각인 == 3
    TIMES UP:12 , 0.10
ELSEIF MARK:반발각인 == 2
    TIMES UP:12 , 0.40
ELSEIF MARK:반발각인 == 1
    TIMES UP:12 , 0.70
ENDIF

;촉수調教中か[寄生]・[懐卵]持ちでない限り侵蝕のパラメータは上昇しない
SIF TEQUIP:90 == 0 && TALENT:회란 == 0 && TALENT:기생 == 0
    UP:31 = 0

;=============================================================================
;각인 취득의 체크
;=============================================================================
@MARK_GOT_CHECK
;순종 변동 판정용
LOCAL:2 = ABL:순종
;-------------------------------------------------
;반발각인
;-------------------------------------------------
TFLAG:44 = 0
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 쉽다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 1.20
LOCAL = UP:20 + UP:21
IF LOCAL >= 500 && LOCAL < 2000
    LOCAL:1 = 1
ELSEIF LOCAL >= 2000 && LOCAL < 4000
    LOCAL:1 = 2
ELSEIF LOCAL >= 4000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより反発確定している場合
IF TFLAG:84 > LOCAL:1
    LOCAL:1 = TFLAG:84
    TFLAG:84 = 0
ENDIF
IF MARK:반발각인 < LOCAL:1 && MARK:97 < LOCAL:1 && TFLAG:105 == 0
    TFLAG:44 = LOCAL:1
;HARD 이상の場合, あまりに反感および不快を味合わせると履歴に関わらず反発３を取得
ELSEIF LOCAL >= 40000000 && FLAG:난이도 > 2 && TFLAG:105 == 0
    LOCAL:1 = 3
    TFLAG:44 = LOCAL:1
ENDIF
SIF LOCAL:1 > 0 && TFLAG:105 == 0
    FLAG:417 += LOCAL:1
IF TFLAG:44
    CALL COMMON_MARK_UP, TARGET, 9, LOCAL:1, 0
    ;感情乏しい, 괴뢰, 정신붕괴, 괴조인격の場合は반발각인による従順ダウンはなし
    IF TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TALENT:괴조인격 == 0
        IF ABL:순종 > 0 && ABL:순종 <= 2 && TFLAG:44 == 3
            ABL:순종 = 0
        ELSEIF ABL:순종 == 3 && TFLAG:44 == 3
            ABL:순종 = 2
        ELSEIF ABL:순종 && ABL:순종 <= 2 && TFLAG:44 == 2
            ABL:순종 -= 1
        ENDIF
    ENDIF
ENDIF

;-------------------------------------------------
;고통각인
;-------------------------------------------------
TFLAG:40 = 0
LOCAL = UP:16
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 어렵다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 0.80
IF LOCAL >= 500 && LOCAL < 1500
    LOCAL:1 = 1
ELSEIF LOCAL >= 1500 && LOCAL < 3000
    LOCAL:1 = 2
ELSEIF LOCAL >= 3000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより苦痛確定している場合
IF TFLAG:80 > LOCAL:1
    LOCAL:1 = TFLAG:80
    TFLAG:80 = 0
ENDIF
SIF MARK:고통각인 < LOCAL:1
    TFLAG:40 = LOCAL:1
SIF LOCAL:1 > 0
    FLAG:411 += LOCAL:1
IF TFLAG:40
    CALL COMMON_MARK_UP, TARGET, 0, LOCAL:1, 0
    ;気丈・感情乏しい, 괴뢰, 정신붕괴の場合は고통각인による従順アップはなし
    SIF ABL:순종 == 0 && TALENT:꿋꿋함 == 0 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:40 >= 2
        ABL:순종 = 1
    ;[サド]または[針さばき]の調教者
    IF (TALENT:PLAYER:새드 || (TALENT:PLAYER:바느질 && SELECTCOM == 222)) && TFLAG:40 == 3
        ;地の文表示のときは説明する
        SIF CFLAG:지문소거판정 != 0
            PRINTFORML %조사처리(CALLNAME:TARGET,"는")% %CALLNAME:PLAYER%의 \@(TALENT:PLAYER:바느질 && SELECTCOM == 222) ? 바늘 다루기 # 가학적인 플레이\@로 유발된 고통에 지워지지 않을 공포가 새겨졌다.
        TCVAR:50 += 1
    ENDIF
ENDIF

;-------------------------------------------------
;쾌락각인
;-------------------------------------------------
TFLAG:41 = 0
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 어렵다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 0.80
IF LOCAL >= 1000 && LOCAL < 3000
    LOCAL:1 = 1
ELSEIF LOCAL >= 3000 && LOCAL < 6000
    LOCAL:1 = 2
ELSEIF LOCAL >= 6000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより快楽確定している場合
IF TFLAG:81 > LOCAL:1
    LOCAL:1 = TFLAG:81
    TFLAG:81 = 0
ENDIF
SIF MARK:쾌락각인 < LOCAL:1
    TFLAG:41 = LOCAL:1
SIF LOCAL:1 > 0
    FLAG:412 += LOCAL:1
IF TFLAG:41
    CALL COMMON_MARK_UP, TARGET, 1, LOCAL:1, 0
    ;자제심・感情乏しい, 괴뢰, 정신붕괴の場合は쾌락각인による従順アップはなし
    SIF ABL:순종 == 0 && TALENT:자제심 == 0 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:41 == 3
        ABL:순종 = 1
ENDIF

;-------------------------------------------------
;굴복각인
;-------------------------------------------------
TFLAG:42 = 0
LOCAL = UP:14 + UP:15 / 20 + UP:16 / 20 + UP:17 / 5
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 어렵다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 0.60
IF LOCAL >= 1000 && LOCAL < 2500
    LOCAL:1 = 1
ELSEIF LOCAL >= 2500 && LOCAL < 5000
    LOCAL:1 = 2
ELSEIF LOCAL >= 5000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより屈服確定している場合
IF TFLAG:82 > LOCAL:1
    LOCAL:1 = TFLAG:82
    TFLAG:82 = 0
ENDIF
SIF MARK:굴복각인 < LOCAL:1
    TFLAG:42 = LOCAL:1
SIF LOCAL:1 > 0
    FLAG:413 += LOCAL:1
IF TFLAG:42
    CALL COMMON_MARK_UP, TARGET, 2, LOCAL:1, 0
    ;感情乏しい, 괴뢰, 정신붕괴の場合は굴복각인による従順アップはなし
    IF ABL:순종 < 1 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:42 == 1
        ABL:순종 = 1
    ELSEIF ABL:순종 < 2 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:42 >= 2
        ABL:순종 = 2
    ENDIF
ENDIF

;-------------------------------------------------
;치욕각인
;-------------------------------------------------
TFLAG:46 = 0
LOCAL = UP:15 + UP:14 / 10 + UP:13 / 20
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 어렵다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 0.60
SIF UP:15 < 1000
    LOCAL = 0
IF LOCAL >= 1000 && LOCAL < 2500
    LOCAL:1 = 1
ELSEIF LOCAL >= 2500 && LOCAL < 5000
    LOCAL:1 = 2
ELSEIF LOCAL >= 5000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより恥辱確定している場合
IF TFLAG:86 > LOCAL:1
    LOCAL:1 = TFLAG:86
    TFLAG:86 = 0
ENDIF
SIF MARK:치욕각인 < LOCAL:1
    TFLAG:46 = LOCAL:1
SIF LOCAL:1 > 0
    FLAG:415 += LOCAL:1
IF TFLAG:46
    CALL COMMON_MARK_UP, TARGET, 4, LOCAL:1, 0
    ;感情乏しい, 괴뢰, 정신붕괴, 露出癖Lv3 이상の場合は치욕각인による従順アップはなし
    SIF ABL:순종 < 1 && ABL:노출증 >= 3 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:46 == 3
        ABL:순종 += 1
ENDIF

;-------------------------------------------------
;공포각인
;-------------------------------------------------
TFLAG:43 = 0
LOCAL = UP:17 + UP:16 / 50
;특정 소질이 없는 조수 플레이 중에는 각인이 붙기 어렵다
SIF ASSI >= 0 && ASSIPLAY && TALENT:ASSI:매혹 == 0 && TALENT:ASSI:수수께끼의매력 == 0 && TALENT:ASSI:소악마 == 0 && TALENT:ASSI:고무 == 0
    TIMES LOCAL , 0.80
IF LOCAL >= 1000 && LOCAL < 2500
    LOCAL:1 = 1
ELSEIF LOCAL >= 2500 && LOCAL < 5000
    LOCAL:1 = 2
ELSEIF LOCAL >= 5000
    LOCAL:1 = 3
ELSE
    LOCAL:1 = 0
ENDIF
;調教コマンドにより恐怖確定している場合
IF TFLAG:83 > LOCAL:1
    LOCAL:1 = TFLAG:83
    TFLAG:83 = 0
ENDIF
IF MARK:공포각인 < LOCAL:1 && MARK:96 < LOCAL:1 && TFLAG:105 == 0
    TFLAG:43 = LOCAL:1
;HARD 이상の場合, あまりに苦痛および恐怖を味合わせると履歴に関わらず恐怖３を取得
ELSEIF LOCAL >= 50000000 && FLAG:난이도 > 2 && TFLAG:105 == 0
    LOCAL:1 = 3
    TFLAG:43 = LOCAL:1
ENDIF
SIF LOCAL:1 > 0
    FLAG:416 += LOCAL:1
IF TFLAG:43
    CALL COMMON_MARK_UP, TARGET, 8, LOCAL:1, 0
    ;感情乏しい, 괴뢰, 정신붕괴の場合は공포각인による従順アップはなし
    IF ABL:순종 < 3 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:43 == 3
        ABL:순종 += 1
        ;臆病の場合一気に2上がる
        SIF TALENT:겁쟁이
            ABL:순종 += 1
    ELSEIF ABL:순종 < 2 && TALENT:감정결여 == 0 && TALENT:정신붕괴 == 0 && TALENT:괴뢰 == 0 && TFLAG:43 == 2
        ABL:순종 += 1
    ENDIF
ENDIF

;-------------------------------------------------
;刻印取得による従順変動
;-------------------------------------------------
IF LOCAL:2 != ABL:순종
    PRINTFORML 순종이 LV{ABL:순종}로 변했다.
    CALL JUJUN_UP_CHECK
ENDIF
TFLAG:105 = 0

;=============================================================================
;파라미터 상승치에 따른 추가 처리
;=============================================================================
;-------------------------------------------------
;○○쾌락경험의 체크
;-------------------------------------------------
@EXP_GOT_CHECK
;アナル系である, Ａ快楽の 체크
LOCAL = UP:2
LOCAL:1 = 0

;快Ａのパラ上昇を見る
IF UP:2 < 300
    LOCAL = 0
ELSEIF UP:2 < 1000
    LOCAL *= 1
ELSEIF UP:2 < 5000
    LOCAL *= 2
ELSEIF UP:2 < 10000
    LOCAL *= 3
ELSE
    LOCAL *= 4
ENDIF

;難易度HARD 이상のとき不快のパラ上昇を見る
IF FLAG:난이도 > 2
    IF UP:21 < 300
        TIMES LOCAL , 1.00
    ELSEIF UP:21 < 1000
        TIMES LOCAL , 0.90
    ELSEIF UP:21 < 5000
        TIMES LOCAL , 0.80
    ELSEIF UP:21 < 10000
        TIMES LOCAL , 0.70
    ELSE
        TIMES LOCAL , 0.60
    ENDIF
ENDIF

IF LOCAL >= 12000
    LOCAL:1 = 5
    TIMES UP:14 , 1.20
    TIMES UP:20 , 0.80
    TIMES UP:21 , 0.90
ELSEIF LOCAL >= 8000
    LOCAL:1 = 4
    TIMES UP:14 , 1.15
    TIMES UP:20 , 0.85
    TIMES UP:21 , 0.90
ELSEIF LOCAL >= 5000
    LOCAL:1 = 3
    TIMES UP:14 , 1.10
    TIMES UP:20 , 0.85
    TIMES UP:21 , 0.95
ELSEIF LOCAL >= 3000
    LOCAL:1 = 2
    TIMES UP:14 , 1.05
    TIMES UP:20 , 0.90
    TIMES UP:21 , 0.95
ELSEIF LOCAL >= 2000
    LOCAL:1 = 1
    TIMES UP:14 , 1.00
    TIMES UP:20 , 0.90
    TIMES UP:21 , 1.00
ELSEIF LOCAL >= 1000
    LOCAL:1 = 1
    TIMES UP:14 , 1.00
    TIMES UP:20 , 0.95
    TIMES UP:21 , 1.00
ENDIF
IF LOCAL:1
    TCVAR:43 += LOCAL:1
    TFLAG:62 = LOCAL:1
ENDIF

;バスト系である, Ｂ快楽の 체크
LOCAL = UP:3
LOCAL:1 = 0

;快Ｂのパラ上昇を見る
IF UP:3 < 500
    LOCAL = 0
ELSEIF UP:3 < 1000
    LOCAL *= 1
ELSEIF UP:3 < 5000
    LOCAL *= 2
ELSEIF UP:3 < 10000
    LOCAL *= 3
ELSE
    LOCAL *= 4
ENDIF

;難易度HARD 이상のとき不快のパラ上昇を見る
IF FLAG:난이도 > 2
    IF UP:21 < 300
        TIMES LOCAL , 1.00
    ELSEIF UP:21 < 1000
        TIMES LOCAL , 0.90
    ELSEIF UP:21 < 5000
        TIMES LOCAL , 0.80
    ELSEIF UP:21 < 10000
        TIMES LOCAL , 0.70
    ELSE
        TIMES LOCAL , 0.60
    ENDIF
ENDIF

IF LOCAL >= 18000
    LOCAL:1 = 5
    TIMES UP:14 , 1.20
    TIMES UP:20 , 0.80
    TIMES UP:21 , 0.90
ELSEIF LOCAL >= 12000
    LOCAL:1 = 4
    TIMES UP:14 , 1.15
    TIMES UP:20 , 0.85
    TIMES UP:21 , 0.90
ELSEIF LOCAL >= 7500
    LOCAL:1 = 3
    TIMES UP:14 , 1.10
    TIMES UP:20 , 0.85
    TIMES UP:21 , 0.95
ELSEIF LOCAL >= 5000
    LOCAL:1 = 2
    TIMES UP:14 , 1.05
    TIMES UP:20 , 0.90
    TIMES UP:21 , 0.95
ELSEIF LOCAL >= 3000
    LOCAL:1 = 1
    TIMES UP:14 , 1.00
    TIMES UP:20 , 0.90
    TIMES UP:21 , 1.00
ELSEIF LOCAL >= 1500
    LOCAL:1 = 1
    TIMES UP:14 , 1.00
    TIMES UP:20 , 0.95
    TIMES UP:21 , 1.00
ENDIF
IF LOCAL:1
    TCVAR:44 += LOCAL:1
    TFLAG:63 = LOCAL:1
ENDIF

;奉仕系である, 奉仕快楽の 체크
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0

;このターンに奉仕快楽系調教フラグが立っていなければ奉仕快楽経験は入らない
IF (TFLAG:100 & 1) == 0
    LOCAL = 0
;恭順のパラ上昇を見る
ELSEIF UP:12 < 250
    LOCAL /= 2
ELSEIF UP:12 < 500
    LOCAL *= 1
ELSEIF UP:12 < 1000
    LOCAL *= 2
ELSEIF UP:12 < 2000
    LOCAL *= 3
ELSE
    LOCAL *= 4
ENDIF

;習得のパラ上昇を見る
IF UP:11 < 250
    TIMES LOCAL , 0.30
ELSEIF UP:11 < 500
    TIMES LOCAL , 0.50
ELSEIF UP:11 < 1000
    TIMES LOCAL , 1.00
ELSEIF UP:11 < 2000
    TIMES LOCAL , 1.20
ELSE
    TIMES LOCAL , 1.50
ENDIF

;難易度HARD 이상のとき反感のパラ上昇を見る
IF FLAG:난이도 > 2
    IF UP:20 < 300
        TIMES LOCAL , 1.00
    ELSEIF UP:20 < 1000
        TIMES LOCAL , 0.90
    ELSEIF UP:20 < 5000
        TIMES LOCAL , 0.80
    ELSEIF UP:20 < 10000
        TIMES LOCAL , 0.70
    ELSE
        TIMES LOCAL , 0.60
    ENDIF
ENDIF

IF LOCAL >= 18000
    LOCAL:1 = 16
    TIMES UP:20 , 0.65
    TIMES UP:21 , 0.30
ELSEIF LOCAL >= 12000
    LOCAL:1 = 12
    TIMES UP:20 , 0.65
    TIMES UP:21 , 0.40
ELSEIF LOCAL >= 8000
    LOCAL:1 = 8
    TIMES UP:20 , 0.70
    TIMES UP:21 , 0.50
ELSEIF LOCAL >= 5000
    LOCAL:1 = 6
    TIMES UP:20 , 0.75
    TIMES UP:21 , 0.55
ELSEIF LOCAL >= 3000
    LOCAL:1 = 4
    TIMES UP:20 , 0.80
    TIMES UP:21 , 0.60
ELSEIF LOCAL >= 2000
    LOCAL:1 = 2
    TIMES UP:20 , 0.85
    TIMES UP:21 , 0.70
ELSEIF LOCAL >= 1000
    LOCAL:1 = 1
    TIMES UP:20 , 0.90
    TIMES UP:21 , 0.80
ENDIF
IF LOCAL:1
    TCVAR:20 += LOCAL:1
    TFLAG:53 = LOCAL:1
ENDIF

;露出快楽の 체크
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0
;このターンに露出快楽系調教フラグが立っていなければ露出快楽経験は入らない
IF (TFLAG:100 & 2) == 0
    LOCAL:1 = 0
;恥情のパラ上昇を見る
ELSEIF LOCAL >= 20000 && UP:15 >= 3000
    LOCAL:1 = 16
    TIMES UP:32 , 0.40
ELSEIF LOCAL >= 10000 && UP:15 >= 2000
    LOCAL:1 = 12
    TIMES UP:32 , 0.50
ELSEIF LOCAL >= 8000 && UP:15 >= 1500
    LOCAL:1 = 8
    TIMES UP:32 , 0.60
ELSEIF LOCAL >= 5000 && UP:15 >= 1000
    LOCAL:1 = 4
    TIMES UP:32 , 0.75
ELSEIF LOCAL >= 2500 && UP:15 >= 500
    LOCAL:1 = 2
    TIMES UP:32 , 0.80
ELSEIF LOCAL >= 1000 && UP:15 >= 250
    LOCAL:1 = 1
    TIMES UP:32 , 0.90
ENDIF
IF LOCAL:1
    TCVAR:14 += LOCAL:1
    TFLAG:56 = LOCAL:1
ENDIF

;苦痛快楽の 체크
LOCAL = UP:0 + UP:1 + UP:2 + UP:3
LOCAL:1 = 0

;対象のマゾっ気Lvと苦痛のパラ上昇を見る
IF (ABL:마조끼 >= 5 || LOCAL >= 3000) && UP:16 >= 2000
    LOCAL:1 = 16
    TIMES UP:20 , 0.65
ELSEIF (ABL:마조끼 >= 5 || LOCAL >= 2500) && UP:16 >= 1500
    LOCAL:1 = 12
    TIMES UP:20 , 0.70
ELSEIF (ABL:마조끼 >= 4 || LOCAL >= 1500) && UP:16 >= 1000
    LOCAL:1 = 8
    TIMES UP:20 , 0.75
ELSEIF (ABL:마조끼 >= 4 || LOCAL >= 1000) && UP:16 >= 500
    LOCAL:1 = 4
    TIMES UP:20 , 0.80
ELSEIF (ABL:마조끼 >= 3 || LOCAL >= 600) && UP:16 >= 300
    LOCAL:1 = 2
    TIMES UP:20 , 0.85
ELSEIF (ABL:마조끼 >= 3 || LOCAL >= 300) && UP:16 >= 100
    LOCAL:1 = 1
    TIMES UP:20 , 0.90
ENDIF
IF LOCAL:1
    TCVAR:30 += LOCAL:1
    TFLAG:54 = LOCAL:1
ENDIF

;ＳＭ教育経験の 체크
LOCAL = TFLAG:55
IF LOCAL:1 == 16
    LOCAL *= 3
ELSEIF LOCAL:1 >= 8
    LOCAL *= 2
ENDIF
;ＳＭ教育経験は助手プレイの時か, Ｗスパンキング実行時で主人プレイの時, 助手に加算される
IF LOCAL > 0 && (ASSIPLAY || (ASSIPLAY == 0 && SELECTCOM == 311))
    TCVAR:ASSI:39 += LOCAL
    TFLAG:55 = LOCAL
ENDIF

;-------------------------------------------------
;연동 파라미터 체크
;-------------------------------------------------
;特定のパラメーターが大きく上昇しそうな場合, 対応するパラメーターの上昇値に＋補正が入ったり
;既に溜まっている別のパラメーターが減少する処理
;対応項目
;屈服大幅上昇：抑鬱↑・先導↓
;恥情大幅上昇：屈服↑・恐怖↑
;恐怖大幅上昇：恭順↓・欲情↓
;抑鬱大幅上昇：欲情↓・恥情↑
;侵蝕大幅上昇：屈服↑・恐怖↑
;先導大幅上昇：欲情↑・屈服↓
@VARIABLE_PALAM_CHECK
;屈服
IF UP:14 >= 50000
    TIMES UP:22 , 1.40
    TIMES PALAM:32 , 0.75
    LOCAL = 3000
ELSEIF UP:14 >= 10000
    TIMES UP:22 , 1.20
    TIMES PALAM:32 , 0.80
    LOCAL = 500
ELSEIF UP:14 >= 3000
    TIMES UP:22 , 1.10
    TIMES PALAM:32 , 0.90
    LOCAL = 100
ELSE
    LOCAL = 0
ENDIF
DOWN:32 += LOCAL

;恥情
IF UP:15 >= 50000
    TIMES UP:14 , 1.40
    TIMES UP:17 , 1.40
ELSEIF UP:15 >= 10000
    TIMES UP:14 , 1.20
    TIMES UP:17 , 1.20
ELSEIF UP:15 >= 3000
    TIMES UP:14 , 1.10
    TIMES UP:17 , 1.10
ENDIF

;恐怖
IF UP:17 >= 50000
    TIMES PALAM:12 , 0.75
    TIMES PALAM:13 , 0.75
    LOCAL = 3000
ELSEIF UP:17 >= 10000
    TIMES PALAM:12 , 0.80
    TIMES PALAM:13 , 0.80
    LOCAL = 500
ELSEIF UP:17 >= 3000
    TIMES PALAM:12 , 0.90
    TIMES PALAM:13 , 0.90
    LOCAL = 100
ELSE
    LOCAL = 0
ENDIF
DOWN:12 += LOCAL
DOWN:13 += LOCAL

;抑鬱
IF UP:22 >= 50000
    TIMES PALAM:13 , 0.75
    TIMES UP:15 , 1.40
    LOCAL = 3000
ELSEIF UP:22 >= 10000
    TIMES PALAM:13 , 0.80
    TIMES UP:15 , 1.20
    LOCAL = 500
ELSEIF UP:22 >= 3000
    TIMES PALAM:13 , 0.90
    TIMES UP:15 , 1.10
    LOCAL = 100
ELSE
    LOCAL = 0
ENDIF
DOWN:13 += LOCAL

;侵蝕
IF UP:31 >= 50000
    TIMES UP:14 , 1.40
    TIMES UP:17 , 1.40
ELSEIF UP:31 >= 10000
    TIMES UP:14 , 1.20
    TIMES UP:17 , 1.20
ELSEIF UP:31 >= 3000
    TIMES UP:14 , 1.10
    TIMES UP:17 , 1.10
ENDIF

;先導
IF UP:32 >= 50000
    TIMES UP:13 , 1.40
    TIMES PALAM:14 , 0.75
    LOCAL = 3000
ELSEIF UP:32 >= 10000
    TIMES UP:13 , 1.20
    TIMES PALAM:14 , 0.80
    LOCAL = 500
ELSEIF UP:32 >= 3000
    TIMES UP:13 , 1.10
    TIMES PALAM:14 , 0.90
    LOCAL = 100
ELSE
    LOCAL = 0
ENDIF
DOWN:14 += LOCAL

;-------------------------------------------------
;술 취함 체크(파라미터 관련은 조교 대상뿐)
;-------------------------------------------------
;절정における酔いの深度アップと酔いによるパラメーター変化の処理をここで行う
;補正は酔いが浅いと욕정이 上がりやすく, 反感が上がりにくい
;補正は酔いが深いと不快が上がり, 욕정이 下がる。また薬毒と侵蝕が上がりやすい
;酔いが深まるにつれ, 体力・気力の消耗も大きくなる
@ALCOHOL_DRUNK_CHECK, ARG
;조교 대상만 ○절정で酔いの深度が微弱上昇
IF ARG == TARGET
    LOCAL = 0
    LOCAL:1 = 0
    REPEAT 4
        IF NOWEX:COUNT
            LOCAL += NOWEX:COUNT
            LOCAL:1 += 1
        ENDIF
    REND
    IF LOCAL:1 == 0
        LOCAL *= 1
    ELSEIF LOCAL:1 == 1
        LOCAL *= 2
    ELSEIF LOCAL:1 == 2
        LOCAL *= 4
    ELSEIF LOCAL:1 == 3
        LOCAL *= 7
    ELSE
        LOCAL *= 10
    ENDIF
    BASE:ARG:취기 += LOCAL
ENDIF

;酔いにおけるパラメーター上昇下降補正
LOCAL = (BASE:ARG:취기 *100) / MAXBASE:ARG:취기
IF LOCAL < 40
    ;微酔
    LOCAL:1 = 110
    IF ARG == TARGET
        TIMES UP:13 , 1.20
        TIMES UP:20 , 0.80
    ENDIF
ELSEIF LOCAL < 80
    ;酩酊
    LOCAL:1 = 120
    IF ARG == TARGET
        TIMES UP:13 , 1.50
        TIMES UP:20 , 0.70
    ENDIF
ELSEIF LOCAL < 120
    ;泥酔
    LOCAL:1 = 150
    IF ARG == TARGET
        TIMES UP:13 , 1.20
        TIMES UP:21 , 1.20
        TIMES UP:30 , 1.10
        DOWN:13 += 1000
    ENDIF
ELSEIF LOCAL < 160
    ;狂酔
    LOCAL:1 = 180
    IF ARG == TARGET
        TIMES UP:21 , 1.50
        TIMES UP:30 , 1.20
        UP:31 +=1000
        DOWN:13 += 5000
    ENDIF
ELSE
    ;極酔
    LOCAL:1 = 250
    IF ARG == TARGET
        TIMES UP:21 , 2.50
        TIMES UP:30 , 1.50
        UP:31 +=5000
        DOWN:13 += 10000
    ENDIF
ENDIF

;機械・鬼・黄昏の怪物
SIF TALENT:ARG:기계 || TALENT:ARG:오니 || TALENT:ARG:황혼의괴물
    LOCAL:1 = 100
;河童・天狗
SIF (TALENT:ARG:캇파 || TALENT:ARG:텐구) && LOCAL:1 > 120
    LOCAL:1 = 120

;酔いにおける体力・気力の消耗増加
IF LOCAL:1 != 100
    REPEAT 2
        DOWNBASE:ARG:COUNT *= LOCAL:1
        DOWNBASE:ARG:COUNT /= 100
    REND
ENDIF

;-------------------------------------------------
;소질 [폭발물]의 인화 및 인화 판정 처리
;-------------------------------------------------
;절정を迎えた, あるいは一定量 이상の苦痛を受けたとき判定を行う。
;爆発すると調教に居合わせた面子全員の体力が激減する
@TRAIN_EXPLOSION_CHECK
;조교자가 製作者のときは無条件で爆発しない。ただしアリスはEX化していないときのみ
;また, 製作者番号が500のときは「あなた」が製作者
SIF (NO:PLAYER == TALENT:폭발물 && ((NO:PLAYER == 14 && CFLAG:PLAYER:SP캐릭터 == 0) || NO:PLAYER != 14)) || (NO:PLAYER == 0 && TALENT:폭발물 == 500)
    RETURN 0

LOCAL = 0
REPEAT 4
    ;潤滑が20000以下の時, Ｃ・Ｖ・Ａ・Ｂのいずれかの절정を迎えた場合
    SIF PALAM:10 <= 20000 && NOWEX:COUNT > 0
        LOCAL += (NOWEX:COUNT == 1) ? 150 # 300
    ;潤滑が10000以下で, 入浴中でなく, シャワーも浴びていない時, 분유・사정・방뇨・정음のいずれかの절정を迎えた場合
    SIF PALAM:10 <= 10000 && TEQUIP:54 == 0 && TEQUIP:55 == 0 && NOWEX:(10+COUNT)
        LOCAL += 200
REND
;苦痛が10000 이상上昇した, あるいは気力が最大値の半分以下の時に苦痛が3000 이상上昇した場合
SIF UP:16 >= 10000 || (BASE:기력 <= MAXBASE:기력 / 2 && UP:16 >= 3000)
    LOCAL += 1000
;[해방]もなく, 露出癖がLv3 미만で야외 플레이またはビデオ撮影中, 恥情が10000 이상(이)가 되었다あるいは恥情が2000 이상上昇した場合
SIF TALENT:해방 == 0 && ABL:노출증 < 3 && (TEQUIP:50 || TEQUIP:52) && (PALAM:15 >= 10000 || UP:15 >= 2000)
    LOCAL += 200
;반발각인があるとダメージ悪化
IF MARK:반발각인 == 3
    TIMES LOCAL , 2.00
ELSEIF MARK:반발각인 == 2
    TIMES LOCAL , 1.50
ELSEIF MARK:반발각인 == 1
    TIMES LOCAL , 1.25
ENDIF
; 이상の条件を満たす場合, 爆発処理に移行
IF LOCAL > 0
    PRINTFORML ――강력한 자극에 %조사처리(CALLNAME:TARGET,"는")% 폭발했습니다--
    IF (CFLAG:첫시츄에이션 & 8192) == 0
        CFLAG:첫시츄에이션 |= 8192
        CALL COMMON_UP_EXP, TARGET, 50, 1, 0, 2
    ENDIF
    DOWNBASE:0 += LOCAL
    DOWNBASE:기력 += LOCAL/2
    DOWNBASE:MASTER:체력 += LOCAL
    DOWNBASE:MASTER:기력 += LOCAL/2
    IF ASSI >= 0
        DOWNBASE:ASSI:체력 += LOCAL
        DOWNBASE:ASSI:기력 += LOCAL/2
    ENDIF
ENDIF

;-------------------------------------------------
;향 처리
;-------------------------------------------------
;야외 플레이, お風呂場プレイ, 特殊風呂プレイ中は呼び出されない
@TRAIN_INCENCE
;………………………………………………
;体力消費軽減(シダーウッド・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 1 || TEQUIP:89 == 6
    TIMES DOWNBASE:0 , 0.90
    TIMES DOWNBASE:MASTER:체력 , 0.90
    SIF ASSI >= 0
        TIMES DOWNBASE:ASSI:체력 , 0.90
ENDIF
;………………………………………………
;気力消費軽減(ペパーミント・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 2 || TEQUIP:89 == 6
    TIMES DOWNBASE:기력 , 0.90
    TIMES DOWNBASE:MASTER:기력 , 0.90
    SIF ASSI >= 0
        TIMES DOWNBASE:ASSI:기력 , 0.90
ENDIF
;………………………………………………
;ネガティブパラメーターの上昇量を軽減(ラヴェンダー・フランキンセンス)
;………………………………………………
IF TEQUIP:89 == 4 || TEQUIP:89 == 6
    TIMES UP:20 , 0.80
    TIMES UP:21 , 0.80
    TIMES UP:22 , 0.80
ENDIF

;-------------------------------------------------
;[Debug]의 체크
;-------------------------------------------------
@DEBUG_CHECK
LOCAL = 0
SIF DEBUG_ABL_CHECK1(0, 0)
    LOCAL |= 1

SIF DEBUG_ABL_CHECK1(1, 1)
    LOCAL |= 2

SIF DEBUG_ABL_CHECK1(2, 2)
    LOCAL |= 4

SIF DEBUG_ABL_CHECK1(3, 3)
    LOCAL |= 8

SIF DEBUG_ABL_CHECK1(12, 10)
    LOCAL |= 16

SIF DEBUG_ABL_CHECK1(13, 11)
    LOCAL |= 32

SIF DEBUG_ABL_CHECK1(11, 12)
    LOCAL |= 64

SIF DEBUG_ABL_CHECK2(14, 13, 10)
    LOCAL |= 128

SIF DEBUG_ABL_CHECK2(15, 14, 11)
    LOCAL |= 256

SIF DEBUG_ABL_CHECK2(32, 20, 11)
    LOCAL |= 512

SIF DEBUG_ABL_CHECK2(16, 21, 11)
    LOCAL |= 1024

IF TALENT:남자 == 0
    SIF DEBUG_ABL_CHECK3(12, 22, 11)
        LOCAL |= 2048
ELSE
    SIF DEBUG_ABL_CHECK3(13, 23, 11)
        LOCAL |= 4096
ENDIF

SIF LOCAL == 0
    RETURN 0
;Ｃ感覚上昇
IF LOCAL & 1
    ABL:C감각 += 1
    PRINTFORML %ABLNAME:0%LV{ABL:C감각}(이)가 되었다.
ENDIF
;Ｖ感覚上昇
IF LOCAL & 2
    ABL:V감각 += 1
    PRINTFORML %ABLNAME:1%LV{ABL:V감각}(이)가 되었다.
ENDIF
;Ａ感覚上昇
IF LOCAL & 4
    ABL:A감각 += 1
    PRINTFORML %ABLNAME:2%LV{ABL:A감각}(이)가 되었다.
ENDIF
;Ｂ感覚上昇
IF LOCAL & 8
    ABL:B감각 += 1
    PRINTFORML %ABLNAME:3%LV{ABL:B감각}(이)가 되었다.
ENDIF
;従順Lv上昇
IF LOCAL & 16
    ABL:순종 += 1
    PRINTFORML %ABLNAME:10%LV{ABL:순종}(이)가 되었다.
ENDIF
;欲望Lv上昇
IF LOCAL & 32
    ABL:욕망 += 1
    PRINTFORML %ABLNAME:11%LV{ABL:욕망}(이)가 되었다.
ENDIF
;技巧Lv上昇
IF LOCAL & 64
    ABL:기교 += 1
    PRINTFORML %ABLNAME:12%LV{ABL:기교}(이)가 되었다.
ENDIF
;奉仕精神Lv上昇
IF LOCAL & 128
    ABL:봉사정신 += 1
    PRINTFORML %ABLNAME:13%LV{ABL:봉사정신}(이)가 되었다.
ENDIF
;露出癖Lv上昇
IF LOCAL & 256
    ABL:노출증 += 1
    PRINTFORML %ABLNAME:14%LV{ABL:노출증}(이)가 되었다.
ENDIF
;サドっ気Lv上昇
IF LOCAL & 512
    ABL:새드끼 += 1
    PRINTFORML %ABLNAME:20%LV{ABL:새드끼}(이)가 되었다.
ENDIF
;マゾっ気Lv上昇
IF LOCAL & 1024
    ABL:마조끼 += 1
    PRINTFORML %ABLNAME:21%LV{ABL:마조끼}(이)가 되었다.
ENDIF
;レズっ気Lv上昇
IF LOCAL & 2048
    ABL:레즈끼 += 1
    PRINTFORML %ABLNAME:22%LV{ABL:레즈끼}(이)가 되었다.
ENDIF
;ＢＬっ気Lv上昇
IF LOCAL & 4096
    ABL:BL끼 += 1
    PRINTFORML %ABLNAME:23%LV{ABL:BL끼}(이)가 되었다.
ENDIF

;-------------------------------------------------
;[Debug]의 체크 처리용 계산 식중함수군
;-------------------------------------------------
@DEBUG_ABL_CHECK1(ARG, ARG:1)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1
    RETURNF 1
ELSEIF UP:ARG > 30 && ABL:(ARG:1) < 2
    RETURNF 1
ELSEIF UP:ARG > 60 && ABL:(ARG:1) < 3
    RETURNF 1
ELSEIF UP:ARG > 200 && ABL:(ARG:1) < 4
    RETURNF 1
ELSEIF UP:ARG > 1000 && ABL:(ARG:1) < 5
    RETURNF 1
ENDIF
RETURNF 0

@DEBUG_ABL_CHECK2(ARG, ARG:1, ARG:2)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1 && ABL:(ARG:2) >= 1
    RETURNF 1
ELSEIF UP:ARG > 30 && ABL:(ARG:1) < 2 && ABL:(ARG:2) >= 2
    RETURNF 1
ELSEIF UP:ARG > 60 && ABL:(ARG:1) < 3 && ABL:(ARG:2) >= 3
    RETURNF 1
ELSEIF UP:ARG > 200 && ABL:(ARG:1) < 4 && ABL:(ARG:2) >= 4
    RETURNF 1
ELSEIF UP:ARG > 1000 && ABL:(ARG:1) < 5 && ABL:(ARG:2) >= 5
    RETURNF 1
ENDIF
RETURNF 0

@DEBUG_ABL_CHECK3(ARG, ARG:1, ARG:2)
#FUNCTION
IF UP:ARG > 1 && ABL:(ARG:1) < 1 && ABL:(ARG:2) >= 1
    RETURNF 1
ELSEIF UP:ARG > 5 && ABL:(ARG:1) < 2 && ABL:(ARG:2) >= 2
    RETURNF 1
ELSEIF UP:ARG > 20 && ABL:(ARG:1) < 3 && ABL:(ARG:2) >= 3
    RETURNF 1
ELSEIF UP:ARG > 40 && ABL:(ARG:1) < 4 && ABL:(ARG:2) >= 4
    RETURNF 1
ELSEIF UP:ARG > 100 && ABL:(ARG:1) < 5 && ABL:(ARG:2) >= 5
    RETURNF 1
ENDIF
RETURNF 0

;=============================================================================
;패닉 관련 처리
;=============================================================================
;rev6～7에서 실장할 예정
;패닉 상태가 되면 「강제 외의 봉사계 커맨드」 및 「자위」를 실행할 수 없게 된다
;-------------------------------------------------
;패닉 상태의 유효기간 결정(소질에 따라 길고 짧음이 변화)
;-------------------------------------------------
@PANIC_CHECK
;UP:공포를 본다
IF UP:17 < 2500
    LOCAL = 50
ELSEIF UP:17 < 5000
    LOCAL = 100
ELSEIF UP:17 < 10000
    LOCAL = 150
ELSEIF UP:17 < 50000
    LOCAL = 200
ELSE
    LOCAL = 300
ENDIF

;PALAM:공포를 본다
IF PALAM:17 < PALAMLV:1
    TIMES LOCAL , 0.10
ELSEIF PALAM:17 < PALAMLV:2
    TIMES LOCAL , 0.50
ELSEIF PALAM:17 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:17 < PALAMLV:4
    TIMES LOCAL , 1.50
ELSE
    TIMES LOCAL , 2.00
ENDIF

TFLAG:108 += (LOCAL >= 10) ? LOCAL # 0

;-------------------------------------------------
;시간경과에 따른 패닉으로부터의 회복 처리
;-------------------------------------------------
@PANIC_SANITY
;회복 기초치
LOCAL = 10
;臆病
SIF TALENT:겁쟁이
    TIMES LOCAL , 0.50
;気丈
SIF TALENT:자제심
    TIMES LOCAL , 1.50
;大人しい
SIF TALENT:얌전함
    TIMES LOCAL , 1.20
;자제심
SIF TALENT:자제심
    TIMES LOCAL , 1.50
;狂気
SIF TALENT:광기
    TIMES LOCAL , 0.75

LOCAL = MAX(LOCAL, 0)
TFLAG:108 -= LOCAL
IF TFLAG:108 <= 0
    PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% 공황상태로부터 회복했다.
    TFLAG:108 = 0
ENDIF

;=============================================================================
;실신 처리 관련
;=============================================================================
;실신에 관한 이모저모--------------------------------
;실신 판정
;TFLAG:864～882：실신 중の状態保存および計算用
;TFLAG:883～894：실신 중のUP保存
;TFLAG:895は실신したかどうかの判別用
;TFLAG:896で恐怖, TFLAG:897で절정, TFLAG:898で苦痛を管理（少なくとも1つのフラグが2になると실신, 실신してる間は2を継続）
;TFLAG:899で실신 중のコマンド実行回数管理（실신したコマンドもカウントする, つまり1 이상だと실신 중）
;--------------------------------------------------
@PASSOUT_CHECK
TFLAG:895 = 0
LOCAL = NOWEX:0 + NOWEX:1 + NOWEX:2 + NOWEX:3

;2コマンド連続で「2箇所 이상강절정+αの절정」を満たすとランダムで실신
;（실신 중はカウントしない, 「강절정か2箇所 이상절정」を続けている限りランダムで外れてもフラグは維持）
IF LOCAL >= 16 && TFLAG:897 == 0 && TFLAG:899 < 1 && RAND:10 < 8
    TFLAG:897 = 1
ELSEIF LOCAL >= 16 && TFLAG:897 == 1 && TFLAG:899 < 1 && RAND:10 < 6
    TFLAG:895 = 1
    TFLAG:897 = 2
    TCVAR:55 += 1
    PRINTL 실신
ELSEIF LOCAL < 16 && TFLAG:897 < 2 && TFLAG:899 < 1
    TFLAG:897 = 0
ENDIF

LOCAL:1 = PALAM:16
LOCAL:1 = MIN(LOCAL:1, 15000)
    
;一度に7500 이상の苦痛を受けるか計15000ごとにランダムで실신（既に실신状態の場合はスキップ）
IF (UP:16 >= 7500 || UP:16 + LOCAL:1 >= 15000) && TFLAG:899 < 1 && RAND:10 < 5
    IF TFLAG:895 == 0
        TFLAG:895 = 2
        TFLAG:898 = 2
        TCVAR:55 += 1
        PRINTL 실신
    ELSEIF TFLAG:895 == 1
        TFLAG:895 = 4
        TFLAG:898 = 2
    ENDIF
ENDIF

;一度に5000 이상の恐怖を受けるとランダムで실신
IF UP:17 >= 5000 && TFLAG:899 < 1 && RAND:10 < 5
    IF TFLAG:895 == 0
        TFLAG:895 = 3
        TFLAG:896 = 2
        TCVAR:55 += 1
        PRINTL 실신
    ELSEIF TFLAG:895 == 2
        TFLAG:895 = 6
        TFLAG:896 = 2
    ENDIF
ENDIF

;その回にスタンガンを受ければランダムで실신(タイプはランダム)
IF TFLAG:159 == 1 && TFLAG:899 < 1
    TFLAG:159 = 0
    IF RAND:10 < 8
        ;실신タイプ分け
        IF RAND:3 == 0
            TFLAG:895 = 1
            TFLAG:897 = 2
        ELSEIF RAND:2 == 0
            TFLAG:895 = 2
            TFLAG:898 = 2
        ELSE
            TFLAG:895 = 3
            TFLAG:896 = 2
        ENDIF
        TCVAR:55 += 1
        PRINTL 실신
    ENDIF
ENDIF

;실신 중にコマンド実行
IF TFLAG:896 >= 2 || TFLAG:897 >= 2 || TFLAG:898 >= 2
    IF TFLAG:899 == 0
        TFLAG:899 = 1
    ELSEIF TFLAG:899 >= 1
        TFLAG:899 += 1
    ENDIF
ENDIF

;실신 중に（실신した次のコマンドから）
IF TFLAG:899 >= 2
    ;강烈な절정, 一度に5000 이상の苦痛を受ける, 실신 중に3回コマンドを実行のいずれかでランダムで실신から回復
    ;一度条件を満たした場合回復するか調教を終えるまでコマンド実行毎に判定
    IF LOCAL >= 16 || (TFLAG:899 >= 2 && UP:16 >= 5000) || TFLAG:899 >= 4
        TFLAG:896 = 3
        TFLAG:897 = 3
        TFLAG:898 = 3
        PRINTL 실신상태회복
    ENDIF
ENDIF

;-------------------------------------------------
;실신 중의 텍스트 처리
;-------------------------------------------------
@PASSOUT_TEXT
;실신했을 때
IF TFLAG:895 > 0
    REPEAT 31
        TFLAG:(864 + COUNT) = 0
    REND
ENDIF

;실신回復時のテキストや口上は以下に羅列した情報を参照します。
;判定に加えたい調教状況やアイテムを追加したい場合はここに書き加えて下さい。
;非挿入中且つコンドーム装備中に대량사정するとゴムから溢れる…という個人的設定のため少しややこしくなってます
;余りにも面倒なためテキストは사정系と装備系に分け, どちらかしか表示されないようになってます（優先度は사정＞装備）。
;また, ぶっかけ用に使われているCFLAG:붓카게장소もここで一旦リセットします。

;それ以降
IF TFLAG:899 > 1
    IF TFLAG:11 + TFLAG:36 >= 1
        IF SELECTCOM == 230 || CFLAG:붓카게장소 == 1 || CFLAG:붓카게장소 == 2
            IF TEQUIP:PLAYER:31 == 0
                TFLAG:868 += TFLAG:11 + TFLAG:36
            ELSE
                TFLAG:868 += (TFLAG:11 + TFLAG:36) - 1
            ENDIF
        ELSEIF SELECTCOM == 32 || CFLAG:붓카게장소 == 3 || CFLAG:붓카게장소 == 5
            IF TEQUIP:PLAYER:31 == 0
                TFLAG:869 += TFLAG:11 + TFLAG:36
            ELSE
                TFLAG:869 += (TFLAG:11 + TFLAG:36) - 1
            ENDIF
        ENDIF
    ENDIF
    IF TFLAG:12 + TFLAG:36 >= 1
        IF TEQUIP:PLAYER:31 == 0
            TFLAG:870 += TFLAG:12 + TFLAG:36
        ELSE
            TFLAG:870 += (TFLAG:12 + TFLAG:36) - 1
        ENDIF
    ENDIF
    IF TFLAG:9 + TFLAG:10 + TFLAG:36 >= 1
        IF GROUPMATCH(SELECTCOM, 20, 21, 22, 23, 24, 27, 28, 612, 614, 615, 616, 617, 630) || ((SELECTCOM == 610 && (TFLAG:130 == 1 || TFLAG:131 == 1)))
            SIF TEQUIP:PLAYER:31 == 0
                TFLAG:871 += TFLAG:10 + TFLAG:36
        ELSEIF GROUPMATCH(SELECTCOM, 30, 31, 32, 33, 34, 37, 38, 618, 619) || ((SELECTCOM == 610 && (TFLAG:130 == 2 || TFLAG:131 == 2)))
            SIF TEQUIP:PLAYER:31 == 0
                TFLAG:872 += TFLAG:9 + TFLAG:36
        ENDIF
    ENDIF
    TFLAG:873 += TFLAG:0
    IF TFLAG:10 + TFLAG:36 >= 1
        IF SELECTCOM == 43 || CFLAG:붓카게장소 == 4 || CFLAG:붓카게장소 == 6 || CFLAG:붓카게장소 == 7
            IF TEQUIP:PLAYER:31 == 0
                TFLAG:874 += TFLAG:36
            ELSE
                TFLAG:874 += TFLAG:36 - 1
            ENDIF
        ENDIF
    ENDIF
    SIF TFLAG:10 >= 1
        TFLAG:875 += TFLAG:10
    IF TFLAG:37 >= 1
        IF SELECTCOM == 501
            TFLAG:876 += 100
        ELSEIF SELECTCOM == 502
            TFLAG:876 += 1000
        ELSE
            TFLAG:876 += TFLAG:37
        ENDIF
    ENDIF
ENDIF

;실신 첫회
IF TFLAG:899 == 1
    ;バイブ等挿入系アイテム装備判定
    TFLAG:867 = 0
    TFLAG:877 = 0
    SIF TEQUIP:25 == 1 || TEQUIP:25 == 5
        TFLAG:867 = TEQUIP:25
    SIF TEQUIP:20 == 1 || TEQUIP:20 == 3 || TEQUIP:20 == 4
        TFLAG:877 = TEQUIP:20
    ;取り付け系アイテム装備判定
    TFLAG:866 = 0
    TFLAG:878 = 0
    SIF TEQUIP:30 == 1 || TEQUIP:30 == 2 || TEQUIP:30 == 4 || TEQUIP:30 == 6
        TFLAG:866 = TEQUIP:30
    SIF TEQUIP:35 == 1 || TEQUIP:35 == 2 || TEQUIP:35 == 4
        TFLAG:878 = TEQUIP:35
    ;被虐系アイテム装備判定
    TFLAG:864 = 0
    TFLAG:865 = 0
    TFLAG:879 = 0
    SIF TEQUIP:40
        TFLAG:864 = TEQUIP:40
    SIF TEQUIP:42 == 1
        TFLAG:865 = TEQUIP:42
    SIF TEQUIP:25 == 7 || TEQUIP:25 == 3 || TEQUIP:25 == 4 || TEQUIP:25 == 8
        TFLAG:879 = TEQUIP:25
    ;미약・이뇨제使用判定
    TFLAG:880 = 0
    IF TEQUIP:11
        TFLAG:880 = 11
    ELSEIF TEQUIP:12
        TFLAG:880 = 12
    ENDIF
    ;シチュエーション(特殊コマンド)系の実行中判定
    TFLAG:881 = 0
    IF TEQUIP:50
        TFLAG:881 = 50
    ELSEIF TEQUIP:52
        TFLAG:881 = 52
    ELSEIF TEQUIP:53
        TFLAG:881 = 53
    ENDIF
    ;촉수계 커맨드 실행 중 판정
    TFLAG:882 = TEQUIP:90

    SIF CFLAG:붓카게장소 != 0
        CFLAG:붓카게장소 = 0

;2회째 이후
ELSE
    ;バイブ等挿入系アイテム装備判定
    SIF (TEQUIP:20 == 1 || TEQUIP:20 == 3 || TEQUIP:20 == 4) && (TFLAG:877 != TEQUIP:20)
        TFLAG:877 = (-1)
    SIF (TEQUIP:25 == 1 || TEQUIP:25 == 5) && (TFLAG:867 != TEQUIP:25)
        TFLAG:867 = (-1)
    ;取り付け系アイテム装備判定
    SIF (TEQUIP:30 == 1 || TEQUIP:30 == 2 || TEQUIP:30 == 4 || TEQUIP:30 == 6) && (TFLAG:866 != TEQUIP:30)
        TFLAG:866 = (-1)
    SIF (TEQUIP:35 == 1 || TEQUIP:35 == 2 || TEQUIP:35 == 4) && (TFLAG:878 != TEQUIP:35)
        TFLAG:878 = (-1)
    ;被虐系アイテム装備判定
    SIF TEQUIP:40 && TFLAG:864 != TEQUIP:40
        TFLAG:864 = (-1)
    SIF TEQUIP:42 == 1 && TFLAG:865 != TEQUIP:42
        TFLAG:865 = (-1)
    SIF (TEQUIP:25 == 7 || TEQUIP:25 == 3 || TEQUIP:25 == 4 || TEQUIP:25 == 8) && (TFLAG:879 != TEQUIP:25)
        TFLAG:879 = (-1)
    ;미약・이뇨제使用判定
    SIF (TEQUIP:11 && TFLAG:880 != 11) || (TEQUIP:12 && TFLAG:880 != 12)
        TFLAG:880 = (-1)
    ;シチュエーション(特殊コマンド)系の実行中判定
    SIF (TEQUIP:50 && TFLAG:881 != 50)  || (TEQUIP:52 && TFLAG:881 != 52) || (TEQUIP:53 && TFLAG:881 != 53)
        TFLAG:881 = (-1)
    ;촉수계 커맨드実行中判定
    SIF TEQUIP:90 == 1 && TFLAG:882 != 1
        TFLAG:882 = (-1)
ENDIF

IF TFLAG:899 >= 1
    IF TFLAG:895 == 1
        PRINTFORML …%조사처리(CALLNAME:TARGET,"는")% 절정하며 온몸을 부르르 떨더니 쓰러졌다.
        PRINTFORML 강력한 자극에 정신을 잃었다.
    ELSEIF TFLAG:895 == 2
        PRINTFORML …%조사처리(CALLNAME:TARGET,"는")% 그 자리에서 쓰러졌다. 너무 아파 정신을 잃은 것 같다.
    ELSEIF TFLAG:895 == 3
        PRINTFORML …%조사처리(CALLNAME:TARGET,"는")% 그 자리에서 쓰러졌다. 너무 무서워서 정신을 잃은 것 같다.
    ELSEIF TFLAG:895 == 4
        PRINTFORML …%조사처리(CALLNAME:TARGET,"는")% 온몸을 부르르 떨더니 쓰러졌다.
        PRINTFORML 쾌감과 아픔이 동시에 몰려와 의식을 잃어 버린 것 같다.
    ELSEIF TFLAG:895 == 6
        PRINTFORML …%조사처리(CALLNAME:TARGET,"는")% 절정하며 온몸을 부르르 떨더니 쓰러졌다.
        PRINTFORML 아픔과 공포를 참다가 의식을 잃어 버린 것 같다.
    ELSEIF TFLAG:896 == 3 && TFLAG:897 == 3 && TFLAG:898 == 3
        PRINTFORML %조사처리(CALLNAME:TARGET,"는")% 의식을 되찾았다.
        WAIT
        ;지문 컷
        SIF CFLAG:지문소거판정 == 0
            CALL PASSOUT_MESSAGE
        ;실신 회복시 대사 호출
        CALL SELF_KOJO, TARGET, 12
        PRINTL 
    ELSE
        PRINTFORML %조사처리(CALLNAME:TARGET,"는")% 아직 눈을 뜨지 않는다.
    ENDIF
ENDIF


@PASSOUT_MESSAGE
;自分でもよく分からないくらいメチャクチャな上, 下に進むほど大雑把

IF TFLAG:102 == 1
    PRINTFORM 일어나 보니 
    SIF SELECTCOM == 501 || SELECTCOM == 502
        PRINT 촉수에게
    IF GROUPMATCH(SELECTCOM, 20, 21, 22, 23, 24, 27, 28, 612, 614, 615, 616, 617, 630) || ((SELECTCOM == 610 && (TFLAG:130 == 1 || TFLAG:131 == 1)))
        PRINT 질내를 
    ELSE
        PRINT 항문을 
    ENDIF
    PRINTFORM 범해지고 있어서 당황하는 %조사처리(CALLNAME:TARGET,"를")% 무시하고, 
    IF SELECTCOM == 501 || SELECTCOM == 502
        PRINT 촉수는 
    ELSE
        PRINTFORM %조사처리(CALLNAME:PLAYER,"는")% 
    ENDIF
    PRINTW 계속 범하고 있다.
ENDIF

IF TFLAG:873 >= 1
    IF TFLAG:102 == 1
        IF GROUPMATCH(SELECTCOM, 20, 21, 22, 23, 24, 27, 28, 612, 614, 615, 616, 617, 630) || ((SELECTCOM == 610 && (TFLAG:130 == 1 || TFLAG:131 == 1)))
            PRINT 페니스가 깊숙히 쑤셔박혀 있는 
        ELSEIF SELECTCOM == 501
            PRINT 촉수가 깊숙히 박혀 있는 
        ENDIF
    ENDIF
    PRINT 보지에서 흘러 떨어지는 피
    IF TFLAG:871 == 1
        PRINT 가 섞인 정액
    ELSEIF TFLAG:871 >= 2
        PRINT 가 섞인 대량의 정액
    ELSEIF TFLAG:876 >= 100 && TFLAG:876 < 200
        PRINT 가 섞인 오물
    ELSEIF TFLAG:876 >= 200
        PRINT 가 섞인 대량의 오물
    ENDIF
    PRINTL 에 대해 알아채고, 
    PRINTFORMW 자기도 모르는 사이에 처녀를 빼앗겼다는 사실에 망연해 하고 있다….
ELSEIF TFLAG:871 >= 1
    IF TFLAG:102 == 1
        IF GROUPMATCH(SELECTCOM, 20, 21, 22, 23, 24, 27, 28, 612, 614, 615, 616, 617, 630) || ((SELECTCOM == 610 && (TFLAG:130 == 1 || TFLAG:131 == 1)))
            PRINT 페니스가 깊숙히 쑤셔박혀 있는 
        ELSEIF SELECTCOM == 501
            PRINT 촉수가 깊숙히 박혀 있는 
        ENDIF
    ENDIF
    PRINT 음부
    IF TFLAG:872 >= 1
        PRINT 와 
        IF GROUPMATCH(SELECTCOM, 30, 31, 32, 33, 34, 37, 38, 618, 619) || ((SELECTCOM == 610 && (TFLAG:130 == 2 || TFLAG:131 == 2)))
            PRINT 페니스가 깊숙히 쑤셔박혀 있는 
        ELSEIF SELECTCOM == 502
            PRINT 촉수가 깊숙히 박혀 있는 
        ENDIF
        PRINT 항문
    ENDIF
    PRINTFORM 에서 \@(TFLAG:871 >= 2 || TFLAG:872 >= 2) ? 울컥울컥 나오는 대량의  # 흘러 떨어지는 \@정액을 
    IF TALENT:연모 == 1
        PRINTW 깨닫고는 곤혹스러워 하는 것 같다….
    ELSEIF TALENT:겁쟁이 == 1
        PRINTW 깨닫고는 지금 당장이라도 울어버릴 것 같다….
    ELSE
        PRINTFORMW 깨닫고는 %조사처리(CALLNAME:PLAYER,"를")% 노려보고 있다….
    ENDIF
ELSEIF TFLAG:872 >= 1
    IF TFLAG:102 == 1
        IF GROUPMATCH(SELECTCOM, 30, 31, 32, 33, 34, 37, 38, 618, 619) || ((SELECTCOM == 610 && (TFLAG:130 == 2 || TFLAG:131 == 2)))
            PRINT 페니스가 깊숙히 쑤셔박혀 있는 
        ELSEIF SELECTCOM == 502
            PRINT 촉수가 깊숙히 박혀 있는 
        ENDIF
    ENDIF
    PRINTFORM 항문에서 \@(TFLAG:871 >= 2 || TFLAG:872 >= 2) ? 샘솟는 대량의  # 흘러 떨어지는 \@정액을 
    IF TALENT:연모 == 1
        PRINTW 깨닫고는 곤혹스러워 하는 것 같다….
    ELSEIF TALENT:겁쟁이 == 1
        PRINTW 깨닫고는 지금 당장이라도 울어버릴 것 같다….
    ELSE
        PRINTFORMW 깨닫고는 %조사처리(CALLNAME:PLAYER,"를")% 노려보고 있다….
    ENDIF
ELSEIF TFLAG:876 >= 1
    PRINT 전신을 뒤덮은 
    SIF TFLAG:868 + TFLAG:869 + TFLAG:870 + TFLAG:871 + TFLAG:872 + TFLAG:873 + TFLAG:874 + TFLAG:875 >= 1
        PRINT 정액과 
    PRINTW 촉수가 토해낸 더러운 액체에 곤혹스러움을 감추지 못하는 듯하다….
ELSEIF TFLAG:868 + TFLAG:869 + TFLAG:870 + TFLAG:874 + TFLAG:875 >= 1
    PRINT 정신을 잃을 때까지는 없었던 몸
    SIF TFLAG:868 + TFLAG:869 + TFLAG:870 + TFLAG:874 + TFLAG:875 >= 3
        PRINT  전체
    PRINT 에 끼얹어진 정액에, 
    PRINTFORMW \@(TALENT:연모) ? 곤혹스러워 하는 것 같다…. # 완전히 겁먹은 것 같다…….\@
ELSEIF TFLAG:867 < 0 || TFLAG:877 < 0
    PRINTFORM 어느 새 
    IF TEQUIP:20 == 1
        IF TEQUIP:25 == 1
            PRINT 양구멍에 바이브가 
        ELSEIF TEQUIP:25 == 5
            PRINT 양구멍에 각각 바이브와 구슬이 
        ELSE
            PRINT 바이브가 
        ENDIF
    ELSEIF TEQUIP:20 == 3
        IF TEQUIP:25 == 1
            PRINT 양구멍에 각각 로터와 바이브가 
        ELSEIF TEQUIP:25 == 5
            PRINT 양구멍에 각각 로터와 구슬이 
        ELSE
            PRINT 로터가 
        ENDIF
    ELSEIF TEQUIP:20 == 4
        IF TEQUIP:25 == 1
            PRINT 양구멍에 각각 전극과 바이브가 
        ELSEIF TEQUIP:25 == 5
            PRINT 양구멍에 각각 전극과 비즈가 
        ELSE
            PRINT 전극이 
        ENDIF
    ELSEIF TEQUIP:25 == 1
        PRINT 애널에 바이브가 
    ELSEIF TEQUIP:25 == 5
        PRINT 애널에 구슬이 
    ENDIF    
    PRINT 박혀 
    SIF TFLAG:878 < 0 || TFLAG:866 < 0
        PRINT 있고 또한 각기 다른 기구가 부착되어 
    SIF TFLAG:879 < 0 || TFLAG:864 < 0 || TFLAG:865 < 0
        PRINT 기구가 부착되어
    SIF TEQUIP:50
        PRINT 있고, 그 모습이 또 촬영되고 
    PRINTW 있다는 것에 곤혹스러워 하는 것 같다….
ELSEIF TFLAG:878 < 0 || TFLAG:866 < 0
    PRINT 어느 새 몸에 기구가 부착되어 있다는 사실에 당혹해하고 있는 모양이다….
ELSEIF TFLAG:879 < 0 || TFLAG:864 < 0 || TFLAG:865 < 0
    PRINTFORM 어느 새  
    IF TEQUIP:40
        PRINT 묶여
        SIF TFLAG:878 < 0 || TFLAG:866 < 0
            PRINT 있는 데다가, 다양한 기구가 장착되어 
        PRINTFORM 있다는 것
    ELSEIF TEQUIP:42 == 1 || TEQUIP:25 == 4 || TEQUIP:25 == 6 || TEQUIP:25 == 7 || TEQUIP:25 == 8
        PRINT 다양한 기구가 부착되어 있는 것
    ELSE
        PRINT 몸이 상하는 것
    ENDIF
    PRINTFORMW 을 깨닫고 몹시 겁먹은 것 같다….
ELSEIF TFLAG:880 < 0
    PRINTFORMW 자신의 몸에 일어난 이변을 깨닫고 곤혹스러움을 감추지 못하는 것 같다.
ELSEIF TFLAG:881 < 0
    IF TEQUIP:50
        PRINT 자신을 비치고 있는 비디오 카메라를 
    ELSEIF TEQUIP:52
        PRINT 어느 새 바깥에 나와있다는 것을 
    ELSEIF TEQUIP:53
        PRINT 어느 새 목욕탕에 끌려 왔다는 것을 
    ELSE
        PRINT 이상한 걸 
    ENDIF
    PRINTFORMW 알고는 곤혹스러워 하고 있는 것 같다….
ELSEIF TFLAG:882 < 0
    PRINT 어느 새 온 몸을 휘감고 있는 촉수에 바짝 겁먹은 것 같다….
ENDIF
SIF (TFLAG:867 + TFLAG:877 + TFLAG:878 + TFLAG:866 + TFLAG:879 + TFLAG:864 + TFLAG:865 + TFLAG:881 + TFLAG:882) < 0 || TFLAG:872 >= 1
    WAIT

TFLAG:862 = TFLAG:868 + TFLAG:869 + TFLAG:870 + TFLAG:874 + TFLAG:875 + TFLAG:876
TFLAG:863 = TFLAG:867 + TFLAG:877 + TFLAG:878 + TFLAG:866 + TFLAG:879 + TFLAG:864 + TFLAG:865 + TFLAG:880 + TFLAG:881
TIMES TFLAG:863 , -1

;-------------------------------------------------
;실신 중의 파라미터 처리
;-------------------------------------------------
@PASSOUT_PALAM_CHECK
IF TFLAG:895 > 0
    TFLAG:883 += UP:14
    TFLAG:884 += UP:15
    TFLAG:885 += UP:17
    TFLAG:886 += UP:20
    TFLAG:887 += UP:21
    TFLAG:888 += UP:22
ELSE
    TFLAG:889 += UP:14
    TFLAG:890 += UP:15
    TFLAG:891 += UP:17
    TFLAG:892 += UP:20
    TFLAG:893 += UP:21
    TFLAG:894 += UP:22
ENDIF

UP:11 = 0
UP:12 = 0
UP:14 = 0
UP:15 = 0
UP:16 = 0
UP:17 = 0
UP:20 = 0
UP:21 = 0
UP:22 = 0

;-------------------------------------------------
;실신回復時のパラメータ処理
;-------------------------------------------------
@PASSOUT_PALAM_UP
LOCAL:1 = TFLAG:883 * (12 - TFLAG:899)
LOCAL:2 = TFLAG:884 * (12 - TFLAG:899)
LOCAL:3 = TFLAG:885 * (12 - TFLAG:899)
LOCAL:4 = TFLAG:886 * (12 - TFLAG:899)
LOCAL:5 = TFLAG:887 * (12 - TFLAG:899)
LOCAL:6 = TFLAG:888 * (12 - TFLAG:899)
IF TFLAG:899 > 2
    LOCAL:1 += TFLAG:889 * (TFLAG:899 - 2)
    LOCAL:2 += TFLAG:890 * (TFLAG:899 - 2)
    LOCAL:3 += TFLAG:891 * (TFLAG:899 - 2)
    LOCAL:4 += TFLAG:892 * (TFLAG:899 - 2)
    LOCAL:5 += TFLAG:893 * (TFLAG:899 - 2)
    LOCAL:6 += TFLAG:894 * (TFLAG:899 - 2)
ENDIF
LOCAL:1 /= 600
LOCAL:2 /= 240
LOCAL:3 /= 60
LOCAL:4 /= 10
LOCAL:5 /= 10
LOCAL:6 /= 10
FOR COUNT, 1, 7
    LOCAL:1 += LOCAL:1 * MAX((TFLAG:862 + TFLAG:863 + TFLAG:871 + TFLAG:872), 0)
NEXT

LOCAL = 0
SIF TFLAG:862 >= 1
    LOCAL += 1
SIF (TFLAG:871 + TFLAG:872) >= 1
    LOCAL += 1
IF ABL:정액중독 == 3
    UP:13 += 1000 * LOCAL
ELSEIF ABL:정액중독 == 4
    UP:13 += 1500 * LOCAL
ELSEIF ABL:정액중독 >= 5
    UP:13 += 2000 * LOCAL
ENDIF

FOR COUNT, 1, 7
    SIF TFLAG:102
        TIMES LOCAL:COUNT , 1.50
    SIF TFLAG:873 >= 1
        LOCAL:COUNT *= 2
NEXT

LOCAL:7 = 100
LOCAL:7 -= MARK:굴복각인 * 10
LOCAL:7 -= ABL:순종 * 5

SIF TALENT:연모
    LOCAL:7 /= 2

UP:14 += LOCAL:1 * (100 - LOCAL:7) / 100
UP:15 += LOCAL:2 * (100 - LOCAL:7) / 100
UP:17 += LOCAL:3 * (100 - LOCAL:7) / 100
UP:20 += LOCAL:4 * LOCAL:7 / 100
UP:21 += LOCAL:5 * LOCAL:7 / 100
UP:22 += LOCAL:6 * LOCAL:7 / 100

IF TFLAG:896 == 3 || TFLAG:897 == 3 || TFLAG:898 == 3
    TFLAG:896 = 0
    TFLAG:897 = 0
    TFLAG:898 = 0
    TFLAG:899 = 0
ENDIF

;-------------------------------------------------
;야외 플레이 중의 실신 처리
;-------------------------------------------------
@PASSOUT_OUTDOOR
;야외 플레이 해제
TEQUIP:52 = 0
TFLAG:150 = 0
TFLAG:151 = 0
;裸体盛りも解除
TEQUIP:60 = 0
;時間も少しだけ進行
TFLAG:107 += 2

PRINTFORMW %조사처리(CALLNAME:TARGET,"가")% 실신했기 때문에 방에 돌아가기로 했다….
;조교자의 体力・気力が若干減少
LOCAL:0 = 20
LOCAL:1 = 10
BASE:PLAYER:체력 = MAX(BASE:PLAYER:체력 - LOCAL:0, 0)
BASE:PLAYER:기력 = MAX(BASE:PLAYER:기력 - LOCAL:1, 0)
