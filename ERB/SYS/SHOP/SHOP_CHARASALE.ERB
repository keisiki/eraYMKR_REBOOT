;=============================================================================
;노예 매각 · 해방의 처리
;=============================================================================
;-------------------------------------------------
;매각 · 해방 캐릭터의 선택
;-------------------------------------------------
@CHARA_SALE
VARSET LOCAL, 0
;표시시키는 캐릭터를 선출(LOCAL:2로 인원수)
CALLF CLEAR_LIST
REPEAT CHARANUM
    MARK:COUNT:98 = 0
    SIF COUNT == MASTER
        CONTINUE
    ;파트너가 된 상대는 불가
    SIF CFLAG:COUNT:3 & 4
        CONTINUE
    ;그 자리에 없는 캐릭터는 제외
    SIF CFLAG:COUNT:4
        CONTINUE
    SIF 대상_제외됨(COUNT)
        CONTINUE
    SIF TALENT:COUNT:164
        CONTINUE
    IF FLAG:SHOP이벤트확장 & 32
        SIF (CFLAG:COUNT:3 || TALENT:COUNT:161 || TALENT:COUNT:164 || TALENT:COUNT:169) && CFLAG:COUNT:20 & 16
            CONTINUE
    ELSE
        SIF CFLAG:COUNT:3 || TALENT:COUNT:161 || TALENT:COUNT:164 || TALENT:COUNT:169 || CFLAG:COUNT:1 == 0
            CONTINUE
    ENDIF

    CALLF SET_LIST, LOCAL:2, COUNT
    LOCAL:2 += 1
    MARK:COUNT:98 = 1
REND
LOCAL:1 = (LOCAL:2 - 1) / 20

$PRINT_LIST
DRAWLINE
PRINTFORML \@(FLAG:SHOP이벤트확장 & 32) ? 누구를 판매 또는 해방 # 판매\@하겠습니까? ＜page.{LOCAL+1}/{LOCAL:1+1}＞
DRAWLINE
CALL SALE_LIST, LOCAL
DRAWLINE
PRINTFORMLC \@(LOCAL <= 0) ? %" " * 16% # [1001] 앞페이지로\@
PRINTLC [1000] 돌아가기
PRINTFORMLC \@(LOCAL >= LOCAL:1) ? %" " * 16% # [1009] 다음페이지로\@

$INPUT_LOOP
INPUT
IF RESULT == 1000
    RETURN 0
ELSEIF RESULT == 1001 && LOCAL > 0
    LOCAL -= 1
    GOTO PRINT_LIST
ELSEIF RESULT == 1009 && LOCAL < LOCAL:1
    LOCAL += 1
    GOTO PRINT_LIST
ELSEIF RESULT <= 0 || RESULT >= CHARANUM || MARK:RESULT:98 == 0
    GOTO INPUT_LOOP
ENDIF

LOCAL = RESULT
IF FLAG:SHOP이벤트확장 & 32
    IF NO:LOCAL == 401
        SIF FLAG:570 & 16
                PRINTFORMW ※이 노예를 매각, 또는 해방하게 되면 %조사처리(NAME:MASTER,"는")% 【촉수사역술】을 잃게 됩니다.
        SIF FLAG:570 & 32
            PRINTFORMW ※이 노예를 매각, 또는 해방하게 되면 %NAME:MASTER%의 촉수사역 Lv이 {FLAG:572}로 하락합니다.
    ENDIF
    SIF NO:MASTER == 400 && NO:LOCAL == 402 && FLAG:570 & 4
        PRINTW ※이 노예를 매각, 또는 해방하게 되면 노예의 구입 및 매각에 제한이 붙게 됩니다.
    CALL SALE_SELECT, LOCAL
ELSE
    IF NO:LOCAL == 401
        SIF FLAG:570 & 16
            PRINTFORMW ※이 노예를 매각, 또는 해방하게 되면 %조사처리(NAME:MASTER,"는")% 【촉수사역술】을 잃게 됩니다.
        SIF FLAG:570 & 32
            PRINTFORMW ※이 노예를 매각, 또는 해방하게 되면 %NAME:MASTER%의 촉수사역 Lv이 {FLAG:572}로 하락합니다.
    ENDIF
    SIF NO:MASTER == 400 && NO:LOCAL == 402 && FLAG:570 & 4
        PRINTW ※이 노예를 매각, 또는 해방하게 되면 노예의 구입 및 매각에 제한이 붙게 됩니다.
    CALL SALE_CONFIRM, LOCAL
ENDIF

IF FLAG:570 & 8
    FLAG:570 &= 55
    FLAG:휴식 = 1
    BEGIN TURNEND
    RETURN 1
ENDIF

RESTART

;-------------------------------------------------
;매각 · 해방 캐릭터의 일람
;-------------------------------------------------
@SALE_LIST, ARG
REPEAT 20
    LOCAL = GET_LIST(COUNT + ARG * 20)
    SIF LOCAL == 0
        CONTINUE

    CALL ARRANGE_CHARALIST, LOCAL
    IF ASSI == LOCAL
        PRINT  (조수)
    ELSEIF ISASSI:LOCAL == 1
        PRINT (원조수)
    ELSEIF CFLAG:LOCAL:1 == 2
        PRINT (조수가능)
    ENDIF
    PRINTL 
REND

;-------------------------------------------------
;매각 · 해방의 선택
;-------------------------------------------------
@SALE_SELECT, ARG
PRINTL 
SIF CFLAG:ARG:1 >= 1 && CFLAG:ARG:3 == 0 && TALENT:ARG:161 == 0 && TALENT:ARG:164 == 0 && TALENT:ARG:169 == 0
    PRINTFORML [0] 판매한다
SIF (CFLAG:ARG:20 & 16) == 0 && TALENT:ARG:164 == 0
    PRINTFORML [1] 해방한다
PRINTFORML [100] 돌아간다
$INPUT_LOOP
INPUT
IF RESULT == 100
    RETURN 0
ELSEIF RESULT == 0  && CFLAG:ARG:1 >= 1 && CFLAG:ARG:3 == 0 && TALENT:ARG:161 == 0 && TALENT:ARG:164 == 0 && TALENT:ARG:169 == 0
    CALL SALE_CONFIRM, ARG
ELSEIF RESULT == 1 && (CFLAG:ARG:20 & 16) == 0 && TALENT:ARG:164 == 0
    CALL CHARA_RELEASE, ARG
ELSE
    GOTO INPUT_LOOP
ENDIF

;-------------------------------------------------
;캐릭터 해방 처리
;-------------------------------------------------
@CHARA_RELEASE, ARG
;조교 대상 및 조수의 등록번호 보존
LOCAL:1 = TARGET
LOCAL:2 = ASSI
DRAWLINE
IF EQUIP:ARG:14
    PRINTFORML %조사처리(CALLNAME:MASTER,"는")% 잠에 빠져 있는 %조사처리(CALLNAME:ARG,"를")% 해방시켜주기로 했다…….
    PRINTFORML 깨우지 않도록 조심스레 옷을 입히고, %조사처리(CALLNAME:ARG,"를")% 등에 업고 밖으로 나왔다.
    PRINTFORML 남들 눈에 띄지 않는 데까지 온 다음 %조사처리(CALLNAME:MASTER,"는")% 
    PRINTFORMW 아직도 자고 있는 %조사처리(CALLNAME:ARG,"를")% 내려놓고, 그 자리를 떠났다…….
ELSE
    PRINTFORML %조사처리(CALLNAME:MASTER,"는")% 지금까지의 일들을 사죄하며 %조사처리(CALLNAME:ARG,"를")% 해방시키기로 했다…….
    PRINTFORML 옷을 입고 하는 외출에 %조사처리(CALLNAME:ARG,"는")% 깜짝 놀라고 있는 것 같다.
    PRINTFORML 머리를 숙이고 사죄의 말을 입에 담는 당신을 보며 %조사처리(CALLNAME:ARG,"는")% 이상하다는 표정을 띠고 있다.
    PRINTFORMW 멍하니 있는 %조사처리(CALLNAME:ARG,"를")% 그 자리에 남겨두고, %조사처리(CALLNAME:MASTER,"는")% 자리를 떠났다…….
ENDIF
;해방되어 떠나는 노예의 이벤트 대사 호출(해방 직후)
CALL SELF_KOJO, ARG, 196
PRINTW ………………
PRINTW …………
PRINTW ……
;정신붕괴or괴뢰or수면제 효과 발휘 중
IF TALENT:ARG:167 || TALENT:ARG:168 || EQUIP:ARG:14
    FLAG:67 += 1

    ;대상 or 조수의 매각 · 해방에 따른 등록 삭제 처리
    CALL CHARA_GONE, ARG, LOCAL:1, LOCAL:2
;망신or친애or예속or주인이 수수께끼의 매력에다 연모＋반발각인3
ELSEIF ((TALENT:MASTER:92 && TALENT:ARG:150) || TALENT:ARG:151 || TALENT:ARG:152 || TALENT:ARG:162) && MARK:ARG:반발각인 == 3
    PRINTFORMW %조사처리(CALLNAME:ARG,"가")% 없어진 빈 방을 청소하고 있노라니, 손님이 왔다는 노크 소리가 들려왔다.
    PRINTFORML 경계하며 문을 열어보니, %조사처리(CALLNAME:A,"가")% 칼을 쥐고 있었다
    PRINTFORMW 죽음을 각오하고 조용히 가슴을 들이댄 %조사처리(CALLNAME:MASTER,"를")% %조사처리(CALLNAME:A,"는")% 가만히 바라보고 있다…….
    PRINTFORML %조사처리(CALLNAME:ARG,"는")% 잠시 망설이고 있다가, 이윽고 칼을 버리고는 
    PRINTFORMW %CALLNAME:MASTER%의 품에 뛰어들어왔다.
    PRINTFORML 울면서 %CALLNAME:MASTER%에 대한 애정을 말해오는 %CALLNAME:ARG%의 머리를 한동안 쓰다듬고 있었다…….
    PRINTFORMW ＜%조사처리(CALLNAME:A,"는")% 반발각인을 잃었습니다＞
    MARK:ARG:반발각인 = 0
    CFLAG:ARG:20 |= 16
    ;돌아온 반발 노예의 이벤트 대사 호출
    CALL SELF_KOJO, ARG, 192
    TARGET = LOCAL:1
;망신or친애or상애or예속or괴조인격or주인이 수수께끼의 매력에다 연모＋음란or음마
ELSEIF ((TALENT:MASTER:92 && TALENT:ARG:150) || TALENT:ARG:151 || TALENT:ARG:152 || TALENT:ARG:153 || TALENT:ARG:162 || TALENT:ARG:169) && (TALENT:ARG:170 || TALENT:ARG:180)
    PRINTFORMW %조사처리(CALLNAME:ARG,"가")% 없어진 빈 방을 청소하고 있노라니, 손님이 왔다는 노크 소리가 들려왔다.
    PRINTFORML 경계하며 문을 열었더니, %조사처리(CALLNAME:ARG,"가")% 생글생글 음탕한 웃음을 띠며 서 있었다.
    PRINTFORMW 그 뒤에 굴러다니는 자루를 가리키며 %조사처리(CALLNAME:ARG,"는")% 상을 달라고 졸라온다.
    CALL RETURN_PLUS, ARG
    CFLAG:ARG:20 |= 16
;망신or친애or상애or예속or낙인or주인이 수수께끼의 매력에다 연모
ELSEIF (TALENT:MASTER:92 && TALENT:ARG:150) || TALENT:ARG:151 || TALENT:ARG:152 || TALENT:ARG:153 || TALENT:ARG:161 || TALENT:ARG:162
    PRINTFORMW %조사처리(CALLNAME:ARG,"가")% 없어진 빈 방을 청소하고 있노라니, 손님이 왔다는 노크 소리가 들려왔다.
    PRINTFORML 경계하면서 문을 열어보니, %조사처리(CALLNAME:ARG,"가")% 갈 곳이 없는지 서 있었다.
    PRINTFORMW 얼굴을 수치의 빛으로 물들이고 동거 허가를 구하는 %조사처리(CALLNAME:ARG,"를")% %조사처리(CALLNAME:MASTER,"는")% 말없이 받아들였다.
    IF TALENT:ARG:39 == 0
        PRINTFORMW %조사처리(CALLNAME:ARG,"는")% [약점]을 얻었다.
        TALENT:ARG:39 = 1
        CFLAG:ARG:12 |= 1024
    ENDIF
    CFLAG:ARG:20 |= 16
    ;돌아온 노예의 이벤트 대사 호출
    CALL SELF_KOJO, ARG, 193
;반발각인3에서 주인이 [주정] [봉래인]을 가지고 있지 않았을 경우
ELSEIF MARK:ARG:반발각인 >= 3 && TALENT:MASTER:48 == 0 && TALENT:MASTER:49 == 0
    CALL BADEND_9, ARG
ELSE
    FLAG:67 += 1

    ;대상 or 조수의 매각 · 해방에 따른 등록 삭제 처리
    CALL CHARA_GONE, ARG, LOCAL:1, LOCAL:2
ENDIF

;-------------------------------------------------
;해방한 캐릭터가 새로운 노예 및 자금을 조달하는 처리
;-------------------------------------------------
@RETURN_PLUS, ARG
VARSET LOCAL, 0
;돌아온 뒤 RESTART로 재구축되므로, 범용 리스트를 사용해도 OK
CALLF CLEAR_LIST

;구입 가능한 노예의 인원수 확인
LOCAL:1 = CALC_SLAVE_CAPACITY()

;캐릭터 숫자가 상한을 넘지 않았을 경우
IF CHARANUM < LOCAL:1
    ;노예의 단가를 취득
    CALL CHARA_BUY_PRICE
    REPEAT 149
        LOCAL:0 = COUNT + 100
        ;상성이 100보다 위고 단가가 1 이상
        IF RELATION:ARG:COUNT > 100 && ITEMSALES:(LOCAL:0) > 0
            CALLF SET_LIST, LOCAL:2, COUNT
            LOCAL:2 += 1
        ENDIF
    REND
ENDIF

;범용 리스트의 0～148에 소지하고 있지 않은 궁합이 좋은 캐릭터의 캐릭터 번호, LOCAL:2는 그 인원수
IF LOCAL:2 > 0 && FLAG:게임모드 < 50
    LOCAL:3 = GET_LIST(RAND:(LOCAL:2))
    CFLAG:ARG:155 |= 4
    PRINTL 
    PRINTFORMW %조사처리(CALLNAME:ARG,"는")% %조사처리(CSVNAME((LOCAL:3), 0),"를")% 끌고 왔다.
    ;조교 대상을 기억
    LOCAL:4 = TARGET
    ;캐릭터의 추가
    CALL CHARA_STATE_BASIC, LOCAL:3
    ;끌려온 날을 기록
    CFLAG:3112 = DAY
    CFLAG:3125 = (DAY*2)+TIME:0
    ;누구에게 끌려왔는지를 기록
    CFLAG:3109 = FLAG:998
    CFLAG:3118 = CFLAG:ARG:3109
    ;입수 방법의 기록
    CSTR:3 = %CALLNAME:ARG%에게 끌려왔다.
    ;초기 경험에 긴박경험 · 약물경험 · 이상경험을 추가
    EXP:긴박경험 += 12
    EXP:약물경험 += 12
    EXP:이상경험 += 1
    FLAG:998 += 1
    ;끌려온 쪽의 대사에서의 특수 초기 설정 처리용의 명령 호출
    CALL SET_CHARA_KOJO_EXTRA, TARGET
    ;노예를 끌고 왔다 이벤트 대사 호출(TFLAG:99에 누구를 데려왔는지를 넣어둔다)
    CALL SELF_KOJO, ARG, 190, TARGET
    ;끌려온 쪽의 이벤트 대사 호출(TFLAG:99에 누구한테 끌려왔는지를 넣어둔다)
    CALL SELF_KOJO, TARGET, 199, ARG
    ;조교 대상을 원래대로 되돌린다
    TARGET = LOCAL:4
ELSE
    MONEY += 10000
    PRINTL 
    PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 어디선가 1만 원의 자금을 조달해왔다.
    ;자금 조달해왔다 이벤트 대사 호출
    CALL SELF_KOJO, ARG, 191
ENDIF

;-------------------------------------------------
;대상 or 조수의 매각 · 해방에 따른 등록 삭제 처리
;-------------------------------------------------
@CHARA_GONE(GOODS, NOW_TARGET, NOW_ASSI)
#DIM DYNAMIC GOODS          ;판매할 상품
#DIM DYNAMIC NOW_TARGET     ;현재 타겟
#DIM DYNAMIC NOW_ASSI       ;현재 조수
;해방되어 떠나는 노예의 이벤트 대사 호출
CALL SELF_KOJO, GOODS, 195, TFLAG:200

IF CFLAG:GOODS:4 == 0
    IF NO:GOODS == 401
        IF FLAG:570 & 16
            TALENT:MASTER:149 = 0
            ABL:MASTER:촉수사역 = 0
        ELSEIF FLAG:570 & 32
            ABL:MASTER:촉수사역 = FLAG:572
        ENDIF
        FLAG:570 &= 15
    ELSEIF NO:MASTER == 400 && NO:GOODS == 402 && FLAG:570 & 4
        FLAG:570 |= 2
        FLAG:570 &= 59
    ENDIF
    DELCHARA GOODS
ENDIF

IF NOW_TARGET < 0 || NOW_TARGET == GOODS
    TARGET = -1
ELSE
    TARGET = (NOW_TARGET > GOODS) ? (NOW_TARGET - 1) # NOW_TARGET
ENDIF
IF NOW_ASSI < 0 || NOW_ASSI == GOODS
    ASSI = -1
ELSE
    ASSI = (NOW_ASSI > GOODS) ? (NOW_ASSI - 1) # NOW_ASSI
ENDIF

FLAG:996 = -1
IF TARGET >= 0
    RESULT = -1
    TRYCALLFORM TRY_{NO}
    FLAG:996 = RESULT
ENDIF

;-------------------------------------------------
;매각 처리
;-------------------------------------------------
@SALE_CONFIRM, ARG
LOCAL = 0
LOCAL:1 = TARGET
LOCAL:2 = ASSI
LOCAL:3 = 0

;매각치의 계산. 토리코모드 옵션으로 분기.
IF FLAG:5000 & 2
    CALL SALE_CHARA_TORIKOMODE(ARG)
ELSE 
    CALL SALE_CHARA(ARG)
ENDIF



LOCAL = MAX(RESULT, 0)
;매각 확인
PRINTFORML %조사처리(CALLNAME:ARG,"는")% {LOCAL}원에 팔릴 것 같습니다.
;디버그 모드에서는 매각치의 기초값 · 배율 보정(카운터스톱 전의 몫만)을 표시
SIF TALENT:MASTER:998
    PRINTFORML ※{RESULT:1}원(노예의 매각치 기본) × {(RESULT:2)/10000}.{(RESULT:2)%10000}(기초 구입률 보정) × α(그밖의 보정)

SIF FLAG:570 & 2
    PRINTL ※노예상인이 없기 때문에, 매각 후 시간이 경과합니다.
IF NO:MASTER == 400 && (FLAG:570 & 6) == 0
    SIF NO:ARG == 401 || NO:ARG == 403 || (NO:ARG == 1 && CFLAG:ARG:0 == 2)
        PRINTL ※매각 후 시간이 경과합니다.
ENDIF
PRINTL 매각하겠습니까?
PRINTL [0] 예
PRINTL [1] 아니오
$INPUT_LOOPSALE
INPUT
IF RESULT == 0
    DRAWLINE
    IF TALENT:ARG:158 && EQUIP:ARG:14 == 0 && (TALENT:ARG:153 || ((TALENT:ARG:151 || TALENT:ARG:157) && TALENT:ARG:160 == 0 && TALENT:ARG:170 == 0 && ABL:ARG:순종 < 5))
        TIMES LOCAL , 0.10
        PRINTFORML \@(TFLAG:207) ? %조사처리(CALLNAME:ARG,"는")% 수송시 파괴 폭주를 일으켜 실종됐다. # 수송시 파괴 폭주를 일으켜 실종×0.10\@
        IF TALENT:ARG:150 && TALENT:ARG:158
            CFLAG:ARG:1 = 0
            CFLAG:ARG:4 = 1
            LOCAL:3 = 1
        ENDIF
        ;광기 탈주시의 대사용
        TFLAG:200 = 180
    ELSE
        ;통상 매각시의 대사용
        TFLAG:200 = 130
    ENDIF
    LOCAL = MAX(LOCAL, 0)
    ;매각 거부 패치 추가
    ;일단, 리셋
    TFLAG:0 = 0

    ;「매각시 대사 표시」가 유효하다
    IF (FLAG:SHOP이벤트확장 & 16384) == 0
        CALL SELF_KOJO, ARG, TFLAG:200, LOCAL
;    ELSEIF (TALENT:ARG:151 || TALENT:ARG:152) && TALENT:MASTER:158
;        PRINTFORML 매각되어 떠나는 %조사처리(CALLNAME:ARG,"가")% 문득 돌아보더니, 무슨 말을 한 것처럼 보였다.
;        PRINTFORML 그러나 그 말은 %CALLNAME:MASTER%의 마음에는 닿지 못 했다…….
    ENDIF

    ;매각 거부 패치 추가
    IF TFLAG:0 == 1
        ;일단, 소제
        TFLAG:0 = 0
        RETURN 1
    ENDIF

    ;매각액
    PRINTFORMW  매각 결과, %조사처리(CALLNAME:ARG,"는")% {LOCAL}원에 팔렸습니다.
    MONEY += LOCAL
    FLAG:34 += 1
    FLAG:66 += 1
    ;--------------------------------------------------
    ;노예 매각으로 번 최고 금액 판정 처리
    MONEY:1 = LOCAL
    SIF MONEY:1 > MONEY:997
        CALL NEW_HIGH_INCOME_ALL, 997
    ;노예 매각으로 번 금액 가산 처리(1경 원까지 카운트)
    SIF MONEY:990 < 10000000000000000
        CALL INCOME_SLAVE_SALE, 990
    ;매각치 25만 원 이상의 고급 노예 매각으로 번 금액 가산 처리(1경 원까지 카운트)
    SIF MONEY:991 < 10000000000000000 && MONEY:1 >= 250000
        CALL INCOME_SLAVE_SALE, 991
    ;--------------------------------------------------
    ;매각 후 에피소드 등록 처리
    CALL SET_AFTERWARDS, ARG

    IF FLAG:570 & 2
        FLAG:570 |= 8
    ELSEIF NO:MASTER == 400 && (FLAG:570 & 6) == 0
        SIF NO:ARG == 401 || NO:ARG == 403 || (NO:ARG == 1 && CFLAG:ARG:0 == 2)
            FLAG:570 |= 8
    ENDIF

    ;각부
    SIF FLAG:난이도 == 6 || FLAG:난이도 == 7
        CALL TIME_LIMIT_BONUS, ARG

    IF LOCAL:3 == 0
        ;대상 or 조수의 매각 · 해방에 따른 등록 삭제 처리
        CALL CHARA_GONE, ARG, LOCAL:1, LOCAL:2
    ELSE
        IF ARG == TARGET
            TARGET -= 1
            FLAG:996 = -1
        ENDIF
    ENDIF
ELSEIF RESULT != 1
    GOTO INPUT_LOOPSALE
ENDIF
TFLAG:207 = 0

;=============================================================================
;캐릭터 매각치 계산 처리
;=============================================================================
;캐릭터의 매각치를 여기서 산출
@SALE_CHARA, ARG
VARSET LOCAL, 0
VARSET LOCALS, ""

IF !TFLAG:207
    ;얀데레 모드 유효일 때에 수면제의 영향 없으면 TALENT:연모를 본다
    IF FLAG:조교모드 & 4 && TALENT:ARG:150 && EQUIP:ARG:14 == 0 && TALENT:ARG:160 == 0 && TALENT:ARG:164 == 0 && TALENT:ARG:167 == 0 && TALENT:ARG:168 == 0 && TALENT:ARG:169 == 0
        PRINTFORMW %조사처리(CALLNAME:ARG,"는")%, 매각하려고 하자 미친듯이 날뛰었다.
        ;심하게 당황하는 노예의 이벤트 대사 호출
        CALL SELF_KOJO, ARG, 194
        ;반발각인LV3을 취득
        IF MARK:ARG:97 <= 2 && MARK:ARG:반발각인 <= 2
            CALL COMMON_MARK_UP, ARG, 9, 3, 0
            PRINTL 반발각인 LV3을 취득.
            ;감정결여의 경우에는 반발각인에 따른 순종 다운은 없음
            IF ABL:ARG:순종 > 1 && ABL:ARG:순종 < 5 && TALENT:ARG:22 == 0
                ABL:ARG:순종 -= 2
                SIF ABL:ARG:순종 < 0
                    ABL:ARG:순종 = 0
                PRINTFORML 그리고 순종이 {ABL:ARG:C감각}로 떨어졌다.
            ENDIF
        ENDIF
        ;꿋꿋함이 없고, 아직 광기가 아닐 경우, 광기를 얻는다
        IF TALENT:ARG:12 == 0 && TALENT:ARG:158 == 0
            CFLAG:ARG:12 |= 1
            CFLAG:ARG:17 |= 2
            TALENT:ARG:158 = 1
            PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 지고 있는 해를 향해 흐릿한 웃음을 띠고 중얼중얼대고 있다….
            PRINTFORML %조사처리(CALLNAME:ARG,"는")% 이미 정신줄을 놓은 것 같다….
            PRINTFORMW %조사처리(CALLNAME:ARG,"는")% [광기]를 얻었다.
        ENDIF
    ENDIF
ENDIF

;난이도 PHANTASM일 때 표시 없음
SIF FLAG:난이도 == 5 && TFLAG:207 == 0
    TFLAG:207 = 1

;캐릭터 원가의 1/5을 베이스로 한다
LOCAL = MAX(ITEMPRICE:(NO:ARG + 100) / 5, 10)
SIF !TFLAG:207
    PRINTFORML %ITEMNAME:(NO:ARG + 100)%({LOCAL}원)
LOCAL:1 += LOCAL

;ABL:Ｃ감각을 본다
IF ABL:ARG:C감각 < 3
    LOCAL = 0
ELSEIF ABL:ARG:C감각 == 3
    LOCAL = 250
ELSEIF ABL:ARG:C감각 == 4
    LOCAL = 400
ELSE
    LOCAL = 600
ENDIF
;[음핵／음경]
SIF TALENT:ARG:171
    TIMES LOCAL , 1.50
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:0, 13, RIGHT%LV{ABL:ARG:C감각} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:Ｖ감각을 본다
IF ABL:ARG:V감각< 2
    LOCAL = 0
ELSEIF ABL:ARG:V감각== 2
    LOCAL = 250
ELSEIF ABL:ARG:V감각== 3
    LOCAL = 500
ELSEIF ABL:ARG:V감각== 4
    LOCAL = 1000
ELSE
    LOCAL = 1500
ENDIF
;[음호]
SIF TALENT:ARG:172
    TIMES LOCAL , 2.00
IF LOCAL > 0 && TALENT:ARG:120 == 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:1, 13, RIGHT%LV{ABL:ARG:V감각} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:Ａ감각을 본다
IF ABL:ARG:A감각 < 2
    LOCAL = 0
ELSEIF ABL:ARG:A감각 == 2
    LOCAL = 200
ELSEIF ABL:ARG:A감각 == 3
    LOCAL = 400
ELSEIF ABL:ARG:A감각 == 4
    LOCAL = 700
ELSE
    LOCAL = 1000
ENDIF
;[음고]
SIF TALENT:ARG:173
    TIMES LOCAL , 1.50
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:2, 13, RIGHT%LV{ABL:ARG:A감각} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:Ｂ감각을 본다
IF ABL:ARG:B감각 < 3
    LOCAL = 0
ELSEIF ABL:ARG:B감각 == 3
    LOCAL = 320
ELSEIF ABL:ARG:B감각 == 4
    LOCAL = 480
ELSE
    LOCAL = 640
ENDIF
;[음유]
SIF TALENT:ARG:174
    TIMES LOCAL , 1.50
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:3, 13, RIGHT%LV{ABL:ARG:B감각} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF

;ABL:순종을 본다
IF ABL:ARG:순종 == 0
    LOCAL = 0
ELSEIF ABL:ARG:순종 == 1
    LOCAL = 500
ELSEIF ABL:ARG:순종 == 2
    LOCAL = 850
ELSEIF ABL:ARG:순종 == 3
    LOCAL = 1500
ELSEIF ABL:ARG:순종 == 4
    LOCAL = 2500
ELSE
    LOCAL = 3500
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:10, 13, RIGHT%LV{ABL:ARG:순종} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:욕망을 본다
IF ABL:ARG:욕망 == 0
    LOCAL = 0
ELSEIF ABL:ARG:욕망 == 1
    LOCAL = 200
ELSEIF ABL:ARG:욕망 == 2
    LOCAL = 450
ELSEIF ABL:ARG:욕망 == 3
    LOCAL = 900
ELSEIF ABL:ARG:욕망 == 4
    LOCAL = 1500
ELSE
    LOCAL = 2400
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:11, 13, RIGHT%LV{ABL:ARG:욕망} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:기교를 본다
IF ABL:ARG:기교 == 0
    LOCAL = 0
ELSEIF ABL:ARG:기교 == 1
    LOCAL = 150
ELSEIF ABL:ARG:기교 == 2
    LOCAL = 300
ELSEIF ABL:ARG:기교 == 3
    LOCAL = 600
ELSEIF ABL:ARG:기교 == 4
    LOCAL = 1000
ELSE
    LOCAL = 1800
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:12, 13, RIGHT%LV{ABL:ARG:기교} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:봉사정신을 본다
IF ABL:ARG:봉사정신 == 0
    LOCAL = 0
ELSEIF ABL:ARG:봉사정신 == 1
    LOCAL = 500
ELSEIF ABL:ARG:봉사정신 == 2
    LOCAL = 900
ELSEIF ABL:ARG:봉사정신 == 3
    LOCAL = 1400
ELSEIF ABL:ARG:봉사정신 == 4
    LOCAL = 2100
ELSE
    LOCAL = 3000
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:13, 13, RIGHT%LV{ABL:ARG:봉사정신} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:노출벽을 본다
IF ABL:ARG:노출증 == 0
    LOCAL = 500
ELSEIF ABL:ARG:노출증 == 1
    LOCAL = 200
ELSEIF ABL:ARG:노출증 == 2
    LOCAL = 100
ELSEIF ABL:ARG:노출증 == 3
    LOCAL = 300
ELSEIF ABL:ARG:노출증 == 4
    LOCAL = 500
ELSE
    LOCAL = 1000
ENDIF
;[오줌싸개버릇]
SIF TALENT:ARG:45
    TIMES LOCAL , 1.50
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:14, 13, RIGHT%LV{ABL:ARG:노출증} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF

;ABL:새드끼를 본다
IF ABL:ARG:새드끼 == 0
    LOCAL = 0
ELSEIF ABL:ARG:새드끼 == 1
    LOCAL = 200
ELSEIF ABL:ARG:새드끼 == 2
    LOCAL = 400
ELSEIF ABL:ARG:새드끼 == 3
    LOCAL = 700
ELSEIF ABL:ARG:새드끼 == 4
    LOCAL = 1200
ELSE
    LOCAL = 1600
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:20, 13, RIGHT%LV{ABL:ARG:새드끼} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:마조끼를 본다
IF ABL:ARG:마조끼 == 0
    LOCAL = 0
ELSEIF ABL:ARG:마조끼 == 1
    LOCAL = 200
ELSEIF ABL:ARG:마조끼 == 2
    LOCAL = 400
ELSEIF ABL:ARG:마조끼 == 3
    LOCAL = 700
ELSEIF ABL:ARG:마조끼 == 4
    LOCAL = 1200
ELSE
    LOCAL = 1600
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:21, 13, RIGHT%LV{ABL:ARG:마조끼} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:레즈끼 · ＢＬ끼를 본다
IF ABL:ARG:(22 + TALENT:ARG:120) < 2
    LOCAL = 0
ELSEIF ABL:ARG:(22 + TALENT:ARG:120) == 2
    LOCAL = 100
ELSEIF ABL:ARG:(22 + TALENT:ARG:120) == 3
    LOCAL = 250
ELSEIF ABL:ARG:(22 + TALENT:ARG:120) == 4
    LOCAL = 500
ELSE
    LOCAL = 800
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:(22 + TALENT:ARG:120), 13, RIGHT%LV{ABL:ARG:(22 + TALENT:ARG:120)} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF

;ABL:자위중독을 본다
IF ABL:ARG:자위중독 == 0
    LOCAL = 0
ELSEIF ABL:ARG:자위중독 == 1
    LOCAL = 560
ELSEIF ABL:ARG:자위중독 == 2
    LOCAL = 850
ELSEIF ABL:ARG:자위중독 == 3
    LOCAL = 1400
ELSEIF ABL:ARG:자위중독 == 4
    LOCAL = 1900
ELSE
    LOCAL = 2700
ENDIF
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:자위중독 >= 3
    TIMES LOCAL , 1.20
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:30, 13, RIGHT%LV{ABL:ARG:자위중독} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:정액중독을 본다
IF ABL:ARG:정액중독 == 0
    LOCAL = 0
ELSEIF ABL:ARG:정액중독 == 1
    LOCAL = 400
ELSEIF ABL:ARG:정액중독 == 2
    LOCAL = 800
ELSEIF ABL:ARG:정액중독 == 3
    LOCAL = 1200
ELSEIF ABL:ARG:정액중독 == 4
    LOCAL = 1800
ELSE
    LOCAL = 2400
ENDIF
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:정액중독 >= 3
    TIMES LOCAL , 1.20
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:31, 13, RIGHT%LV{ABL:ARG:정액중독} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:레즈중독 · ＢＬ중독을 본다
IF ABL:ARG:(32 + TALENT:ARG:120) == 0
    LOCAL = 0
ELSEIF ABL:ARG:(32 + TALENT:ARG:120) == 1
    LOCAL = 200
ELSEIF ABL:ARG:(32 + TALENT:ARG:120) == 2
    LOCAL = 400
ELSEIF ABL:ARG:(32 + TALENT:ARG:120) == 3
    LOCAL = 800
ELSEIF ABL:ARG:(32 + TALENT:ARG:120) == 4
    LOCAL = 1600
ELSE
    LOCAL = 2000
ENDIF
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:(32 + TALENT:ARG:120) >= 3
    TIMES LOCAL , 1.20
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:(32 + TALENT:ARG:120), 13, RIGHT%LV{ABL:ARG:(32 + TALENT:ARG:120)} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:분유중독을 본다
IF ABL:ARG:분유중독 == 0
    LOCAL = 0
ELSEIF ABL:ARG:분유중독 == 1
    LOCAL = 400
ELSEIF ABL:ARG:분유중독 == 2
    LOCAL = 800
ELSEIF ABL:ARG:분유중독 == 3
    LOCAL = 1200
ELSEIF ABL:ARG:분유중독 == 4
    LOCAL = 1800
ELSE
    LOCAL = 2200
ENDIF
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:분유중독 >= 3
    TIMES LOCAL , 1.20
IF LOCAL > 0 && TALENT:ARG:134
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:34, 13, RIGHT%LV{ABL:ARG:분유중독} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:배설중독을 본다
IF ABL:ARG:배설중독 == 0
    LOCAL = 0
ELSEIF ABL:ARG:배설중독 == 1
    LOCAL = 50
ELSEIF ABL:ARG:배설중독 == 2
    LOCAL = 100
ELSEIF ABL:ARG:배설중독 == 3
    LOCAL = 300
ELSEIF ABL:ARG:배설중독 == 4
    LOCAL = 500
ELSE
    LOCAL = 1000
ENDIF
;[오줌싸개버릇]
SIF TALENT:ARG:45
    TIMES LOCAL , 1.50
;[음고]
SIF TALENT:ARG:173
    TIMES LOCAL , 1.50
;[요도광]
SIF TALENT:ARG:175
    TIMES LOCAL , 1.50
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:배설중독 >= 3
    TIMES LOCAL , 1.20
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:36, 13, RIGHT%LV{ABL:ARG:배설중독} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:촉수중독을 본다
;촉수에 푹 빠진 나머지 성노예로서의 가치가 떨어져버린다고 해석
IF ABL:ARG:촉수중독 == 0
    LOCAL = 0
ELSEIF ABL:ARG:촉수중독 == 1
    LOCAL = 100
ELSEIF ABL:ARG:촉수중독 == 2
    LOCAL = 200
ELSEIF ABL:ARG:촉수중독 == 3
    LOCAL = 400
ELSEIF ABL:ARG:촉수중독 == 4
    LOCAL = 800
ELSE
    LOCAL = 1600
ENDIF
;[중독되기 어려움]
SIF TALENT:ARG:85 && ABL:ARG:촉수중독 >= 3
    TIMES LOCAL , 0.80
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:35, 13, RIGHT%LV{ABL:ARG:촉수중독} －{LOCAL}
    LOCAL:1 -= LOCAL
ENDIF

;ABL:요리기능을 본다
IF ABL:ARG:요리기능 == 0
    LOCAL = 0
ELSEIF ABL:ARG:요리기능 == 1
    LOCAL = 200
ELSEIF ABL:ARG:요리기능 == 2
    LOCAL = 500
ELSEIF ABL:ARG:요리기능 == 3
    LOCAL = 1000
ELSEIF ABL:ARG:요리기능 == 4
    LOCAL = 1800
ELSE
    LOCAL = 3000
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:70, 13, RIGHT%LV{ABL:ARG:요리기능} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:촬영기능을 본다
IF ABL:ARG:촬영기능 == 0
    LOCAL = 0
ELSEIF ABL:ARG:촬영기능 == 1
    LOCAL = 150
ELSEIF ABL:ARG:촬영기능 == 2
    LOCAL = 300
ELSEIF ABL:ARG:촬영기능 == 3
    LOCAL = 600
ELSEIF ABL:ARG:촬영기능 == 4
    LOCAL = 1400
ELSE
    LOCAL = 2000
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:71, 13, RIGHT%LV{ABL:ARG:촬영기능} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF
;ABL:가창기능을 본다
IF ABL:ARG:가창기능 == 0
    LOCAL = 0
ELSEIF ABL:ARG:가창기능 == 1
    LOCAL = 200
ELSEIF ABL:ARG:가창기능 == 2
    LOCAL = 400
ELSEIF ABL:ARG:가창기능 == 3
    LOCAL = 800
ELSEIF ABL:ARG:가창기능 == 4
    LOCAL = 1600
ELSE
    LOCAL = 2800
ENDIF
IF LOCAL > 0
    SIF !TFLAG:207
        PRINTFORML %ABLNAME:72, 13, RIGHT%LV{ABL:ARG:가창기능} ＋{LOCAL}
    LOCAL:1 += LOCAL
ENDIF

;MARK:불사각인을 본다
;不死性は触手に依るものなので蓬莱人や呪精のような価値は付かない
;それどころか逆に触手に依存性を持ってしまっているため、性奴隷としての価値が下がってしまう
IF MARK:ARG:불사각인
    LOCAL = 100 * MARK:ARG:불사각인 * MARK:ARG:불사각인
    SIF !TFLAG:207
        PRINTFORML %MARKNAME:10, 13, RIGHT%LV{MARK:ARG:불사각인} －{LOCAL}
    LOCAL:1 -= LOCAL
ENDIF

;매각치의 기초치 보존
LOCAL:3 = LOCAL:1
;배율 표시용
LOCAL:2 = 10000

;[처녀]를 본다
IF TALENT:ARG:0
    IF TALENT:ARG:0 == 2
        LOCAL = 175
        TIMES LOCAL:1 , 1.75
        TIMES LOCAL:2 , 1.75
    ELSE
        LOCAL = 200
        TIMES LOCAL:1 , 2.00
        TIMES LOCAL:2 , 2.00
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:0, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[비대음핵]을 본다
IF TALENT:ARG:1
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:1, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[겁쟁이]를 본다
IF TALENT:ARG:10 && ABL:ARG:마조끼 >= 3
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:10, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[반항적]을 본다
IF TALENT:ARG:11 && ABL:ARG:순종 > 4
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:11, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[꿋꿋함]을 본다
IF TALENT:ARG:12 && ABL:ARG:순종 > 2
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:12, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[솔직함]을 본다
IF TALENT:ARG:13
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:13, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[얌전함]을 본다
IF TALENT:ARG:14
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:14, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[프라이드가 높음]을 본다
IF TALENT:ARG:16 && ABL:ARG:순종 > 2
    IF ABL:ARG:순종 > 4
        LOCAL = 175
        TIMES LOCAL:1 , 1.75
        TIMES LOCAL:2 , 1.75
    ELSE
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:16, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[프라이드가 낮음]을 본다
ELSEIF TALENT:ARG:17 && ABL:ARG:순종 < 4
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:17, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[자제심]을 본다
IF TALENT:ARG:20
    IF ABL:ARG:욕망 < 4 && ABL:ARG:노출증 < 3
        LOCAL = 80
        TIMES LOCAL:1 , 0.80
        TIMES LOCAL:2 , 0.80
    ELSE
        LOCAL = 140
        TIMES LOCAL:1 , 1.40
        TIMES LOCAL:2 , 1.40
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:20, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[무관심]을 본다
IF TALENT:ARG:21 && ABL:ARG:욕망 < 4
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:21, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[감정결여]를 본다
IF TALENT:ARG:22 && ABL:ARG:욕망 < 4
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:22, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[호기심]을 본다
IF TALENT:ARG:23
    IF ABL:ARG:욕망 < 4
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSE
        LOCAL = 140
        TIMES LOCAL:1 , 1.40
        TIMES LOCAL:2 , 1.40
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:23, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[보수적]을 본다
IF TALENT:ARG:24 && ABL:ARG:욕망 < 4
    IF RELATION:ARG:MASTER >= 200
        LOCAL = 25
        TIMES LOCAL:1 , 0.25
        TIMES LOCAL:2 , 0.25
    ELSE
        LOCAL = 50
        TIMES LOCAL:1 , 0.50
        TIMES LOCAL:2 , 0.50
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:24, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[일선을 넘지 않음]을 본다
IF TALENT:ARG:27
    IF ABL:ARG:순종 < 4
        LOCAL = 80
        TIMES LOCAL:1 , 0.80
        TIMES LOCAL:2 , 0.80
    ELSEIF ABL:ARG:욕망 > 4
        LOCAL = 175
        TIMES LOCAL:1 , 1.75
        TIMES LOCAL:2 , 1.75
    ELSE
        LOCAL = 100
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:27, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[정조관념]을 본다
IF TALENT:ARG:30
    IF ABL:ARG:욕망 > 4 && TALENT:ARG:0
        LOCAL = 150
        TIMES LOCAL:1 , 1.50
        TIMES LOCAL:2 , 1.50
    ELSEIF ABL:ARG:욕망 < 3
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSE
        LOCAL = 100
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:30, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[정조관둔감]을 본다
ELSEIF TALENT:ARG:31 && TALENT:ARG:0 == 0 && TALENT:ARG:120 == 0
    IF TALENT:ARG:170 || TALENT:ARG:180
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSEIF ABL:ARG:욕망 < 4
        LOCAL = 80
        TIMES LOCAL:1 , 0.80
        TIMES LOCAL:2 , 0.80
    ELSE
        LOCAL = 100
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:31, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[해방]을 본다
IF TALENT:ARG:33
    IF ((ABL:ARG:V감각>= 5 || TALENT:ARG:120) && ABL:ARG:A감각 >= 5 && ABL:ARG:노출증 >= 4) || TALENT:ARG:180
        LOCAL = 175
        TIMES LOCAL:1 , 1.75
        TIMES LOCAL:2 , 1.75
    ELSEIF ((ABL:ARG:V감각>= 5 || TALENT:ARG:120) && ABL:ARG:A감각 >= 5) || CFLAG:ARG:13 & 1
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSEIF ABL:ARG:V감각< 3 || ABL:ARG:A감각 < 3 || ABL:ARG:노출증 < 3 || MARK:ARG:약물각인 > 0 || MARK:ARG:공포각인 > 0 || MARK:ARG:반발각인 > 0
        LOCAL = 70
        TIMES LOCAL:1 , 0.70
        TIMES LOCAL:2 , 0.70
    ELSE
        LOCAL = 100
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:33, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[저항]을 본다
IF TALENT:ARG:34 && ABL:ARG:순종 > 3
    IF ABL:ARG:순종 > 4 && ABL:ARG:노출증 > 4
        LOCAL = 180
        TIMES LOCAL:1 , 1.80
        TIMES LOCAL:2 , 1.80
    ELSE
        LOCAL = 130
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:2 , 1.30
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:34, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ELSEIF TALENT:ARG:34 == 0 && CFLAG:ARG:13 & 2
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:34, 12, RIGHT% 소실 ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[아픔에 약함]을 본다
IF TALENT:ARG:40
    LOCAL = 75
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 0.75
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:40, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[아픔에 강함]을 본다
ELSEIF TALENT:ARG:41
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:41, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[젖기 쉬움]을 본다
IF TALENT:ARG:42
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:42, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[젖기 어려움]을 본다
ELSEIF TALENT:ARG:43
    LOCAL = 90
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.90
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:43, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[미약중독]을 본다
IF TALENT:ARG:46
    IF TALENT:ARG:170
        LOCAL = 50
        TIMES LOCAL:1 , 0.50
        TIMES LOCAL:2 , 0.50
    ELSE
        LOCAL = 150
        TIMES LOCAL:1 , 1.50
        TIMES LOCAL:2 , 1.50
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:46, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[천식]을 본다
IF TALENT:ARG:47
    LOCAL = 60
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.60
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:47, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[혀놀림]을 본다
IF TALENT:ARG:52
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:52, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[바느질]을 본다
IF TALENT:ARG:53
    IF TALENT:ARG:177
        LOCAL = 125
        TIMES LOCAL:1 , 1.25
        TIMES LOCAL:2 , 1.25
    ELSEIF TALENT:ARG:81 || ABL:ARG:새드끼 >= 5
        LOCAL = 110
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:2 , 1.10
    ELSE
        LOCAL = 100
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:53, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[조합지식]을 본다
IF TALENT:ARG:55
    LOCAL = 125
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.25
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:55, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[금단의 지식]을 본다
IF TALENT:ARG:56
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:56, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[음구지식]을 본다
IF TALENT:ARG:58 && ABL:ARG:기교 >= 3
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:58, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[치료]를 본다
IF TALENT:ARG:59
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:59, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[헌신적]을 본다
IF TALENT:ARG:63
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:63, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[음모없음]을 본다
IF TALENT:ARG:65
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:65, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[정애미각]을 본다
IF TALENT:ARG:66
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:66, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[쾌감에 솔직]을 본다
IF TALENT:ARG:70 && ABL:ARG:욕망 < 4
    LOCAL = 60
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.60
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:70, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[쾌감을 부정]을 본다
ELSEIF TALENT:ARG:71 && ABL:ARG:욕망 > 3
    IF ABL:ARG:욕망 > 4
        LOCAL = 240
        TIMES LOCAL:1 , 2.40
        TIMES LOCAL:2 , 2.40
    ELSE
        LOCAL = 180
        TIMES LOCAL:1 , 1.80
        TIMES LOCAL:2 , 1.80
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:71, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[도착적]을 본다
IF TALENT:ARG:80 && ABL:ARG:욕망 > 3
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:80, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[바이]를 본다
IF TALENT:ARG:83 && ((ABL:ARG:레즈끼 >= 5 && ABL:ARG:레즈중독 >= 3) || (ABL:ARG:BL끼 >= 5 && ABL:ARG:BL중독 >= 3))
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:83, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[중독되기 어려움]을 본다
IF TALENT:ARG:85
    IF ABL:ARG:자위중독 + ABL:ARG:정액중독 + ABL:ARG:(32 + TALENT:ARG:120) + ABL:ARG:BL중독 + ABL:ARG:분유중독 + ABL:ARG:촉수중독 + ABL:ARG:배설중독 + ABL:ARG:사정중독 >= 10
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSEIF ABL:ARG:자위중독 >= 3 || ABL:ARG:정액중독 >= 3 || ABL:ARG:(32 + TALENT:ARG:120) >= 3 || ABL:ARG:BL중독 >= 3 || ABL:ARG:분유중독 >= 3 || ABL:ARG:촉수중독 >= 3 || ABL:ARG:배설중독 >= 3 || ABL:ARG:사정중독 >= 3
        LOCAL = 100
    ELSE
        LOCAL = 60
        TIMES LOCAL:1 , 0.60
        TIMES LOCAL:2 , 0.60
    ENDIF
    SIF LOCAL != 100 && !TFLAG:207
        PRINTFORML %TALENTNAME:85, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[매력]을 본다
IF TALENT:ARG:90
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:90, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[매혹]을 본다
IF TALENT:ARG:91
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:91, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[수수께끼의 매력]을 본다
IF TALENT:ARG:92
    LOCAL = 200
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 2.00
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:92, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[소악마]를 본다
IF TALENT:ARG:93
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:93, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[인기]를 본다
IF TALENT:ARG:94
    LOCAL = 125
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.25
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:94, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[고무]를 본다
IF TALENT:ARG:95
    IF ABL:ARG:욕망 >= 3
        LOCAL = 120
        TIMES LOCAL:1 , 1.20
        TIMES LOCAL:2 , 1.20
    ELSE
        LOCAL = 110
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:2 , 1.10
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:95, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[Ｃ둔감]을 본다
IF TALENT:ARG:101 && ABL:ARG:C감각 < 4
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:101, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[Ｃ민감]을 본다
ELSEIF TALENT:ARG:100 && ABL:ARG:C감각 > 2
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:100, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[V둔감]을 본다
IF TALENT:ARG:103 && ABL:ARG:V감각< 4
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:103, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[V민감]을 본다
ELSEIF TALENT:ARG:102 && ABL:ARG:V감각> 2
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:102, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[Ａ둔감]을 본다
IF TALENT:ARG:105 && ABL:ARG:A감각 < 4
    LOCAL = 90
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.90
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:105, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[Ａ민감]을 본다
ELSEIF TALENT:ARG:104 && ABL:ARG:A감각 > 2
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:104, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[Ｂ둔감]을 본다
IF TALENT:ARG:107 && ABL:ARG:B감각 < 4
    LOCAL = 90
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.90
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:107, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[Ｂ민감]을 본다
ELSEIF TALENT:ARG:106 && ABL:ARG:B감각 > 2
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:106, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[일광욕]을 본다
IF TALENT:ARG:114
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:114, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[월광욕]을 본다
IF TALENT:ARG:115
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:115, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[동물귀]를 본다
IF TALENT:ARG:116
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:116, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[남자]를 본다
IF TALENT:ARG:120
    IF BASE:ARG:체력 >= 3000 && BASE:ARG:기력 >= 2000
        LOCAL = 250
        TIMES LOCAL:1 , 2.50
        TIMES LOCAL:2 , 2.50
    ELSEIF ABL:ARG:순종 > 3 && ABL:ARG:욕망 > 3 && ABL:ARG:BL끼 > 2
        LOCAL = 200
        TIMES LOCAL:1 , 2.00
        TIMES LOCAL:2 , 2.00
    ELSEIF ABL:ARG:순종 > 2 && ABL:ARG:욕망 > 2 && ABL:ARG:BL끼 > 1
        LOCAL = 150
        TIMES LOCAL:1 , 1.50
        TIMES LOCAL:2 , 1.50
    ELSEIF ABL:ARG:순종 > 1 && ABL:ARG:욕망 > 1 && ABL:ARG:BL끼
        LOCAL = 125
        TIMES LOCAL:1 , 1.25
        TIMES LOCAL:2 , 1.25
    ELSE
        LOCAL = 110
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:2 , 1.10
    ENDIF
    LOCALS = いい%TALENTNAME:120%
    SIF !TFLAG:207
        PRINTFORML %LOCALS, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[후타나리]를 본다
IF TALENT:ARG:121
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:121, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[구현]을 본다
ELSEIF TALENT:ARG:123
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:123, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[광기의 눈]을 본다
IF TALENT:ARG:125
    LOCAL = 200
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 2.00
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:125, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[모유체질]을 본다
IF TALENT:ARG:134
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:134, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[난생]을 본다
IF TALENT:ARG:135
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:135, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[산란체질]을 본다
ELSEIF TALENT:ARG:136
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:136, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[회복빠름]을 본다
IF TALENT:ARG:137
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:137, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[회복느림]을 본다
ELSEIF TALENT:ARG:138
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:138, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[음치]를 본다
IF TALENT:ARG:190
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:190, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[음감]을 본다
ELSEIF TALENT:ARG:191
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:191, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[요리못함]을 본다
IF TALENT:ARG:192
    LOCAL = 75
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 0.75
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:192, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[요리잘함]을 본다
ELSEIF TALENT:ARG:193
    LOCAL = 125
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.25
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:193, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[조리명인]을 본다
ELSEIF TALENT:ARG:194
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:194, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[공작명인]을 본다
IF TALENT:ARG:195
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:195, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[마술기능]을 본다
IF TALENT:ARG:197
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:197, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[봉래인]을 본다
IF TALENT:ARG:49
    LOCAL = 400
    TIMES LOCAL:1 , 4.00
    TIMES LOCAL:2 , 4.00
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:49, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[주정]을 본다
ELSEIF TALENT:ARG:48
    LOCAL = 180
    TIMES LOCAL:1 , 1.80
    TIMES LOCAL:2 , 1.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:48, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[흡혈귀]를 본다
IF TALENT:ARG:205
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:205, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[인형]을 본다
IF TALENT:ARG:208
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:208, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[캇파]를 본다
IF TALENT:ARG:210
    LOCAL = 115
    TIMES LOCAL:1 , 1.15
    TIMES LOCAL:2 , 1.15
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:210, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[요호]를 본다
IF TALENT:ARG:211
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:211, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[사토리]를 본다
IF TALENT:ARG:213
    IF TALENT:ARG:213 == 2
        LOCAL = 110
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:2 , 1.10
    ELSE
        LOCAL = 130
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:2 , 1.30
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:213, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[오니]를 본다
IF TALENT:ARG:214
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:214, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[텐구]를 본다
IF TALENT:ARG:215
    LOCAL = 125
    TIMES LOCAL:1 , 1.25
    TIMES LOCAL:2 , 1.25
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:215, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[누에]를 본다
IF TALENT:ARG:217
    LOCAL = 450
    TIMES LOCAL:1 , 4.50
    TIMES LOCAL:2 , 4.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:217, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[하쿠레이의 무녀]를 본다
IF TALENT:ARG:218
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:218, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[카제하후리]를 본다
IF TALENT:ARG:219
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:219, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[폭발물]을 본다
IF TALENT:ARG:220
    LOCAL = 75
    TIMES LOCAL:1 , 0.75
    TIMES LOCAL:2 , 0.75
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:220, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[신령]을 본다
IF TALENT:ARG:222
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
    TIMES LOCAL:2 , 1.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:222, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[반신]을 본다
IF TALENT:ARG:223
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:223, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[선인]을 본다
IF TALENT:ARG:225
    IF ABL:ARG:욕망 >= 5
        LOCAL = 130
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:2 , 1.30
    ELSE
        LOCAL = 175
        TIMES LOCAL:1 , 1.75
        TIMES LOCAL:2 , 1.75
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:225, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[강시]를 본다 - 강시 매각조건 분기는 마조끼
IF TALENT:ARG:226
    IF ABL:ARG:마조끼 >= 5
        LOCAL = 130
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:2 , 1.30
    ELSE
        LOCAL = 75
        TIMES LOCAL:1 , 0.75
        TIMES LOCAL:2 , 0.75
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:226, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[둔갑너구리]를 본다
IF TALENT:ARG:227
    LOCAL = 130
    TIMES LOCAL:1 , 1.30
    TIMES LOCAL:2 , 1.30
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:227, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[츠쿠모가미]를 본다
IF TALENT:ARG:228
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:228, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[인어]를 본다
IF TALENT:ARG:229
    LOCAL = 200
    TIMES LOCAL:1 , 2.00
    TIMES LOCAL:2 , 2.00
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:229, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[목 분리]를 본다
IF TALENT:ARG:230
    IF TALENT:ARG:230 == 2
        LOCAL = 130
        TIMES LOCAL:1 , 1.30
        TIMES LOCAL:2 , 1.30
    ELSEIF TALENT:ARG:230 == 3
        LOCAL = 75
        TIMES LOCAL:1 , 0.75
        TIMES LOCAL:2 , 0.75
    ELSE
        LOCAL = 110
        TIMES LOCAL:1 , 1.10
        TIMES LOCAL:2 , 1.10
    ENDIF
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:230, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[창부]를 본다
IF TALENT:ARG:260
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:260, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[매춘중독]을 본다
IF TALENT:ARG:262
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:262, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[간판소녀]를 본다
IF TALENT:ARG:264
    LOCAL = 120
    TIMES LOCAL:1 , 1.20
    TIMES LOCAL:2 , 1.20
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:264, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[음마]를 본다
IF TALENT:ARG:180
    LOCAL = 250
    TIMES LOCAL:1 , 2.50
    TIMES LOCAL:2 , 2.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:180, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[음란]을 본다
ELSEIF TALENT:ARG:170
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:170, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[즉각함락]을 본다
IF TALENT:ARG:179
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:179, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[상애]를 본다
IF TALENT:ARG:153
    LOCAL = 50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:153, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[친애]를 본다
ELSEIF TALENT:ARG:152
    LOCAL = 60
    TIMES LOCAL:1 , 0.60
    TIMES LOCAL:2 , 0.60
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:152, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;[복종]을 본다
IF TALENT:ARG:160
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:160, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF


;[유아퇴행]을 본다 ;[남자]이고 [작은체형][소인]가 아닐 경우 마이너스
IF TALENT:ARG:159 && TALENT:ARG:120 && TALENT:ARG:128 == 0 && TALENT:ARG:129 == 0
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:159, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[정신붕괴]를 본다
IF TALENT:ARG:167
    LOCAL = 5
    TIMES LOCAL:1 , 0.05
    TIMES LOCAL:2 , 0.05
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:167, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
;[광기]를 본다
ELSEIF TALENT:ARG:158
    LOCAL = 50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:158, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[흠집]을 본다
IF TALENT:ARG:163
    LOCAL = 50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:163, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF
;[괴뢰]를 본다
IF TALENT:ARG:168
    LOCAL = 50
    TIMES LOCAL:1 , 0.50
    TIMES LOCAL:2 , 0.50
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:168, 16, RIGHT% ×{LOCAL/100}.{LOCAL%100}
ENDIF

;클리토리스 링
IF CFLAG:ARG:42 & 1
    LOCAL = 85
    TIMES LOCAL:1 , 0.85
    TIMES LOCAL:2 , 0.85
    SIF !TFLAG:207
        PRINTFORML 클리토리스링 ×{LOCAL/100}.{LOCAL%100}
ENDIF
;니플 피어스
IF CFLAG:ARG:42 & 16
    LOCAL = 90
    TIMES LOCAL:1 , 0.90
    TIMES LOCAL:2 , 0.90
    SIF !TFLAG:207
        PRINTFORML 　　니플피어스 ×{LOCAL/100}.{LOCAL%100}
ENDIF
;라비아 피어스
IF CFLAG:ARG:42 & 32
    LOCAL = 80
    TIMES LOCAL:1 , 0.80
    TIMES LOCAL:2 , 0.80
    SIF !TFLAG:207
        PRINTFORML 　　라비아피어스 ×{LOCAL/100}.{LOCAL%100}
ENDIF
;벨리 쥬얼
IF CFLAG:ARG:42 & 4
    LOCAL = 110
    TIMES LOCAL:1 , 1.10
    TIMES LOCAL:2 , 1.10
    SIF !TFLAG:207
        PRINTFORML 　　벨리 쥬얼 ×{LOCAL/100}.{LOCAL%100}
ENDIF

;임신 중이다
IF TALENT:ARG:140
    LOCAL:1 /= 4
    LOCAL:2 /= 4
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:140, 16, RIGHT% ×0.25
;회란 중이시다
ELSEIF TALENT:ARG:145
    LOCAL:1 /= 4
    LOCAL:2 /= 4
    SIF !TFLAG:207
        PRINTFORML %TALENTNAME:145, 16, RIGHT% ×0.25
ENDIF

;조수를 판다
IF ISASSI:ARG && EXP:ARG:조수경험 < EXPLV:5
    LOCAL:1 /= 2
    LOCAL:2 /= 2
    SIF !TFLAG:207
        PRINTFORML 　　　　　원조수 ×0.50
ENDIF

;[거절]을 본다
SIF TALENT:ARG:830 && !TFLAG:207
    PRINTFORML %TALENTNAME:830, 16, RIGHT% ×1.00

;매각치 보정(HARD 이상이거나 NORMAL 이하로 내용이 다름)
IF !TFLAG:207
    IF FLAG:난이도 >= 3
        LOCAL:1 = PRICE_LIMIT_HARD(ARG, LOCAL:1)
    ELSE
        LOCAL:1 = PRICE_LIMIT_NORMAL(ARG, LOCAL:1)
    ENDIF
ENDIF

;주인의 조교사 LV
IF ABL:MASTER:조교사Lv == 0
    LOCAL = 100
ELSEIF ABL:MASTER:조교사Lv == 1
    LOCAL = 150
    TIMES LOCAL:1 , 1.50
ELSEIF ABL:MASTER:조교사Lv == 2
    LOCAL = 200
    TIMES LOCAL:1 , 2.00
ELSEIF ABL:MASTER:조교사Lv == 3
    LOCAL = 250
    TIMES LOCAL:1 , 2.50
ELSEIF ABL:MASTER:조교사Lv == 4
    LOCAL = 300
    TIMES LOCAL:1 , 3.00
ELSE
    LOCAL = 400
    TIMES LOCAL:1 , 4.00
ENDIF
SIF !TFLAG:207
    PRINTFORML 주인의 %ABLNAME:99%{ABL:MASTER:조교사Lv} ×{LOCAL/100}.{LOCAL%100}

;YASAI 모드의 캐릭터 한정
IF ((NO:ARG == 401 || NO:ARG == 403 || (NO:ARG == 1 && CFLAG:ARG:0 == 2)) && NO:MASTER == 400 && (FLAG:570 & 4) == 0) || FLAG:570 & 2
    TIMES LOCAL:1 , 0.50
    SIF !TFLAG:207
        PRINTFORML 　　　중계인부재 ×0.5
ENDIF

;값을 원할 경우에 대비해 보존
RESULT:1 = LOCAL:3
RESULT:2 = LOCAL:2
RETURN LOCAL:1

;-------------------------------------------------
;매각치 보정(HARD 이상)
;-------------------------------------------------
;HARD 모드 이상은 매각치에 한계치가 설정되어있다(단, NORMAL 이하 같은 보정은 걸리지 않는다)
;한 문자 변수 V를 매각한계치로, LOCAL을 해당 난이도의 기한일수에 사용
@PRICE_LIMIT_HARD(ARG, ARG:1)
#FUNCTION
IF FLAG:난이도 == 3
    LOCALS:0 = HARD
    LOCAL = 99
ELSEIF FLAG:난이도 == 4
    LOCALS:0 = LUNATIC
    LOCAL = 90
ELSEIF FLAG:난이도 == 5
    LOCALS:0 = PHANTASM
    LOCAL = 60
ELSEIF FLAG:난이도 == 6
    LOCALS:0 = PRO
ELSEIF FLAG:난이도 == 7
    LOCALS:0 = ULTRA
ELSE
    LOCALS:0 = UNKNOWN
    LOCAL = 1000
ENDIF
LOCALS:0 = 난이도 %LOCALS:0%

;원래 매각치 나름으로 매각치의 한계치가 결정
IF ARG:1 > 5000000
    LOCAL:1 = 1000000
ELSEIF ARG:1 > 1000000
    LOCAL:1 = 750000
ELSEIF ARG:1 > 750000
    LOCAL:1 = 500000
ELSE
    LOCAL:1 = 250000
ENDIF
;범용 캐릭터는 매각치 한계치가 저하
SIF NO:ARG >= 148 && NO:ARG < 200
    TIMES LOCAL:1 , 0.75
;매각치가 한계치를 넘었으면 수정
IF ARG:1 > LOCAL:1
    ARG:1= LOCAL:1
    SIF !TFLAG:207
        PRINTFORML %LOCALS:0, 16, RIGHT%：Counter Stop! {LOCAL:1}원
ENDIF

SIF FLAG:난이도 == 6 || FLAG:난이도 == 7
    RETURNF 0

;일자 보너스(한계 보정 후에 적용된다)
IF DAY < 4
    TIMES ARG:1 , 1.80
    LOCALS:1 = 1.80
ELSEIF DAY < 10
    TIMES ARG:1 , 1.30
    LOCALS:1 = 1.30
ELSEIF DAY < LOCAL / 3
    TIMES ARG:1 , 1.00
    LOCALS:1 = 1.00
ELSEIF DAY < LOCAL * 2 / 3
    TIMES ARG:1 , 0.80
    LOCALS:1 = 0.80
ELSEIF DAY < LOCAL
    TIMES ARG:1 , 0.60
    LOCALS:1 = 0.60
ENDIF
SIF !TFLAG:207
    PRINTFORML 일자 보너스 {DAY}일째 ×%LOCALS:1%

RETURNF ARG:1

;-------------------------------------------------
;매각치 보정(NORMAL 이하)
;-------------------------------------------------
;NORMAL 이하는 매각치가 일정치를 넘으면 보정이 걸린다
@PRICE_LIMIT_NORMAL(ARG, ARG:1)
#FUNCTION
;범용 캐릭터/오리캐 계열(딸 포함)
LOCAL = ARG:1
IF (NO:ARG >= 148 && NO:ARG <= 218) || NO:ARG >= 300
    
    ;오리지날
    ;ARG:1 = TABLE_CALC(ARG:1, 500000, 5)
    ;ARG:1 = TABLE_CALC(ARG:1, 750000, 10)
    ;ARG:1 = TABLE_CALC(ARG:1, 1000000, 25)
    ;ARG:1 = TABLE_CALC(ARG:1, 5000000, 50)

    ;토리코모드
    ARG:1 = ARG:1/2

    LOCALS = 무명
;원작 캐릭터(구작/서방 캐릭터도 포함)
ELSE
    ;오리지날
    ;ARG:1 = TABLE_CALC(ARG:1, 500000, 2)
    ;ARG:1 = TABLE_CALC(ARG:1, 750000, 5)
    ;ARG:1 = TABLE_CALC(ARG:1, 1000000, 10)
    ;ARG:1 = TABLE_CALC(ARG:1, 5000000, 20)

    ;토리코모드
    ARG:1 = 0

    LOCALS = 유명
ENDIF
LOCAL -= ARG:1
SIF LOCAL > 0
    PRINTFORML %NAME:ARG%：%LOCALS% 캐릭터 －{ARG:1}

RETURNF LOCAL

;-------------------------------------------------
;각부
;-------------------------------------------------
;타임 보너스 패치의 기능을 일부 개편
@TIME_LIMIT_BONUS, ARG
LOCAL = 0
REPEAT 40
    IF ABL:ARG:COUNT >= 5
        LOCAL += 2
    ELSEIF ABL:ARG:COUNT == 4
        LOCAL += 1
    ENDIF
REND
LOCAL /= 2

;타임 보너스
IF LOCAL
    PRINTFORMW  매각 결과, {LOCAL}매의 각부를 얻었습니다.
    DAY = MAX(DAY - LOCAL, 1)
ENDIF
