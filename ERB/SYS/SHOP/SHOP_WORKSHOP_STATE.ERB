;---------------------------------------------------------
; SHOP_WORKSHOP4 技師パッチ 工房イベントファイル その4
;---------------------------------------------------------
;中毒者曰く：
;判定用、素質・能力・経験・刻印判断関数
;※現在一部素質・能力・経験・刻印について未対応な暫定版
;  具体的にはYM Mk0 proto2時代に存在したものについてのみ対応
;
;以下関数群
;@JUDGE_WORKSHOP_STATE       工房結果判定用ステータスチェック
;@JUDGE_WORKSHOP_CONGENIAL   工房相性確認
;@JUDGE_WORKSHOP_ENVIRONMENT 工房環境確認

;=======================================;
;JUDGE_WORKSHOP_STATE 工房結果判定用ステータスチェック
; CFLAG:COUNT:695 やる気
; CFLAG:COUNT:696 エロス
; CFLAG:COUNT:697 誘惑
; CFLAG:COUNT:698 抵抗
; CFLAG:COUNT:699 自慰
;=======================================;
@JUDGE_WORKSHOP_STATE
 CFLAG:COUNT:695 = 0
 CFLAG:COUNT:696 = 0
 CFLAG:COUNT:697 = 0
 CFLAG:COUNT:698 = 0
 CFLAG:COUNT:699 = 0
;能力
;Ｃ感覚
IF ABL:COUNT:C감각
    CFLAG:COUNT:696 += ABL:COUNT:C감각 * 1
ENDIF
;Ｖ感覚
IF ABL:COUNT:V감각
    CFLAG:COUNT:696 += ABL:COUNT:V감각 * 1
ENDIF
;Ａ感覚
IF ABL:COUNT:A감각
    CFLAG:COUNT:696 += ABL:COUNT:A감각 * 1
ENDIF
;Ｂ感覚
IF ABL:COUNT:B감각
    CFLAG:COUNT:696 += ABL:COUNT:B감각 * 1
ENDIF
;従順
IF ABL:COUNT:순종
    CFLAG:COUNT:695 += ABL:COUNT:순종 * 3
ENDIF
;欲望
IF ABL:COUNT:욕망
    CFLAG:COUNT:696 += ABL:COUNT:욕망 * 3
    CFLAG:COUNT:697 += ABL:COUNT:욕망 * 3
    CFLAG:COUNT:699 += ABL:COUNT:욕망 * 1
ENDIF
;技巧
IF ABL:COUNT:기교
    CFLAG:COUNT:695 += ABL:COUNT:기교 * 1
    CFLAG:COUNT:696 += ABL:COUNT:기교 * 2
    CFLAG:COUNT:699 += ABL:COUNT:기교 * 1
ENDIF
;奉仕精神
IF ABL:COUNT:봉사정신
    CFLAG:COUNT:695 += ABL:COUNT:봉사정신 * 3
    CFLAG:COUNT:698 -= ABL:COUNT:봉사정신 * 3
ENDIF
;露出癖
IF ABL:COUNT:노출증
    CFLAG:COUNT:696 += ABL:COUNT:노출증 * 3
    CFLAG:COUNT:699 += ABL:COUNT:노출증 * 3
ENDIF
;マゾっ気
IF ABL:COUNT:마조끼
    CFLAG:COUNT:695 += ABL:COUNT:마조끼 * 2
    CFLAG:COUNT:696 += ABL:COUNT:마조끼 * 2
    CFLAG:COUNT:697 += ABL:COUNT:마조끼 * 2
    CFLAG:COUNT:698 -= ABL:COUNT:마조끼 * 2
ENDIF
;レズっ気
IF ABL:COUNT:레즈끼
    CFLAG:COUNT:697 += ABL:COUNT:레즈끼 * 3
    CFLAG:COUNT:698 -= ABL:COUNT:레즈끼 * 3
ENDIF
;自慰中毒
IF ABL:COUNT:자위중독
    CFLAG:COUNT:699 += ABL:COUNT:자위중독 * 3
ENDIF
;精液中毒
IF ABL:COUNT:정액중독
    CFLAG:COUNT:696 += ABL:COUNT:레즈중독 * 3
ENDIF
;レズ中毒
IF ABL:COUNT:레즈중독
    CFLAG:COUNT:696 += ABL:COUNT:레즈중독 * 3
    CFLAG:COUNT:697 += ABL:COUNT:레즈중독 * 3
    CFLAG:COUNT:698 -= ABL:COUNT:레즈중독 * 3
ENDIF
;噴乳中毒
IF ABL:COUNT:분유중독
    CFLAG:COUNT:696 += ABL:COUNT:분유중독 * 3
    CFLAG:COUNT:697 += ABL:COUNT:분유중독 * 3
    CFLAG:COUNT:699 += ABL:COUNT:분유중독 * 3
ENDIF
;触手中毒
IF ABL:COUNT:촉수중독
    CFLAG:COUNT:696 += ABL:COUNT:촉수중독 * 3
    CFLAG:COUNT:697 += ABL:COUNT:촉수중독 * 3
    CFLAG:COUNT:699 += ABL:COUNT:촉수중독 * 3
ENDIF
;素質
;処女
IF TALENT:COUNT:0
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:697 -= 5
    CFLAG:COUNT:698 += 5
ENDIF
;臆病
IF TALENT:COUNT:10
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:698 -= 5
ENDIF
;反抗的
IF TALENT:COUNT:11
    CFLAG:COUNT:695 -= 5
    CFLAG:COUNT:698 += 5
ENDIF
;気丈
IF TALENT:COUNT:12
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:697 += 3
    CFLAG:COUNT:698 += 5
ENDIF
;素直
IF TALENT:COUNT:13
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:697 += 3
    CFLAG:COUNT:698 += 3
ENDIF
;大人しい
IF TALENT:COUNT:14
    CFLAG:COUNT:695 += 2
ENDIF
;生意気
IF TALENT:COUNT:15
    CFLAG:COUNT:695 -= 3
    CFLAG:COUNT:697 += 3
    CFLAG:COUNT:698 += 3
ENDIF
;プライド高い
IF TALENT:COUNT:16
    CFLAG:COUNT:695 -= 5
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 -= 5
ENDIF
;プライド低い
IF TALENT:COUNT:17
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
ENDIF
;自制心
IF TALENT:COUNT:20
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:699 -= 5
ENDIF
;無関心
IF TALENT:COUNT:21
    CFLAG:COUNT:695 -= 5
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:699 -= 5
ENDIF
;感情乏しい
IF TALENT:COUNT:22
    CFLAG:COUNT:695 -= 3
    CFLAG:COUNT:696 -= 3
    CFLAG:COUNT:699 -= 3
ENDIF
;好奇心
IF TALENT:COUNT:23
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:696 += 3
    CFLAG:COUNT:697 += 3
    CFLAG:COUNT:698 += 3
ENDIF
;保守的
IF TALENT:COUNT:24
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:698 += 5
ENDIF
;楽観的
IF TALENT:COUNT:25
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:696 += 3
    CFLAG:COUNT:698 += 3
ENDIF
;悲観的
IF TALENT:COUNT:26
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:698 -= 3
ENDIF
;一線越えない
IF TALENT:COUNT:27
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 -= 5
ENDIF
;目立ちたがり
IF TALENT:COUNT:28
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:697 += 5
ENDIF
;貞操観念
IF TALENT:COUNT:30
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:698 += 5
ENDIF
;貞操無頓着
IF TALENT:COUNT:31
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 -= 5
ENDIF
;抑圧
IF TALENT:COUNT:32
    CFLAG:COUNT:695 -= 3
    CFLAG:COUNT:696 -= 3
    CFLAG:COUNT:697 -= 3
    CFLAG:COUNT:698 += 3
    CFLAG:COUNT:699 -= 3
ENDIF
;解放
IF TALENT:COUNT:33
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 -= 3
    CFLAG:COUNT:699 += 5
ENDIF
;抵抗
IF TALENT:COUNT:34
    CFLAG:COUNT:695 -= 5
ENDIF
;恥じらい
IF TALENT:COUNT:35
    CFLAG:COUNT:696 -= 2
    CFLAG:COUNT:697 -= 2
    CFLAG:COUNT:698 += 2
    CFLAG:COUNT:699 -= 2
ENDIF
;恥薄い
IF TALENT:COUNT:36
    CFLAG:COUNT:696 += 2
    CFLAG:COUNT:697 += 2
    CFLAG:COUNT:698 -= 2
    CFLAG:COUNT:699 += 2
ENDIF
;弱味
IF TALENT:COUNT:39
    CFLAG:COUNT:695 += 5
ENDIF
;痛みに弱い
IF TALENT:COUNT:40
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:698 -= 5
ENDIF
;痛みに強い
IF TALENT:COUNT:41
    CFLAG:COUNT:698 += 3
ENDIF
;濡れやすい
IF TALENT:COUNT:42
ENDIF
;濡れにくい
IF TALENT:COUNT:43
    CFLAG:COUNT:696 -= 1
    CFLAG:COUNT:697 += 1
    CFLAG:COUNT:699 -= 1
ENDIF
;媚薬中毒
IF TALENT:COUNT:46
    CFLAG:COUNT:696 += 5
ENDIF
;習得早い
IF TALENT:COUNT:50
    CFLAG:COUNT:695 += 5
ENDIF
;習得遅い
IF TALENT:COUNT:51
    CFLAG:COUNT:695 -= 5
ENDIF
;舌使い
IF TALENT:COUNT:52
    CFLAG:COUNT:696 += 3
ENDIF
;自慰しやすい
IF TALENT:COUNT:60
    CFLAG:COUNT:699 += 5
ENDIF
;汚臭敏感
IF TALENT:COUNT:62
    CFLAG:COUNT:698 += 5
ENDIF
;献身的
IF TALENT:COUNT:63
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 -= 5
ENDIF
;快感に素直
IF TALENT:COUNT:70
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;快感の否定
IF TALENT:COUNT:71
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 -= 5
ENDIF
;倒錯的
IF TALENT:COUNT:80
    CFLAG:COUNT:695 += 3
    CFLAG:COUNT:696 += 3
    CFLAG:COUNT:697 += 3
    CFLAG:COUNT:698 -= 3
    CFLAG:COUNT:699 += 3
ENDIF
;サド
IF TALENT:COUNT:81
    CFLAG:COUNT:697 += 5
ENDIF
;マゾ
IF TALENT:COUNT:82
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;中毒しやすい
IF TALENT:COUNT:84
    CFLAG:COUNT:695 += 5
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:699 += 5
ENDIF
;小悪魔
IF TALENT:COUNT:93
    CFLAG:COUNT:696 += 3
ENDIF
;Ｃ敏感
IF TALENT:COUNT:100
    CFLAG:COUNT:696 += 1
ENDIF
;Ｃ鈍感
IF TALENT:COUNT:101
    CFLAG:COUNT:696 -= 1
ENDIF
;Ｖ敏感
IF TALENT:COUNT:102
    CFLAG:COUNT:696 += 1
ENDIF
;Ｖ鈍感
IF TALENT:COUNT:103
    CFLAG:COUNT:696 -= 1
ENDIF
;Ａ敏感
IF TALENT:COUNT:104
    CFLAG:COUNT:696 += 1
ENDIF
;Ａ鈍感
IF TALENT:COUNT:105
    CFLAG:COUNT:696 -= 1
ENDIF
;Ｂ敏感
IF TALENT:COUNT:106
    CFLAG:COUNT:696 += 1
ENDIF
;Ｂ鈍感
IF TALENT:COUNT:107
    CFLAG:COUNT:696 -= 1
ENDIF
;爆乳
IF TALENT:COUNT:113
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 += 5
ENDIF
;ふたなり
IF TALENT:COUNT:121
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:697 += 5
ENDIF
;懐卵
IF TALENT:COUNT:145
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 += 5
ENDIF
;寄生
IF TALENT:COUNT:146
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 += 5
ENDIF
;恋慕
IF TALENT:COUNT:150
    CFLAG:COUNT:695 += 5
ENDIF
;妄信
IF TALENT:COUNT:151
    CFLAG:COUNT:695 += 5
ENDIF
;親愛
IF TALENT:COUNT:152
    CFLAG:COUNT:695 += 5
ENDIF
;相愛
IF TALENT:COUNT:153
    CFLAG:COUNT:695 += 5
ENDIF
;狂気
IF TALENT:COUNT:158
    CFLAG:COUNT:695 -= 5
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 += 5
    CFLAG:COUNT:699 -= 5
ENDIF
;服従
IF TALENT:COUNT:160
    CFLAG:COUNT:695 += 5
ENDIF
;烙印
IF TALENT:COUNT:161
    CFLAG:COUNT:695 += 5
ENDIF
;隷属
IF TALENT:COUNT:162
    CFLAG:COUNT:695 += 5
ENDIF
;使い魔
IF TALENT:COUNT:164
    CFLAG:COUNT:695 += 5
ENDIF
;淫乱
IF TALENT:COUNT:170
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;淫核／淫茎
IF TALENT:COUNT:171
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;淫壷
IF TALENT:COUNT:172
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;淫尻
IF TALENT:COUNT:173
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;淫乳
IF TALENT:COUNT:174
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;即落ち
IF TALENT:COUNT:179
    CFLAG:COUNT:696 += 5
    CFLAG:COUNT:698 -= 5
    CFLAG:COUNT:699 += 5
ENDIF
;吸血鬼
IF TALENT:COUNT:205
    CFLAG:COUNT:697 += 5
    CFLAG:COUNT:698 += 5
ENDIF
;機械
IF TALENT:COUNT:206
    CFLAG:COUNT:696 -= 5
    CFLAG:COUNT:699 -= 5
ENDIF
;刻印
;苦痛刻印
IF MARK:COUNT:고통각인
    CFLAG:COUNT:695 += MARK:COUNT:고통각인 * 5
    CFLAG:COUNT:698 -= MARK:COUNT:고통각인 * 5
ENDIF
;快楽刻印
IF MARK:COUNT:쾌락각인
    CFLAG:COUNT:696 += MARK:COUNT:쾌락각인 * 2
    CFLAG:COUNT:699 += MARK:COUNT:쾌락각인 * 2
ENDIF
;屈服刻印
IF MARK:COUNT:굴복각인
    CFLAG:COUNT:695 += MARK:COUNT:굴복각인 * 2
ENDIF
;反発刻印
IF MARK:COUNT:반발각인
    CFLAG:COUNT:695 += MARK:COUNT:반발각인 * 10
ENDIF
RETURN 0

;=======================================;
;JUDGE_WORKSHOP_CONGENIAL 工房相性確認
;ARG引数
; 0 自分のCHARANUM番号
; 1 相手のCHARANUM番号
;戻り値
;LOCAL:0 相性による加算値の合計
;=======================================;
@JUDGE_WORKSHOP_CONGENIAL, ARG:0, ARG:1
LOCAL:0 = 0
;相手のレズっ気と自分のレズ中毒を見る
LOCAL:0 += (ABL:(ARG:0):레즈중독 * ABL:(ARG:1):레즈끼)
;相手のＢＬっ気と自分のＢＬ中毒を見る
LOCAL:0 += (ABL:(ARG:0):BL중독 * ABL:(ARG:1):BL끼)
;自分が母乳体質で相手が幼児か幼稚か幼児退行なら自分の噴乳中毒を見る
SIF TALENT:(ARG:0):134 && (TALENT:(ARG:1):130 || TALENT:(ARG:1):131 || TALENT:(ARG:1):159)
    LOCAL:0 += ABL:(ARG:0):분유중독 * 2
;自分が幼児か幼稚か幼児退行で相手が母乳体質なら加算する
SIF TALENT:(ARG:1):134 && (TALENT:(ARG:0):130 || TALENT:(ARG:0):131 || TALENT:(ARG:0):159)
    LOCAL:0 += 5
;相手がドＭかマゾかマゾっ気ありなら自分のドＳとサドとサドっ気Lvのそれぞれにより加算する
IF ABL:(ARG:1):마조끼 || TALENT:(ARG:1):82 || TALENT:(ARG:1):178
    SIF TALENT:(ARG:0):177
        LOCAL:0 += 5
    SIF TALENT:(ARG:0):81
        LOCAL:0 += 5
    LOCAL:0 += ABL:(ARG:0):새드끼
ENDIF
;相手がドＳかサドかサドっ気ありなら自分のドＭとマゾとマゾっ気Lvのそれぞれにより加算する
IF ABL:(ARG:1):새드끼 || TALENT:(ARG:1):81 || TALENT:(ARG:1):177
    SIF TALENT:(ARG:0):178
        LOCAL:0 += 5
    SIF TALENT:(ARG:0):82
        LOCAL:0 += 5
    LOCAL:0 += ABL:(ARG:0):마조끼
ENDIF
;相手がオトコかふたなりなら自分の精液中毒を見る
SIF TALENT:(ARG:1):121 || TALENT:(ARG:1):120
    LOCAL:0 += ABL:(ARG:0):정액중독 * 2
;相手がオトコでないかふたなりなら自分の射精中毒を見る
SIF TALENT:(ARG:1):121 || (TALENT:(ARG:1):120 == 0)
    LOCAL:0 += ABL:(ARG:0):정액중독 * 2
;相手が巨乳か爆乳なら自分の射精中毒を見る
SIF TALENT:(ARG:1):112 || TALENT:(ARG:1):113
    LOCAL:0 += ABL:(ARG:0):정액중독
SIF TALENT:MASTER:Debug && (FLAG:1109 & 1) && (FLAG:1109 & 4)
    PRINTFORML ;;; %CALLNAME:(ARG:0)%의 %조사처리(CALLNAME:(ARG:1), "과")%의 육체상성치：{LOCAL:0}
RETURN LOCAL:0

;=======================================;
;JUDGE_WORKSHOP_ENVIRONMENT 工房環境確認
;ARG引数
; 0 自分のCHARANUM番号
; 1 変動させる判定値(実値)
;戻り値
;LOCAL:0 変動後の判定値(実値)
;=======================================;
@JUDGE_WORKSHOP_ENVIRONMENT, ARG:0, ARG:1
LOCAL:0 = ARG:1
;エロムードにより値が割り増し
LOCAL:0 *= (FLAG:1133 + FLAG:1130)
LOCAL:0 /= FLAG:1130
;レズ中毒ならレズっ気により値が割り増し
IF ABL:(ARG:0):레즈중독
    LOCAL:0 *= ((FLAG:1146 * (ABL:(ARG:0):레즈중독 * 2 + 8) + (FLAG:1130 * 10)) / 10)
    LOCAL:0 /= FLAG:1130
ENDIF
;ＢＬ中毒ならＢＬっ気により値が割り増し
IF ABL:(ARG:0):BL중독
    LOCAL:0 *= ((FLAG:1147 * (ABL:(ARG:0):BL중독 * 2 + 8) + (FLAG:1130 * 10)) / 10)
    LOCAL:0 /= FLAG:1130
ENDIF
;幼児か幼稚か幼児退行なら母乳体質者により値が割り増し
IF TALENT:(ARG:0):130 || TALENT:(ARG:0):131 || TALENT:(ARG:0):159
    LOCAL:0 *= (FLAG:1142 + FLAG:1130)
    LOCAL:0 /= FLAG:1130
ENDIF
;精液中毒ならペニスにより値が割り増し
IF ABL:(ARG:0):정액중독
    LOCAL:0 *= ((FLAG:1148 * (ABL:(ARG:0):정액중독 * 2 + 8) + (FLAG:1130 * 10)) / 10)
    LOCAL:0 /= FLAG:1130
ENDIF
;射精中毒なら女性器と巨乳・爆乳により値が割り増し
IF ABL:(ARG:0):사정중독
    LOCAL:0 *= (((FLAG:1145 + FLAG:1149) * (ABL:(ARG:0):사정중독 * 2 + 8) + (FLAG:1130 * 10)) / 10)
    LOCAL:0 /= FLAG:1130
ENDIF
RETURN LOCAL:0
