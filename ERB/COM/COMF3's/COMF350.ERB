;=============================================================================
;목욕탕 플레이
;=============================================================================
;………………………………………………
;실행 판정
;………………………………………………
@COM_ABLE350
;개별 설정 커맨드 필터
SIF DITEMTYPE:999:350 > 0
    RETURN 0
;수치 플레이中は移動はできない(鏡の前から離れないと)
SIF TEQUIP:56
    RETURN 0
;수치 플레이および風呂커맨드を使っている場合を除き, 解除はいつでも可能
SIF TEQUIP:53 && TEQUIP:55 == 0 && TEQUIP:92 == 0
    RETURN 1
;순종4미만 · 레즈끼(BL끼)3미만의 ASSI일 경우, 조교 대상이 동성이라면 실행할 수 없다(망신か복종ならＯＫ)
IF ASSIPLAY
    SIF (ABL:ASSI:순종 < 4 || ((TALENT:120 == 0 && TALENT:ASSI:120 == 0 && ABL:ASSI:레즈끼 < 3) || (TALENT:120 && TALENT:ASSI:120 && ABL:ASSI:BL끼 < 3))) && TALENT:ASSI:151 == 0 && TALENT:ASSI:160 == 0
        RETURN 0
ENDIF
;対象か조수가 動物耳で, 순종이 3미만이면 불가
SIF TALENT:116 && ABL:순종 < 3
    RETURN 0
SIF ASSI >= 0 && TALENT:ASSI:116 && ABL:ASSI:순종 < 3
    RETURN 0
;순종이 1이상 없으면 안 됨
SIF ABL:순종 < 1
    RETURN 0
;수면 중에는 불가
SIF EQUIP:14
    RETURN 0
;蜘蛛の巣にかけているときは移動できない
SIF TEQUIP:40 == 7
    RETURN 0
;승마 중에는 불가
SIF TEQUIP:43
    RETURN 0
;야외 플레이 중에는 불가
SIF TEQUIP:52
    RETURN 0
;特殊風呂入浴中はダメ
SIF TEQUIP:55
    RETURN 0
;의사 선생님 플레이 중에는 불가
SIF TEQUIP:57
    RETURN 0
;기저귀 플레이 중에는 불가
SIF TEQUIP:58
    RETURN 0
;알몸 앞치마 중에는 불가
SIF TEQUIP:59 == 1
    RETURN 0
;조수가 スク水とビキニと褌以外のコスプレ中はだめ
SIF ASSI >= 0 && ASSIPLAY && TEQUIP:ASSI:59 > 1 && TEQUIP:ASSI:59 != 2 && TEQUIP:ASSI:59 != 12 && TEQUIP:ASSI:59 != 17
    RETURN 0
;ビキニと褌以外のコスプレ中はだめ
SIF TEQUIP:59 > 2 && TEQUIP:59 != 12 && TEQUIP:59 != 17
    RETURN 0
;나체정식 중에는 불가
SIF TEQUIP:60
    RETURN 0
;시간정지 중에는 무리
SIF TEQUIP:71
    RETURN 0
;촉수 조교 중에는 불가
SIF TEQUIP:90
    RETURN 0
RETURN 1

;--------------------------------------------------
;커맨드 본체
;--------------------------------------------------
@COM350
PRINTL 목욕탕 플레이
COM_NAME = 목욕탕 플레이
CALL TRAIN_MESSAGE_COM350

;목욕탕에의 출입(종료시는 수정 없음)
;샤워는 강제적으로 제지당한다
IF TEQUIP:53
    TEQUIP:54 = 0
    TEQUIP:53 = 0
    RETURN 1
ENDIF

DOWNBASE:0 += 0
DOWNBASE:기력 += 30

LOCAL:1 = 100
LOCAL:2 = 50

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL:1 , 0.80
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL:1 , 0.90
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL:1 , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL:1 , 1.10
ELSE
    TIMES LOCAL:1 , 1.20
ENDIF
;ABL:노출벽을 본다
IF ABL:노출증 == 0
    SOURCE:24 += 0
    SOURCE:19 += 0
    TIMES LOCAL:1, 1.00
ELSEIF ABL:노출증 == 1
    SOURCE:24 += 50
    SOURCE:19 += 50
    TIMES LOCAL:1, 1.10
ELSEIF ABL:노출증 == 2
    SOURCE:24 += 80
    SOURCE:19 += 80
    TIMES LOCAL:1, 1.20
ELSEIF ABL:노출증 == 3
    SOURCE:24 += 100
    SOURCE:19 += 100
    TIMES LOCAL:1, 1.30
ELSEIF ABL:노출증 == 4
    SOURCE:24 += 200
    SOURCE:19 += 200
    TIMES LOCAL:1, 1.40
ELSE
    SOURCE:24 += 300
    SOURCE:19 += 300
    TIMES LOCAL:1, 1.50
ENDIF
;ABL:마조끼를 본다
IF ABL:마조끼 == 0
    TIMES LOCAL:1 , 1.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL:1 , 1.10
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL:1 , 1.20
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL:1 , 1.30
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL:1 , 1.40
ELSE
    TIMES LOCAL:1 , 1.50
ENDIF

;튀고 싶어함
SIF TALENT:28
    TIMES LOCAL:1 , 1.50
;해방
SIF TALENT:33
    TIMES LOCAL:1 , 1.50
;부끄럼쟁이
SIF TALENT:35
    TIMES LOCAL:2 , 1.20

SOURCE:28 += LOCAL:1 /2
SOURCE:25 += LOCAL:2 /2

;겁쟁이
SIF TALENT:10
    TIMES LOCAL:2 , 1.10

SOURCE:12 += LOCAL:1
SOURCE:31 += LOCAL:2
SOURCE:17 += LOCAL:1 /2
TEQUIP:53 = 1

RETURN 1

;-------------------------------------------------
;목욕탕 플레이중
;-------------------------------------------------
@EQUIP_COM350
PRINTL <목욕탕 플레이 중>

DOWNBASE:0 += 20
DOWNBASE:기력 += 50

LOCAL = 70
LOCAL:1 = 50

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
    TIMES LOCAL , 0.80
ELSEIF PALAM:13 < PALAMLV:2
    TIMES LOCAL , 0.90
ELSEIF PALAM:13 < PALAMLV:3
    TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
    TIMES LOCAL , 1.10
ELSE
    TIMES LOCAL , 1.20
ENDIF
;ABL:노출벽을 본다
IF ABL:노출증 == 0
    SOURCE:24 += 0
    SOURCE:19 += 0
    TIMES LOCAL, 1.00
ELSEIF ABL:노출증 == 1
    SOURCE:24 += 50
    SOURCE:19 += 50
    TIMES LOCAL, 1.10
ELSEIF ABL:노출증 == 2
    SOURCE:24 += 80
    SOURCE:19 += 80
    TIMES LOCAL, 1.20
ELSEIF ABL:노출증 == 3
    SOURCE:24 += 100
    SOURCE:19 += 100
    TIMES LOCAL, 1.30
ELSEIF ABL:노출증 == 4
    SOURCE:24 += 200
    SOURCE:19 += 20
    TIMES LOCAL, 1.40
ELSE
    SOURCE:24 += 300
    SOURCE:19 += 300
    TIMES LOCAL, 1.50
ENDIF
;ABL:마조끼를 본다
IF ABL:마조끼 == 0
    TIMES LOCAL , 1.00
ELSEIF ABL:마조끼 == 1
    TIMES LOCAL , 1.10
ELSEIF ABL:마조끼 == 2
    TIMES LOCAL , 1.20
ELSEIF ABL:마조끼 == 3
    TIMES LOCAL , 1.30
ELSEIF ABL:마조끼 == 4
    TIMES LOCAL , 1.40
ELSE
    TIMES LOCAL , 1.50
ENDIF

;튀고 싶어함
SIF TALENT:28
    TIMES LOCAL , 1.50
;해방
SIF TALENT:33
    TIMES LOCAL , 1.50
;부끄럼쟁이
SIF TALENT:35
    TIMES LOCAL:1 , 1.20

SOURCE:28 += LOCAL/2
SOURCE:25 += LOCAL:1 /2

;겁쟁이
SIF TALENT:10
    TIMES LOCAL:1 , 1.10

SOURCE:12 += LOCAL
SOURCE:31 += LOCAL:1
SOURCE:17 += LOCAL/2

IF TALENT:120 == 0 && TALENT:PLAYER:120 == 0
    TCVAR:12 += 1
ELSEIF TALENT:120 && TALENT:PLAYER:120
    TCVAR:13 += 1
ENDIF
;주인 경험 플래그
SIF ASSIPLAY == 0 && ABL:순종 >= 1
    TFLAG:50 += 1
SIF ASSIPLAY == 0 && ABL:봉사정신 >= 3
    TFLAG:50 += 1

RETURN 1

;--------------------------------------------------
;조교시 메시지
;--------------------------------------------------
@TRAIN_MESSAGE_COM350
CALL KOJO_TRAIN_MESSAGE_COM
SIF FLAG:10 == 0 || CFLAG:99 == 1 || RESULT != 0
    RETURN 0

PRINTL
IF TEQUIP:53
    PRINTW 목욕탕에서 나와, 조교실로 돌아왔다….
ELSE
    PRINTFORMW %조사선택(CALLNAME:TARGET, "를")% 목욕탕에 데려 갔다….
ENDIF
